// â•â•â• AUREUS SOCIAL PRO â€” Sprint Components â•â•â•
// 53 composants extraits du monolithe
"use client";

import { useState } from "react";
import { C, B, I, ST, PH, SC, fmt } from "@/app/lib/shared-ui";
import { LOIS_BELGES, LB, RMMMG, TX_ONSS_E, TX_ONSS_W, NET_FACTOR,
  PV_DOUBLE, PV_SIMPLE, CR_PAT, HEURES_HEBDO } from "@/app/lib/lois-belges";
import { quickPP, quickNet, calcPrecompteExact } from "@/app/lib/payroll-engine";
import { aureuspdf } from "@/app/lib/pdf-aureus";

export function TableauDirection({s}){const ae=(s.emps||[]).filter(e=>e.status==='active'||!e.status);const n=ae.length;const mb=ae.reduce((a,e)=>a+(+e.gross||0),0);const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const f0=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:0}).format(v);const coutTotal=Math.round(mb*(1+TX_ONSS_E));const netTotal=Math.round(mb*NET_FACTOR);const masseAn=mb*12;const coutAn=coutTotal*12;const moyBrut=n>0?Math.round(mb/n):0;const etp=ae.reduce((a,e)=>a+(+(e.regime||100)/100),0);const coutETP=etp>0?Math.round(coutAn/etp):0;const tp=ae.filter(e=>!e.regime||(+e.regime)>=100).length;const cdi=ae.filter(e=>!e.contractType||e.contractType==='CDI').length;const femmes=ae.filter(e=>(e.gender||'').toLowerCase()==='f').length;const [tab,setTab]=useState("kpi");const ratioNetCout=coutTotal>0?Math.round(netTotal/coutTotal*1000)/10:0;const chargesRate=Math.round(TX_ONSS_E*10000)/100;const ppMoy=n>0?Math.round(ae.reduce((a,e)=>a+quickPP(+(e.gross||0)),0)/n):0;return <div><PH title="Tableau de Bord Direction" sub={"Vue executive â€” "+n+" travailleurs â€” "+f0(etp)+" ETP â€” Masse "+f0(masseAn)+" EUR/an"}/><div style={{display:"grid",gridTemplateColumns:"repeat(6,1fr)",gap:10,marginBottom:18}}>{[{l:"Masse mensuelle",v:f0(mb)+" EUR",c:"#c6a34e"},{l:"Cout employeur/mois",v:f0(coutTotal)+" EUR",c:"#ef4444"},{l:"Net verse/mois",v:f0(netTotal)+" EUR",c:"#22c55e"},{l:"Cout/ETP/an",v:f0(coutETP)+" EUR",c:"#a78bfa"},{l:"Ratio Net/Cout",v:ratioNetCout+"%",c:"#60a5fa"},{l:"Charges "+chargesRate+"%",v:f0(coutTotal-mb)+" EUR/mois",c:"#fb923c"}].map((k,i)=><div key={i} style={{padding:"12px 14px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:9,color:"#5e5c56",textTransform:"uppercase",letterSpacing:".5px"}}>{k.l}</div><div style={{fontSize:16,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><div style={{display:"flex",gap:6,marginBottom:16}}>{[{v:"kpi",l:"KPIs"},{v:"structure",l:"Structure"},{v:"projections",l:"Projections 12 mois"},{v:"benchmark",l:"Benchmarks"}].map(t=><button key={t.v} onClick={()=>setTab(t.v)} style={{padding:"8px 16px",borderRadius:8,border:"none",cursor:"pointer",fontSize:12,fontWeight:tab===t.v?600:400,fontFamily:"inherit",background:tab===t.v?"rgba(198,163,78,.15)":"rgba(255,255,255,.03)",color:tab===t.v?"#c6a34e":"#9e9b93"}}>{t.l}</button>)}</div>{tab==="kpi"&&<C><ST>Indicateurs cles Direction</ST>{[{l:"Masse salariale annuelle",v:f0(masseAn)+" EUR",d:"Brut mensuel x 12 (hors 13e et pecule)",c:"#c6a34e"},{l:"Cout total annuel employeur",v:f0(coutAn)+" EUR",d:"Brut + ONSS patronal ("+chargesRate+"%) x 12",c:"#ef4444"},{l:"Cout annuel + 13e mois + pecule",v:f0(Math.round(coutAn*(1+1/12+PV_DOUBLE/12)))+" EUR",d:"Provision 13e: 1/12 + double pecule: "+Math.round(PV_DOUBLE*100)/100+"/12",c:"#fb923c"},{l:"Brut moyen/travailleur",v:f0(moyBrut)+" EUR",d:"Masse mensuelle / effectif",c:"#60a5fa"},{l:"PP moyen/travailleur",v:f0(ppMoy)+" EUR/mois",d:"Precompte professionnel formule-cle SPF",c:"#a78bfa"},{l:"RMMMG reference",v:f2(RMMMG)+" EUR",d:"Revenu Minimum Mensuel Moyen Garanti 2026",c:"#22c55e"}].map((r,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div><b style={{color:"#e8e6e0",fontSize:12}}>{r.l}</b><div style={{fontSize:10,color:"#5e5c56"}}>{r.d}</div></div><span style={{fontSize:15,fontWeight:700,color:r.c}}>{r.v}</span></div>)}</C>}{tab==="structure"&&<C><ST>Structure du personnel</ST>{[{l:"Effectif total",v:n,pct:100},{l:"Temps plein",v:tp,pct:n>0?Math.round(tp/n*100):0},{l:"Temps partiel",v:n-tp,pct:n>0?Math.round((n-tp)/n*100):0},{l:"CDI",v:cdi,pct:n>0?Math.round(cdi/n*100):0},{l:"CDD / Interim",v:n-cdi,pct:n>0?Math.round((n-cdi)/n*100):0},{l:"Femmes",v:femmes,pct:n>0?Math.round(femmes/n*100):0},{l:"Hommes",v:n-femmes,pct:n>0?Math.round((n-femmes)/n*100):0},{l:"ETP moyen",v:etp.toFixed(1),pct:0}].map((r,i)=><div key={i} style={{display:"flex",alignItems:"center",gap:12,padding:"8px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div style={{width:160,fontSize:11,color:"#9e9b93"}}>{r.l}</div><div style={{width:50,textAlign:"right",fontWeight:700,color:"#e8e6e0",fontSize:13}}>{r.v}</div>{r.pct>0&&<><div style={{flex:1,height:8,background:"rgba(255,255,255,.05)",borderRadius:4,overflow:"hidden"}}><div style={{height:"100%",width:r.pct+"%",background:"#c6a34e",borderRadius:4}}/></div><div style={{width:40,textAlign:"right",fontSize:10,color:"#c6a34e"}}>{r.pct}%</div></>}</div>)}</C>}{tab==="projections"&&<C><ST>Projections annuelles</ST>{Array.from({length:12},(_, i)=>i).map(m=>{const mois=["Jan","Fev","Mar","Avr","Mai","Jun","Jul","Aou","Sep","Oct","Nov","Dec"][m];const brutM=mb;const treizieme=m===11?mb:0;const pv=m===5?Math.round(mb*PV_DOUBLE):0;const coutM=Math.round((brutM+treizieme+pv)*(1+TX_ONSS_E));return {mois,brutM,treizieme,pv,coutM};}).map((r,i)=><div key={i} style={{display:"grid",gridTemplateColumns:"60px 1fr 1fr 1fr 1fr",gap:8,padding:"6px 0",borderBottom:"1px solid rgba(255,255,255,.03)",fontSize:11}}><span style={{color:"#c6a34e",fontWeight:600}}>{r.mois}</span><span style={{color:"#e8e6e0"}}>{f0(r.brutM)}</span><span style={{color:r.treizieme>0?"#fb923c":"#5e5c56"}}>{r.treizieme>0?f0(r.treizieme):"-"}</span><span style={{color:r.pv>0?"#a78bfa":"#5e5c56"}}>{r.pv>0?f0(r.pv):"-"}</span><span style={{color:"#ef4444",fontWeight:600}}>{f0(r.coutM)}</span></div>)}<div style={{display:"grid",gridTemplateColumns:"60px 1fr 1fr 1fr 1fr",gap:8,padding:"10px 0",borderTop:"2px solid rgba(198,163,78,.3)",fontSize:12,fontWeight:700}}><span style={{color:"#c6a34e"}}>TOTAL</span><span style={{color:"#e8e6e0"}}>{f0(masseAn)}</span><span style={{color:"#fb923c"}}>{f0(mb)}</span><span style={{color:"#a78bfa"}}>{f0(Math.round(mb*PV_DOUBLE))}</span><span style={{color:"#ef4444"}}>{f0(Math.round((masseAn+mb+mb*PV_DOUBLE)*(1+TX_ONSS_E)))}</span></div></C>}{tab==="benchmark"&&<C><ST>Benchmarks salariaux</ST>{[{l:"Salaire moyen Belgique (2026)",v:"4.200 EUR brut",d:"Source: Statbel â€” Toutes CP confondues"},{l:"Votre moyenne",v:f0(moyBrut)+" EUR",d:moyBrut>4200?"Au-dessus du marche":"En dessous du marche"},{l:"RMMMG 2026",v:f2(RMMMG)+" EUR",d:"Minimum legal temps plein 21+"},{l:"Median sectoriel CP 200",v:"3.600 EUR brut",d:"Commission paritaire auxiliaire employes"},{l:"Cout horaire moyen",v:f2(etp>0?coutAn/(etp*1744):0)+" EUR/h",d:"Cout total / (ETP x 1.744h/an)"}].map((r,i)=><div key={i} style={{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div style={{display:"flex",justifyContent:"space-between"}}><b style={{color:"#e8e6e0",fontSize:12}}>{r.l}</b><span style={{fontWeight:700,color:"#c6a34e"}}>{r.v}</span></div><div style={{fontSize:10,color:"#5e5c56",marginTop:2}}>{r.d}</div></div>)}</C>}</div>;}

export function TableauBordDirection({s}){return <TableauDirection s={s}/>;}

export function GestionPrimes({s,d}){const ae=(s.emps||[]).filter(e=>e.status==='active'||!e.status);const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const [tab,setTab]=useState("simulation");const [simBrut,setSimBrut]=useState(3500);const [simType,setSimType]=useState("13emois");const primeDefs=[{k:"13emois",l:"13e mois",calc:b=>b,ref:"CCT ou contrat",desc:"Remuneration mensuelle brute complete versee en decembre"},{k:"peculeSimple",l:"Pecule vacances simple",calc:b=>Math.round(b*0.1534*100)/100,ref:"Lois coord. 28/06/1971",desc:"15,34% du brut annuel â€” verse par l'employeur (employes)"},{k:"peculeDouble",l:"Pecule vacances double",calc:b=>Math.round(b*0.92*100)/100,ref:"Lois coord. 28/06/1971",desc:"92% de la remuneration mensuelle brute"},{k:"finAnnee",l:"Prime fin d'annee",calc:b=>Math.round(b*0.50*100)/100,ref:"CCT sectorielle CP200",desc:"Variable selon CP â€” souvent 50% a 100% du brut mensuel"},{k:"anciennete",l:"Prime anciennete",calc:b=>{const years=5;return Math.round(b*0.02*years*100)/100},ref:"CCT entreprise",desc:"2% par annee d'anciennete (exemple 5 ans)"},{k:"equipe",l:"Prime equipe/nuit",calc:b=>Math.round(b*0.15*100)/100,ref:"CCT 49 / sectorielle",desc:"Supplement 15% pour travail en equipe ou de nuit"},{k:"dimanche",l:"Prime dimanche",calc:b=>Math.round(b/21.66*2*100)/100,ref:"Loi 16/03/1971",desc:"Doublement du salaire journalier pour travail dominical"},{k:"astreinte",l:"Prime astreinte",calc:b=>Math.round(b*0.05*100)/100,ref:"CCT entreprise",desc:"Compensation pour disponibilite hors horaire (souvent 5-10%)"},{k:"reprise",l:"Prime de reprise",calc:b=>0,ref:"Art. 68 Loi 03/07/1978",desc:"Gratification libre lors de la reprise â€” montant libre"},{k:"resultat",l:"Bonus CCT 90",calc:b=>Math.min(3948,Math.round(b*0.5*100)/100),ref:"CCT 90 du 20/12/2007",desc:"Max 3.948 EUR/an â€” cotisation 33% vs ~55% remuneration normale"},{k:"naissance",l:"Prime naissance",calc:b=>0,ref:"CCT entreprise",desc:"Montant libre â€” verifier convention d'entreprise"},{k:"eco",l:"Eco-cheques",calc:b=>Math.round(250/12*100)/100,ref:"CCT 98",desc:"Max 250 EUR/an â€” totalement exoneres ONSS+PP"}];const selPrime=primeDefs.find(p=>p.k===simType)||primeDefs[0];const primeAmount=selPrime.calc(simBrut);const onssOnPrime=Math.round(primeAmount*0.1307*100)/100;const ppOnPrime=quickPP?Math.round(quickPP(primeAmount)*100)/100:Math.round(primeAmount*0.22*100)/100;const netPrime=primeAmount-onssOnPrime-ppOnPrime;const coutEmployeur=primeAmount+Math.round(primeAmount*0.2507*100)/100;const tabs=[{k:"simulation",l:"Simulation"},{k:"employes",l:"Primes par employe"},{k:"historique",l:"Historique"}];return <div><PH title="Gestion des Primes & Avantages" sub={"12 types de primes â€” "+ae.length+" travailleurs"}/><div style={{display:"flex",gap:4,marginBottom:14}}>{tabs.map(t=><button key={t.k} onClick={()=>setTab(t.k)} style={{padding:"8px 14px",borderRadius:8,border:"none",cursor:"pointer",fontSize:11,fontWeight:tab===t.k?600:400,fontFamily:"inherit",background:tab===t.k?"rgba(198,163,78,.15)":"rgba(255,255,255,.03)",color:tab===t.k?"#c6a34e":"#9e9b93"}}>{t.l}</button>)}</div>{tab==="simulation"&&<div><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:18}}>{[{l:"Prime brute",v:f2(primeAmount),c:"#c6a34e"},{l:"ONSS 13,07%",v:f2(onssOnPrime),c:"#ef4444"},{l:"Net travailleur",v:f2(netPrime),c:"#22c55e"},{l:"Cout employeur",v:f2(coutEmployeur),c:"#a78bfa"}].map((k,idx2)=><div key={idx2} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><C><ST>Parametres de simulation</ST><div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16}}><div><label style={{fontSize:10,color:"#888",display:"block",marginBottom:4}}>Salaire brut de reference</label><input type="range" min={1800} max={8000} step={50} value={simBrut} onChange={e2=>setSimBrut(+e2.target.value)} style={{width:"100%",accentColor:"#c6a34e"}}/><div style={{textAlign:"center",fontSize:12,color:"#c6a34e",marginTop:4}}>{f2(simBrut)} EUR</div></div><div><label style={{fontSize:10,color:"#888",display:"block",marginBottom:4}}>Type de prime</label><select value={simType} onChange={e2=>setSimType(e2.target.value)} style={{width:"100%",padding:10,borderRadius:8,border:"1px solid rgba(198,163,78,.2)",background:"rgba(0,0,0,.3)",color:"#e8e6e0",fontSize:12,fontFamily:"inherit"}}>{primeDefs.map(p=><option key={p.k} value={p.k}>{p.l}</option>)}</select></div></div><div style={{marginTop:14,padding:12,background:"rgba(198,163,78,.04)",borderRadius:8,borderLeft:"3px solid #c6a34e"}}><div style={{fontSize:12,fontWeight:600,color:"#c6a34e"}}>{selPrime.l}</div><div style={{fontSize:11,color:"#9e9b93",marginTop:3}}>{selPrime.desc}</div><div style={{fontSize:10,color:"#5e5c56",marginTop:3}}>Base legale: {selPrime.ref}</div></div></C></div>}{tab==="employes"&&<C><ST>Primes estimees par employe</ST><table style={{width:"100%",borderCollapse:"collapse",fontSize:11}}><thead><tr>{["Travailleur","Brut","13e mois","Pecule simple","Pecule double","Bonus CCT90"].map(h=><th key={h} style={{padding:"8px",textAlign:"left",color:"#c6a34e",borderBottom:"2px solid rgba(198,163,78,.2)",fontSize:10}}>{h}</th>)}</tr></thead><tbody>{ae.slice(0,20).map((e,idx3)=>{const b=e.gross||e.brut||0;return <tr key={idx3} style={{borderBottom:"1px solid rgba(255,255,255,.03)"}}><td style={{padding:"6px",fontWeight:600}}>{(e.first||e.fn||"")+" "+(e.last||e.ln||"")}</td><td style={{padding:"6px"}}>{f2(b)}</td><td style={{padding:"6px",color:"#c6a34e"}}>{f2(b)}</td><td style={{padding:"6px",color:"#22c55e"}}>{f2(b*0.1534)}</td><td style={{padding:"6px",color:"#60a5fa"}}>{f2(b*0.92)}</td><td style={{padding:"6px",color:"#a78bfa"}}>{f2(Math.min(3948,b*0.5))}</td></tr>})}</tbody></table></C>}{tab==="historique"&&<C><ST>Historique des primes versees</ST>{[{mois:"Dec 2025",type:"13e mois",total:f2(ae.reduce((a,e)=>a+(e.gross||e.brut||0),0)),nb:ae.length},{mois:"Jun 2025",type:"Pecule simple",total:f2(ae.reduce((a,e)=>a+(e.gross||e.brut||0)*0.1534,0)),nb:ae.length},{mois:"Mai 2025",type:"Pecule double",total:f2(ae.reduce((a,e)=>a+(e.gross||e.brut||0)*0.92,0)),nb:ae.length},{mois:"Dec 2024",type:"13e mois",total:f2(ae.reduce((a,e)=>a+(e.gross||e.brut||0)*0.98,0)),nb:ae.length},{mois:"Mar 2025",type:"Bonus CCT90",total:f2(ae.reduce((a,e)=>a+Math.min(3948,((e.gross||e.brut||0)*0.5)),0)),nb:ae.filter(e=>(e.gross||e.brut||0)<5000).length}].map((h,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div><div style={{fontSize:12,fontWeight:600,color:"#e8e6e0"}}>{h.type}</div><div style={{fontSize:10,color:"#5e5c56"}}>{h.mois} â€” {h.nb} travailleurs</div></div><span style={{fontSize:13,fontWeight:700,color:"#c6a34e"}}>{h.total} EUR</span></div>)}</C>}</div>;}

export function EcheancierPaiements({s}){const ae=(s.emps||[]).filter(e=>e.status==='active'||!e.status);const n=ae.length;const mb=ae.reduce((a,e)=>a+(+e.gross||0),0);const f0=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:0}).format(v);const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const onssP=Math.round(mb*TX_ONSS_E);const onssT=Math.round(mb*TX_ONSS_W);const ppTotal=ae.reduce((a,e)=>a+quickPP(+(e.gross||0)),0);const netTotal=ae.reduce((a,e)=>a+quickNet(+(e.gross||0)),0);const now=new Date();const mois=["Janvier","Fevrier","Mars","Avril","Mai","Juin","Juillet","Aout","Septembre","Octobre","Novembre","Decembre"];const curMonth=now.getMonth();const curYear=now.getFullYear();const [selMonth,setSelMonth]=useState(curMonth);const echeances=[{j:1,l:"Debut mois",desc:"Ouverture periode de paie",type:"info",montant:0},{j:5,l:"Provision ONSS",desc:"Provision mensuelle cotisations ONSS",type:"urgent",montant:onssP+onssT},{j:15,l:"Precompte professionnel",desc:"Versement PP au SPF Finances (declaration 274)",type:"urgent",montant:Math.round(ppTotal)},{j:25,l:"Virement salaires NET",desc:"SEPA pain.001 â€” Virements bancaires travailleurs",type:"paiement",montant:Math.round(netTotal)},{j:28,l:"Fiches de paie",desc:"Remise fiches de paie aux travailleurs",type:"doc",montant:0}];const trimestrielles=[[2,5,8,11].includes(selMonth)?[{j:30,l:"DmfA trimestrielle",desc:"Declaration multifonctionnelle ONSS (Q"+(Math.floor(selMonth/3)+1)+")",type:"urgent",montant:Math.round((onssP+onssT)*3)}]:[]];const annuelles=selMonth===1?[{j:28,l:"Fiches 281.10",desc:"Fiches fiscales aux travailleurs",type:"urgent",montant:0},{j:28,l:"Belcotax XML",desc:"Envoi XML au SPF Finances",type:"urgent",montant:0}]:selMonth===5?[{j:30,l:"Bilan social BNB",desc:"Depot annexe comptes annuels",type:"doc",montant:0}]:[];const allEch=[...echeances,...trimestrielles.flat(),...annuelles].sort((a,b)=>a.j-b.j);return <div><PH title="Echeancier Paiements" sub={"Calendrier obligations â€” "+n+" travailleurs â€” Masse "+f0(mb)+" EUR/mois"}/><div style={{display:"grid",gridTemplateColumns:"repeat(5,1fr)",gap:10,marginBottom:18}}>{[{l:"Salaires NET",v:f0(Math.round(netTotal))+" EUR",c:"#22c55e"},{l:"ONSS total",v:f0(onssP+onssT)+" EUR",c:"#ef4444"},{l:"PP total",v:f0(Math.round(ppTotal))+" EUR",c:"#fb923c"},{l:"Cout total/mois",v:f0(Math.round(mb*(1+TX_ONSS_E)))+" EUR",c:"#c6a34e"},{l:"Prochain paiement",v:"J"+allEch.filter(e=>e.j>=now.getDate())[0]?.j||"â€”",c:"#60a5fa"}].map((k,i)=><div key={i} style={{padding:"12px 14px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:9,color:"#5e5c56",textTransform:"uppercase",letterSpacing:".5px"}}>{k.l}</div><div style={{fontSize:16,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><div style={{display:"flex",gap:4,marginBottom:16,overflowX:"auto"}}>{mois.map((m,i)=><button key={i} onClick={()=>setSelMonth(i)} style={{padding:"6px 12px",borderRadius:8,border:"none",cursor:"pointer",fontSize:11,fontWeight:i===selMonth?700:400,fontFamily:"inherit",background:i===selMonth?"rgba(198,163,78,.15)":i===curMonth?"rgba(96,165,250,.08)":"rgba(255,255,255,.03)",color:i===selMonth?"#c6a34e":i===curMonth?"#60a5fa":"#9e9b93",whiteSpace:"nowrap"}}>{m.substring(0,3)}</button>)}</div><C><ST>{"Echeances â€” "+mois[selMonth]+" "+curYear}</ST>{allEch.map((e,i)=>{const color=e.type==="urgent"?"#ef4444":e.type==="paiement"?"#22c55e":e.type==="doc"?"#60a5fa":"#9e9b93";const isPast=selMonth===curMonth&&e.j<now.getDate();return <div key={i} style={{display:"flex",gap:12,padding:"12px 0",borderBottom:"1px solid rgba(255,255,255,.03)",opacity:isPast?0.5:1}}><div style={{width:40,textAlign:"center"}}><div style={{fontSize:18,fontWeight:700,color:color}}>{e.j}</div><div style={{fontSize:8,color:"#5e5c56"}}>{mois[selMonth].substring(0,3)}</div></div><div style={{flex:1}}><div style={{display:"flex",gap:8,alignItems:"center"}}><b style={{color:"#e8e6e0",fontSize:12}}>{e.l}</b><span style={{fontSize:8,padding:"1px 6px",borderRadius:4,background:color+"20",color:color}}>{e.type.toUpperCase()}</span>{isPast&&<span style={{fontSize:8,color:"#4ade80"}}>FAIT</span>}</div><div style={{fontSize:10.5,color:"#9e9b93",marginTop:2}}>{e.desc}</div></div>{e.montant>0&&<div style={{textAlign:"right",minWidth:100}}><div style={{fontSize:14,fontWeight:700,color:color}}>{f0(e.montant)} EUR</div></div>}</div>;})}</C></div>;}

export function Echeancier({s}){return <EcheancierPaiements s={s}/>;}

export function GestionVehicules({s}){const ae=(s.emps||[]).filter(e=>e.status==='active'||!e.status);const [tab,setTab]=useState("flotte");const [co2,setCo2]=useState(120);const [catVal,setCatVal]=useState(35000);const [fuel,setFuel]=useState("essence");const [age,setAge]=useState(2);const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const calcATN=(co2v,cat,fl,ag)=>{if(fl==='electrique')return Math.max(1600,cat*(6/7)*0.04)/12;const ref=fl==='diesel'?84:102;const pct=Math.max(4,Math.min(18,5.5+(co2v-ref)*0.1));const base=cat*(6/7)*(pct/100);return Math.max(1600,Math.round(base*(1-Math.min(ag,5)*0.06)))/12;};const vehicles=ae.filter(e=>e.carFuel&&e.carFuel!=='none'&&e.carFuel!=='').map(e=>{const atn=calcATN(+(e.carCO2||120),+(e.carCatVal||30000),e.carFuel||'essence',+(e.carAge||1));const cotCO2=e.carFuel==='electrique'?(LOIS_BELGES.cotisations?.cotCO2Min||31.34):Math.max(LOIS_BELGES.cotisations?.cotCO2Min||31.34,(+(e.carCO2||120))*(e.carFuel==='diesel'?0.51:0.60));return{...e,atn:Math.round(atn*100)/100,cotCO2:Math.round(cotCO2*100)/100,carMarque:e.carMarque||e.carBrand||'-',carModele:e.carModele||e.carModel||'-',plaque:e.carPlate||'-'};});const totalATN=vehicles.reduce((a,v)=>a+v.atn,0);const totalCO2=vehicles.reduce((a,v)=>a+v.cotCO2,0);const testATN=Math.round(calcATN(co2,catVal,fuel,age)*100)/100;return <div><PH title="Gestion Vehicules et ATN" sub={"Flotte: "+vehicles.length+" vehicules â€” Art. 36 CIR92 â€” LOIS_BELGES"}/><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:18}}>{[{l:"Vehicules flotte",v:vehicles.length,c:"#c6a34e"},{l:"ATN total/mois",v:f2(totalATN)+" EUR",c:"#60a5fa"},{l:"Cotis. CO2/mois",v:f2(totalCO2)+" EUR",c:"#ef4444"},{l:"Cout flotte/an",v:new Intl.NumberFormat('fr-BE',{minimumFractionDigits:0}).format(Math.round((totalATN+totalCO2)*12))+" EUR",c:"#a78bfa"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase",letterSpacing:".5px"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><div style={{display:"flex",gap:6,marginBottom:16}}>{[{v:"flotte",l:"Flotte ("+vehicles.length+")"},{v:"simulateur",l:"Simulateur ATN"},{v:"forfaits",l:"Forfaits ATN 2026"},{v:"regles",l:"Regles fiscales"}].map(t=><button key={t.v} onClick={()=>setTab(t.v)} style={{padding:"8px 16px",borderRadius:8,border:"none",cursor:"pointer",fontSize:12,fontWeight:tab===t.v?600:400,fontFamily:"inherit",background:tab===t.v?"rgba(198,163,78,.15)":"rgba(255,255,255,.03)",color:tab===t.v?"#c6a34e":"#9e9b93"}}>{t.l}</button>)}</div>{tab==="flotte"&&<C><ST>Liste des vehicules de societe</ST>{vehicles.length===0?<div style={{textAlign:"center",padding:40,color:"#5e5c56"}}><div style={{fontSize:32,marginBottom:8}}>ðŸš—</div><div style={{fontSize:14}}>Aucun vehicule enregistre</div><div style={{fontSize:11,marginTop:4}}>Ajoutez les champs carFuel, carCO2, carCatVal, carAge aux employes</div></div>:<div style={{overflowX:"auto"}}><table style={{width:"100%",borderCollapse:"collapse",fontSize:10}}><thead><tr style={{borderBottom:"2px solid rgba(198,163,78,.2)"}}>{["Conducteur","Marque/Modele","Plaque","Carburant","CO2 g/km","Val. catalogue","Age","ATN/mois","ATN/an","Cotis. CO2/mois"].map(h=><th key={h} style={{padding:"6px",textAlign:"left",color:"#c6a34e",fontWeight:600,fontSize:9,whiteSpace:"nowrap"}}>{h}</th>)}</tr></thead><tbody>{vehicles.map((v,i)=><tr key={v.id||i} style={{borderBottom:"1px solid rgba(255,255,255,.03)"}}><td style={{padding:"5px",fontWeight:600}}>{(v.first||v.fn||'')+" "+(v.last||v.ln||'')}</td><td style={{padding:"5px"}}>{v.carMarque+" "+v.carModele}</td><td style={{padding:"5px",fontFamily:"monospace",fontSize:9}}>{v.plaque}</td><td style={{padding:"5px"}}><span style={{fontSize:9,padding:"1px 6px",borderRadius:4,background:v.carFuel==='electrique'?"rgba(74,222,128,.1)":v.carFuel==='diesel'?"rgba(251,146,56,.1)":"rgba(96,165,250,.1)",color:v.carFuel==='electrique'?"#4ade80":v.carFuel==='diesel'?"#fb923c":"#60a5fa"}}>{v.carFuel}</span></td><td style={{padding:"5px"}}>{v.carCO2||"-"}</td><td style={{padding:"5px"}}>{new Intl.NumberFormat('fr-BE').format(+(v.carCatVal||0))} EUR</td><td style={{padding:"5px"}}>{v.carAge||"-"} ans</td><td style={{padding:"5px",fontWeight:700,color:"#c6a34e"}}>{f2(v.atn)}</td><td style={{padding:"5px"}}>{f2(v.atn*12)}</td><td style={{padding:"5px",color:"#ef4444"}}>{f2(v.cotCO2)}</td></tr>)}</tbody></table></div>}</C>}{tab==="simulateur"&&<C><ST>Simulateur ATN voiture</ST><div style={{display:"flex",gap:12,marginBottom:16,flexWrap:"wrap"}}><div><label style={{fontSize:10,color:"#888",display:"block",marginBottom:4}}>CO2 (g/km)</label><input type="number" value={co2} onChange={e=>setCo2(+e.target.value)} style={{padding:"8px 12px",borderRadius:8,border:"1px solid rgba(198,163,78,.2)",background:"rgba(0,0,0,.2)",color:"#e8e6e0",fontSize:13,width:100,fontFamily:"inherit"}}/></div><div><label style={{fontSize:10,color:"#888",display:"block",marginBottom:4}}>Val. catalogue EUR</label><input type="number" value={catVal} onChange={e=>setCatVal(+e.target.value)} style={{padding:"8px 12px",borderRadius:8,border:"1px solid rgba(198,163,78,.2)",background:"rgba(0,0,0,.2)",color:"#e8e6e0",fontSize:13,width:140,fontFamily:"inherit"}}/></div><div><label style={{fontSize:10,color:"#888",display:"block",marginBottom:4}}>Carburant</label><select value={fuel} onChange={e=>setFuel(e.target.value)} style={{padding:"8px 12px",borderRadius:8,border:"1px solid rgba(198,163,78,.2)",background:"rgba(0,0,0,.2)",color:"#e8e6e0",fontSize:13,fontFamily:"inherit"}}><option value="essence">Essence</option><option value="diesel">Diesel</option><option value="electrique">Electrique</option></select></div><div><label style={{fontSize:10,color:"#888",display:"block",marginBottom:4}}>Age vehicule</label><input type="number" value={age} min={0} max={10} onChange={e=>setAge(+e.target.value)} style={{padding:"8px 12px",borderRadius:8,border:"1px solid rgba(198,163,78,.2)",background:"rgba(0,0,0,.2)",color:"#e8e6e0",fontSize:13,width:80,fontFamily:"inherit"}}/></div></div><div style={{padding:16,background:"rgba(198,163,78,.04)",borderRadius:10}}><div style={{fontSize:22,fontWeight:700,color:"#c6a34e"}}>{f2(testATN)} EUR/mois</div><div style={{fontSize:12,color:"#9e9b93",marginTop:4}}>{f2(testATN*12)} EUR/an â€” ATN imposable pour le travailleur</div></div></C>}{tab==="forfaits"&&<C><ST>Forfaits ATN 2026 (AR 18/12/2024)</ST>{[{l:"GSM/smartphone",v:f2(LOIS_BELGES.avantages?.atnGSM||3)+" EUR/mois",d:"36 EUR/an"},{l:"PC/laptop",v:f2(LOIS_BELGES.avantages?.atnPC||6)+" EUR/mois",d:"72 EUR/an"},{l:"Internet",v:f2(LOIS_BELGES.avantages?.atnInternet||5)+" EUR/mois",d:"60 EUR/an"},{l:"Voiture electrique",v:"Min 4%, catalogue x 6/7",d:"Minimum ATN: 1.600 EUR/an"},{l:"Chauffage+Electricite",v:"265,83 EUR/mois total",d:"3.190 EUR/an forfaitaire"}].map((r,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div><b style={{color:"#e8e6e0",fontSize:12}}>{r.l}</b><div style={{fontSize:10,color:"#5e5c56"}}>{r.d}</div></div><div style={{fontSize:14,fontWeight:700,color:"#c6a34e"}}>{r.v}</div></div>)}</C>}{tab==="regles"&&<C><ST>Regles fiscales vehicules de societe</ST>{[{t:"Formule ATN: max(1600, Cat x 6/7 x CO2%) / 12",d:"CO2%: max(4%, min(18%, 5.5% + (CO2-ref) x 0.1)). Ref diesel=84, essence=102."},{t:"Reduction age: -6%/an (max 70% du neuf)",d:"Vehicule de 3 ans: ATN reduit de 18% par rapport au neuf."},{t:"Cotisation CO2 solidarite (employeur)",d:"Diesel: CO2 x 0.51 EUR/mois. Essence: CO2 x 0.60 EUR/mois. Min 31.34 EUR."},{t:"Electrique: ATN minimum garanti",d:"ATN = max(1600, Cat x 6/7 x 4%) / 12. Cotis CO2 = minimum."},{t:"Carte carburant = incluse dans ATN voiture",d:"Pas d'ATN supplementaire si carte liee a voiture de societe."},{t:"Budget mobilite (Loi 17/03/2019)",d:"Alternative a la voiture de societe. 3 piliers: voiture eco, mobilite douce, cash net."}].map((r,i)=><div key={i} style={{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><b style={{color:"#e8e6e0",fontSize:12}}>{r.t}</b><div style={{fontSize:10.5,color:"#9e9b93",marginTop:2}}>{r.d}</div></div>)}</C>}</div>;}

export function PromesseEmbauche({s,d}){const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const [form,setForm]=useState({employeur:s.company||"",bce:s.bce||"",adresseE:s.address||"",nom:"",prenom:"",niss:"",adresse:"",fonction:"",cp:"200",brut:"",regime:"temps plein",heures:"38",debut:"",typeContrat:"CDI",lieu:"",essai:"Non applicable depuis 2014",avantages:""});const u=(k,v)=>setForm(p=>({...p,[k]:v}));const brut=parseFloat(form.brut)||0;const onss=Math.round(brut*0.1307*100)/100;const pp=quickPP?quickPP(brut):Math.round(brut*0.22*100)/100;const net=brut-onss-pp;const coutE=brut+Math.round(brut*0.2507*100)/100;const generatePDF=()=>{aureuspdf('Promesse d\'Embauche',[{type:'title',text:'PROMESSE D\'EMBAUCHE'},{type:'line'},{type:'space',h:4},{type:'subtitle',text:'ENTRE:'},{type:'kv',k:'Employeur',v:s.co?.name||'[Entreprise]'},{type:'kv',k:'BCE',v:s.co?.vat||'[BCE]'},{type:'space',h:3},{type:'subtitle',text:'ET:'},{type:'kv',k:'Nom',v:(form.prenom||'')+' '+(form.nom||'')},{type:'kv',k:'NISS',v:form.niss||'[A completer]'},{type:'kv',k:'Adresse',v:form.adresse||'[A completer]'},{type:'space',h:4},{type:'line'},{type:'article',num:'Art. 1 â€” Objet',text:'Promesse d\'embauche ferme. Loi 03/07/1978.'},{type:'article',num:'Art. 2 â€” Fonction',text:'Fonction: '+(form.fonction||'[Fonction]')+'. Lieu: '+(form.lieu||'[Lieu]')+'.'},{type:'article',num:'Art. 3 â€” Remuneration',text:'Brut mensuel: '+f2(form.brut||0)+' EUR. Regime: '+(form.regime||100)+'%.'},{type:'article',num:'Art. 4 â€” Debut',text:'Entree en service: '+(form.debut||'[Date]')+'.'},{type:'article',num:'Art. 5 â€” Validite',text:'Valable 30 jours (Cass. 21/04/1997).'},{type:'space',h:8},{type:'signature'}],{filename:'promesse_embauche_'+(form.nom||''),enterprise:s.co?.name||''})};const fields=[{k:"employeur",l:"Nom de l'entreprise",w:"1fr"},{k:"bce",l:"NÂ° BCE",w:"1fr"},{k:"adresseE",l:"Adresse entreprise",w:"2fr"},{k:"nom",l:"Nom du futur travailleur",w:"1fr"},{k:"prenom",l:"Prenom",w:"1fr"},{k:"niss",l:"NISS (registre national)",w:"1fr"},{k:"adresse",l:"Adresse du travailleur",w:"2fr"},{k:"fonction",l:"Fonction / poste",w:"1fr"},{k:"cp",l:"Commission paritaire",w:"1fr"},{k:"brut",l:"Salaire brut mensuel (EUR)",w:"1fr"},{k:"regime",l:"Regime",w:"1fr"},{k:"heures",l:"Heures/semaine",w:"1fr"},{k:"debut",l:"Date d'entree prevue",w:"1fr"},{k:"typeContrat",l:"Type de contrat",w:"1fr"},{k:"lieu",l:"Lieu de travail",w:"1fr"},{k:"avantages",l:"Avantages extra-legaux",w:"2fr"}];return <div><PH title="Promesse d'Embauche" sub="Document legal â€” Art. 1134 C.civ. + Loi 03/07/1978"/><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:18}}>{[{l:"Brut mensuel",v:f2(brut),c:"#c6a34e"},{l:"Net estime",v:f2(net),c:"#22c55e"},{l:"Cout employeur",v:f2(coutE),c:"#a78bfa"},{l:"RMMMG respect",v:brut>=RMMMG||brut===0?"OK":"SOUS RMMMG!",c:brut>=RMMMG||brut===0?"#22c55e":"#ef4444"}].map((k,idx2)=><div key={idx2} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><C><ST>Donnees de la promesse</ST><div style={{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:10}}>{fields.map(fl=><div key={fl.k} style={{gridColumn:fl.w==="2fr"?"span 2":"span 1"}}><label style={{fontSize:10,color:"#888",display:"block",marginBottom:3}}>{fl.l}</label>{fl.k==="typeContrat"?<select value={form[fl.k]} onChange={e2=>u(fl.k,e2.target.value)} style={{width:"100%",padding:10,borderRadius:8,border:"1px solid rgba(198,163,78,.2)",background:"rgba(0,0,0,.3)",color:"#e8e6e0",fontSize:12,fontFamily:"inherit"}}><option value="CDI">CDI â€” Art. 6-8 Loi 03/07/1978</option><option value="CDD">CDD â€” Art. 9-10 (max 2 ans)</option><option value="Etudiant">Etudiant â€” Titre VII (600h/an)</option></select>:fl.k==="regime"?<select value={form[fl.k]} onChange={e2=>u(fl.k,e2.target.value)} style={{width:"100%",padding:10,borderRadius:8,border:"1px solid rgba(198,163,78,.2)",background:"rgba(0,0,0,.3)",color:"#e8e6e0",fontSize:12,fontFamily:"inherit"}}><option value="temps plein">Temps plein</option><option value="temps partiel">Temps partiel â€” AR 25/06/1990</option></select>:<input type={fl.k==="brut"||fl.k==="heures"?"number":"text"} value={form[fl.k]} onChange={e2=>u(fl.k,e2.target.value)} style={{width:"100%",padding:10,borderRadius:8,border:"1px solid rgba(198,163,78,.2)",background:"rgba(0,0,0,.2)",color:"#e8e6e0",fontSize:12,fontFamily:"inherit"}}/>}</div>)}</div></C><C><ST>Articles de loi applicables</ST>{[{ref:"Loi 03/07/1978",d:"Contrats de travail â€” Base du droit social belge"},{ref:"Art. 1134 C.civ.",d:"Engagement contractuel â€” La promesse engage l'employeur"},{ref:"CCT 43 â€” RMMMG",d:"Salaire minimum "+f2(RMMMG)+" EUR (2026)"},{ref:"LSS Art. 23",d:"Cotisations ONSS: 13,07% travailleur, ~25,07% patronal"},{ref:"Loi 16/03/1971 Art. 19",d:"Duree du travail: max 38h/semaine"},{ref:"Art. 17 Loi 03/07/1978",d:"Obligation de confidentialite du travailleur"},{ref:"Loi 26/12/2013",d:"Suppression de la periode d'essai (sauf etudiants)"}].map((r,i)=><div key={i} style={{display:"flex",gap:8,padding:"6px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><span style={{fontSize:10,fontWeight:700,color:"#c6a34e",minWidth:130}}>{r.ref}</span><span style={{fontSize:10,color:"#9e9b93"}}>{r.d}</span></div>)}</C><div style={{textAlign:"center",marginTop:16}}><button onClick={generatePDF} style={{padding:"14px 40px",borderRadius:8,border:"none",background:"linear-gradient(135deg,#c6a34e,#a68a3c)",color:"#0c0b09",fontWeight:700,fontSize:14,cursor:"pointer",fontFamily:"inherit"}}>{"\ud83d\udcc4"} Generer la promesse d'embauche</button></div></div>;}

export function CalcJoursPrestes({s,d}){const ae=(s.emps||[]).filter(e=>e.status==='active'||!e.status);const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const [mois,setMois]=useState(new Date().getMonth());const [annee]=useState(2026);const noms=["Janvier","Fevrier","Mars","Avril","Mai","Juin","Juillet","Aout","Septembre","Octobre","Novembre","Decembre"];const feriesBE=[{d:"01-01",n:"Jour de l'An"},{d:"04-06",n:"Lundi de Paques"},{d:"05-01",n:"Fete du Travail"},{d:"05-14",n:"Ascension"},{d:"05-25",n:"Lundi de Pentecote"},{d:"07-21",n:"Fete nationale"},{d:"08-15",n:"Assomption"},{d:"11-01",n:"Toussaint"},{d:"11-11",n:"Armistice"},{d:"12-25",n:"Noel"}];const isFerie=(d)=>feriesBE.some(f=>f.d===String(d.getMonth()+1).padStart(2,"0")+"-"+String(d.getDate()).padStart(2,"0"));const isWE=(d)=>d.getDay()===0||d.getDay()===6;const daysInMonth=new Date(annee,mois+1,0).getDate();const joursOuvrables=Array.from({length:daysInMonth},(_,i)=>new Date(annee,mois,i+1)).filter(d=>!isWE(d)&&!isFerie(d)).length;const feriesMois=Array.from({length:daysInMonth},(_,i)=>new Date(annee,mois,i+1)).filter(d=>isFerie(d)&&!isWE(d));const absTypes=[{id:"conge",label:"Conge annuel",color:"#60a5fa",impact:"Pas de deduction â€” droit legal 20j/an",legal:"AR 28/06/1971"},{id:"maladie",label:"Maladie",color:"#ef4444",impact:"Salaire garanti 30j (employe) / 7j+7j+16j (ouvrier)",legal:"Loi 03/07/1978 Art. 52-57"},{id:"petit_chomage",label:"Petit chomage",color:"#a78bfa",impact:"Salaire normal maintenu â€” evenements legaux",legal:"AR 28/08/1963"},{id:"formation",label:"Formation",color:"#22c55e",impact:"Maintien salaire â€” 5j/an (droit formation)",legal:"Loi 03/10/2022"},{id:"credit_temps",label:"Credit-temps",color:"#fb923c",impact:"Salaire au prorata â€” allocation ONEM",legal:"CCT 103"},{id:"maternite",label:"Maternite/Paternite",color:"#f472b6",impact:"15 sem maternite / 20j paternite â€” mutuelle apres salaire garanti",legal:"Loi 03/07/1978 Art. 39"},{id:"accident",label:"Accident travail",color:"#dc2626",impact:"90% remuneration â€” assurance AT",legal:"Loi 10/04/1971"},{id:"sans_solde",label:"Sans solde (injustifie)",color:"#5e5c56",impact:"Deduction 1/joursOuvrables du brut mensuel",legal:"Art. 27 Loi 03/07/1978"}];return <div><PH title="Calcul Jours Prestes" sub={noms[mois]+" "+annee+" â€” "+joursOuvrables+" jours ouvrables â€” "+feriesMois.length+" jour(s) ferie(s)"}/><div style={{display:"grid",gridTemplateColumns:"repeat(5,1fr)",gap:10,marginBottom:18}}>{[{l:"Jours calendrier",v:daysInMonth,c:"#e8e6e0"},{l:"Jours ouvrables",v:joursOuvrables,c:"#c6a34e"},{l:"Week-ends",v:daysInMonth-joursOuvrables-feriesMois.length,c:"#5e5c56"},{l:"Jours feries",v:feriesMois.length,c:"#60a5fa"},{l:"Travailleurs",v:ae.length,c:"#22c55e"}].map((k,i)=><div key={i} style={{padding:"12px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)",textAlign:"center"}}><div style={{fontSize:9,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:2}}>{k.v}</div></div>)}</div><div style={{display:"flex",gap:4,marginBottom:16,flexWrap:"wrap"}}>{noms.map((n,i)=><button key={i} onClick={()=>setMois(i)} style={{padding:"6px 10px",borderRadius:8,border:"none",cursor:"pointer",fontSize:10,fontWeight:mois===i?600:400,fontFamily:"inherit",background:mois===i?"rgba(198,163,78,.15)":"rgba(255,255,255,.03)",color:mois===i?"#c6a34e":"#9e9b93"}}>{n.slice(0,3)}</button>)}</div><C><ST>Jours feries belges â€” {noms[mois]} {annee}</ST>{feriesMois.length>0?feriesMois.map((d,i)=>{const ferie=feriesBE.find(f=>f.d===String(d.getMonth()+1).padStart(2,"0")+"-"+String(d.getDate()).padStart(2,"0"));return <div key={i} style={{display:"flex",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><span style={{fontSize:12,color:"#60a5fa"}}>{d.toLocaleDateString('fr-BE',{weekday:'long',day:'numeric',month:'long'})}</span><span style={{fontSize:11,color:"#e8e6e0"}}>{ferie?ferie.n:""}</span></div>}):<div style={{fontSize:11,color:"#5e5c56",padding:8}}>Aucun jour ferie ce mois-ci</div>}</C><C><ST>Types d'absences et impact paie</ST>{absTypes.map((t,i)=><div key={i} style={{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,.04)"}}><div style={{display:"flex",alignItems:"center",gap:8,marginBottom:4}}><span style={{width:10,height:10,borderRadius:"50%",background:t.color}}></span><span style={{fontSize:13,fontWeight:600,color:"#e8e6e0"}}>{t.label}</span><span style={{fontSize:9,padding:"2px 8px",borderRadius:10,background:"rgba(198,163,78,.08)",color:"#c6a34e"}}>{t.legal}</span></div><div style={{fontSize:11,color:"#9e9b93",marginLeft:18}}>{t.impact}</div></div>)}</C><C><ST>Calcul par travailleur â€” {noms[mois]}</ST>{ae.length===0?<div style={{textAlign:"center",padding:20,color:"#5e5c56"}}>Aucun travailleur</div>:<table style={{width:"100%",borderCollapse:"collapse",fontSize:11}}><thead><tr>{["Travailleur","Brut mensuel","Jours prestes","Absences","Salaire du","Base 1/"+joursOuvrables].map(h=><th key={h} style={{padding:"8px",textAlign:"left",color:"#c6a34e",borderBottom:"2px solid rgba(198,163,78,.2)",fontSize:10}}>{h}</th>)}</tr></thead><tbody>{ae.slice(0,20).map((e,i)=>{const brut=e.gross||e.brut||0;const abs=e.absences||0;const preste=joursOuvrables-abs;const salaire=abs>0?Math.round(brut*(preste/joursOuvrables)*100)/100:brut;return <tr key={i} style={{borderBottom:"1px solid rgba(255,255,255,.03)"}}><td style={{padding:"6px"}}>{(e.first||e.fn||"")+" "+(e.last||e.ln||"")}</td><td style={{padding:"6px"}}>{f2(brut)}</td><td style={{padding:"6px",color:"#22c55e"}}>{preste}/{joursOuvrables}</td><td style={{padding:"6px",color:abs>0?"#ef4444":"#22c55e"}}>{abs>0?abs+" j":"0"}</td><td style={{padding:"6px",fontWeight:600,color:abs>0?"#fb923c":"#e8e6e0"}}>{f2(salaire)}</td><td style={{padding:"6px",fontSize:10,color:"#5e5c56"}}>{f2(brut/joursOuvrables)}/j</td></tr>})}</tbody></table>}</C></div>;}

export function WorkflowAbsences({s,d}){const ae=(s.emps||[]).filter(e=>e.status==='active'||!e.status);const [tab,setTab]=useState("demandes");const [demandes,setDemandes]=useState([{id:1,emp:"Dupont Jean",type:"Conge annuel",debut:"2026-03-10",fin:"2026-03-14",jours:5,status:"pending",motif:"Vacances familiales",impact:"Pas de deduction (conge legal)"},{id:2,emp:"Martin Paul",type:"Maladie",debut:"2026-02-18",fin:"2026-02-21",jours:4,status:"approved",motif:"Certificat medical",impact:"Salaire garanti (Loi 03/07/1978 Art. 52)"},{id:3,emp:"Leroy Marie",type:"Formation",debut:"2026-03-05",fin:"2026-03-05",jours:1,status:"approved",motif:"Formation Excel",impact:"Salaire maintenu (droit formation 5j/an)"}]);const approve=(id)=>setDemandes(d2=>d2.map(d3=>d3.id===id?{...d3,status:"approved"}:d3));const reject=(id)=>setDemandes(d2=>d2.map(d3=>d3.id===id?{...d3,status:"rejected"}:d3));const soldesConge=ae.map(e=>{const nom=(e.first||e.fn||"")+" "+(e.last||e.ln||"");const total=e.conge_total||20;const pris=e.conge_pris||0;return{nom,total,pris,reste:total-pris,maladie:e.jours_maladie||0,formation:e.jours_formation||0}});return <div><PH title="Workflow Absences" sub={"Demande \u2192 Approbation \u2192 Impact paie automatique â€” "+demandes.length+" demandes"}/><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:18}}>{[{l:"En attente",v:demandes.filter(d3=>d3.status==="pending").length,c:"#fb923c"},{l:"Approuvees",v:demandes.filter(d3=>d3.status==="approved").length,c:"#22c55e"},{l:"Refusees",v:demandes.filter(d3=>d3.status==="rejected").length,c:"#ef4444"},{l:"Total demandes",v:demandes.length,c:"#c6a34e"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><div style={{display:"flex",gap:4,marginBottom:16}}>{[{k:"demandes",l:"Demandes"},{k:"soldes",l:"Soldes conges"},{k:"calendrier",l:"Calendrier equipe"},{k:"regles",l:"Regles"}].map(t=><button key={t.k} onClick={()=>setTab(t.k)} style={{padding:"8px 14px",borderRadius:8,border:"none",cursor:"pointer",fontSize:11,fontWeight:tab===t.k?600:400,fontFamily:"inherit",background:tab===t.k?"rgba(198,163,78,.15)":"rgba(255,255,255,.03)",color:tab===t.k?"#c6a34e":"#9e9b93"}}>{t.l}</button>)}</div>{tab==="demandes"&&<C><ST>Demandes d'absence</ST>{demandes.map(d3=><div key={d3.id} style={{padding:14,marginBottom:8,background:d3.status==="pending"?"rgba(251,146,56,.04)":d3.status==="approved"?"rgba(34,197,94,.04)":"rgba(239,68,68,.04)",borderRadius:8,borderLeft:"3px solid "+(d3.status==="pending"?"#fb923c":d3.status==="approved"?"#22c55e":"#ef4444")}}><div style={{display:"flex",justifyContent:"space-between",marginBottom:6}}><div><div style={{fontSize:13,fontWeight:700,color:"#e8e6e0"}}>{d3.emp}</div><div style={{fontSize:11,color:"#c6a34e"}}>{d3.type} â€” {d3.jours} jour(s)</div></div><span style={{fontSize:10,padding:"3px 10px",borderRadius:10,background:d3.status==="pending"?"rgba(251,146,56,.15)":d3.status==="approved"?"rgba(34,197,94,.15)":"rgba(239,68,68,.15)",color:d3.status==="pending"?"#fb923c":d3.status==="approved"?"#22c55e":"#ef4444"}}>{d3.status==="pending"?"En attente":d3.status==="approved"?"\u2713 Approuve":"Refuse"}</span></div><div style={{fontSize:11,color:"#9e9b93"}}>{d3.debut} au {d3.fin} â€” {d3.motif}</div><div style={{fontSize:10,color:"#60a5fa",marginTop:4}}>Impact paie: {d3.impact}</div>{d3.status==="pending"&&<div style={{display:"flex",gap:8,marginTop:8}}><button onClick={()=>approve(d3.id)} style={{padding:"6px 14px",borderRadius:6,border:"none",background:"rgba(34,197,94,.15)",color:"#22c55e",fontSize:11,cursor:"pointer",fontWeight:600,fontFamily:"inherit"}}>Approuver</button><button onClick={()=>reject(d3.id)} style={{padding:"6px 14px",borderRadius:6,border:"none",background:"rgba(239,68,68,.15)",color:"#ef4444",fontSize:11,cursor:"pointer",fontWeight:600,fontFamily:"inherit"}}>Refuser</button></div>}</div>)}</C>}{tab==="soldes"&&<C><ST>Soldes de conges par travailleur</ST><table style={{width:"100%",borderCollapse:"collapse",fontSize:11}}><thead><tr>{["Travailleur","Total","Pris","Reste","Maladie","Formation"].map(h=><th key={h} style={{padding:"8px",textAlign:"left",color:"#c6a34e",borderBottom:"2px solid rgba(198,163,78,.2)",fontSize:10}}>{h}</th>)}</tr></thead><tbody>{soldesConge.map((s2,i)=><tr key={i} style={{borderBottom:"1px solid rgba(255,255,255,.03)"}}><td style={{padding:"6px",fontWeight:500}}>{s2.nom||"Employe "+(i+1)}</td><td style={{padding:"6px"}}>{s2.total}j</td><td style={{padding:"6px"}}>{s2.pris}j</td><td style={{padding:"6px",fontWeight:700,color:s2.reste<=5?"#ef4444":"#22c55e"}}>{s2.reste}j</td><td style={{padding:"6px",color:"#ef4444"}}>{s2.maladie}j</td><td style={{padding:"6px",color:"#60a5fa"}}>{s2.formation}j</td></tr>)}</tbody></table></C>}{tab==="calendrier"&&<C><ST>Vue equipe â€” Fevrier 2026</ST><div style={{fontSize:11,color:"#9e9b93",marginBottom:12}}>Vue d'ensemble des absences prevues par l'equipe</div>{ae.slice(0,10).map((e,i)=>{const nom=(e.first||e.fn||"")+" "+(e.last||e.ln||"");return <div key={i} style={{display:"flex",gap:8,alignItems:"center",padding:"6px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><span style={{width:100,fontSize:11,fontWeight:500,color:"#e8e6e0",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}>{nom}</span><div style={{flex:1,display:"flex",gap:1}}>{Array.from({length:20},(_,j)=>{const isAbs=Math.random()<0.08;return <div key={j} style={{flex:1,height:16,borderRadius:2,background:isAbs?"rgba(239,68,68,.3)":"rgba(34,197,94,.1)"}}/>})}</div></div>})}<div style={{display:"flex",gap:12,marginTop:8,fontSize:10,color:"#5e5c56"}}><span><span style={{display:"inline-block",width:8,height:8,borderRadius:2,background:"rgba(34,197,94,.3)",marginRight:4,verticalAlign:"middle"}}/>Present</span><span><span style={{display:"inline-block",width:8,height:8,borderRadius:2,background:"rgba(239,68,68,.3)",marginRight:4,verticalAlign:"middle"}}/>Absent</span></div></C>}{tab==="regles"&&<C><ST>Regles d'absence â€” Droit belge</ST>{[{l:"Conge annuel legal",v:"20 jours/an (regime 5j/sem)",ref:"AR 28/06/1971"},{l:"Petit chomage â€” Mariage",v:"2 jours",ref:"AR 28/08/1963"},{l:"Petit chomage â€” Deces conjoint/enfant",v:"10 jours",ref:"Loi 27/06/2021"},{l:"Petit chomage â€” Demenagement",v:"1 jour",ref:"AR 28/08/1963"},{l:"Maladie â€” Salaire garanti employe",v:"30 jours",ref:"Art. 52 Loi 03/07/1978"},{l:"Maladie â€” Salaire garanti ouvrier",v:"7j 100% + 7j 85,88% + 16j 25,88%",ref:"Art. 54 Loi 03/07/1978"},{l:"Maternite",v:"15 semaines (6 avant + 9 apres)",ref:"Art. 39 Loi 03/07/1978"},{l:"Paternite/Co-parent",v:"20 jours (3j employeur + 17j mutuelle 82%)",ref:"Art. 30Â§2 Loi 03/07/1978"},{l:"Credit-temps",v:"Variable â€” allocation ONEM",ref:"CCT 103"},{l:"Formation",v:"5 jours/an (droit individuel)",ref:"Loi 03/10/2022"}].map((r,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div><div style={{fontSize:12,fontWeight:600,color:"#e8e6e0"}}>{r.l}</div><div style={{fontSize:10,color:"#c6a34e"}}>{r.ref}</div></div><span style={{fontSize:11,fontWeight:600,color:"#9e9b93"}}>{r.v}</span></div>)}</C>}</div>;}

export function RegulPPAnnuelle({s,d}){const ae=(s.emps||[]).filter(e=>e.status==='active'||!e.status);const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const [annee]=useState(2026);return <div><PH title="Regularisation PP Annuelle" sub={"Recalcul precompte professionnel fin d'annee â€” "+ae.length+" travailleurs"}/><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:18}}>{[{l:"Annee fiscale",v:annee,c:"#c6a34e"},{l:"Travailleurs",v:ae.length,c:"#60a5fa"},{l:"PP retenu total",v:f2(ae.reduce((a,e)=>{const b=e.gross||e.brut||0;return a+(e.pp||Math.round(b*0.22*100)/100)},0)*12),c:"#ef4444"},{l:"PP du annuel",v:f2(ae.reduce((a,e)=>{const b=e.gross||e.brut||0;const annuel=b*12;const ppAnnuel=quickPP?quickPP(annuel/12)*12:Math.round(annuel*0.22*100)/100;return a+ppAnnuel},0)),c:"#fb923c"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><C><ST>Regularisation par travailleur</ST><div style={{fontSize:11,color:"#9e9b93",marginBottom:12}}>Comparaison du PP retenu mensuellement vs PP reel du sur base du revenu annuel.<br/>Base legale: AR Precompte professionnel â€” SPF Finances â€” Exercice d'imposition {annee+1}</div>{ae.length===0?<div style={{textAlign:"center",padding:20,color:"#5e5c56"}}>Aucun travailleur</div>:<table style={{width:"100%",borderCollapse:"collapse",fontSize:11}}><thead><tr>{["Travailleur","Brut mensuel","PP mensuel retenu","PP annuel retenu","PP annuel du","Ecart","Action"].map(h=><th key={h} style={{padding:"8px",textAlign:"left",color:"#c6a34e",borderBottom:"2px solid rgba(198,163,78,.2)",fontSize:9}}>{h}</th>)}</tr></thead><tbody>{ae.slice(0,20).map((e,i)=>{const brut=e.gross||e.brut||0;const ppMens=e.pp||Math.round(brut*0.22*100)/100;const ppRetenu=ppMens*12;const annuel=brut*12;const tranches=[{max:15200,taux:0.25},{max:26830,taux:0.40},{max:46440,taux:0.45},{max:Infinity,taux:0.50}];let ppDu=0;let reste=annuel-4880;tranches.forEach(t=>{if(reste>0){const taxable=Math.min(reste,t.max-(annuel-reste>t.max?t.max:annuel-reste-4880));ppDu+=Math.max(0,Math.min(reste,t.max)*t.taux);reste-=t.max}});ppDu=quickPP?quickPP(brut)*12:Math.round(annuel*0.22);const ecart=Math.round((ppRetenu-ppDu)*100)/100;return <tr key={i} style={{borderBottom:"1px solid rgba(255,255,255,.03)"}}><td style={{padding:"6px"}}>{(e.first||e.fn||"")+" "+(e.last||e.ln||"")}</td><td style={{padding:"6px"}}>{f2(brut)}</td><td style={{padding:"6px"}}>{f2(ppMens)}</td><td style={{padding:"6px"}}>{f2(ppRetenu)}</td><td style={{padding:"6px",color:"#fb923c"}}>{f2(ppDu)}</td><td style={{padding:"6px",fontWeight:700,color:ecart>10?"#22c55e":ecart<-10?"#ef4444":"#5e5c56"}}>{ecart>0?"+":""}{f2(ecart)}</td><td style={{padding:"6px",fontSize:9,color:ecart>10?"#22c55e":ecart<-10?"#ef4444":"#5e5c56"}}>{ecart>50?"Trop retenu â€” rembourser":ecart<-50?"Insuffisant â€” retenir":"OK"}</td></tr>})}</tbody></table>}</C><C><ST>Facteurs affectant la regularisation</ST>{[{l:"13e mois / Prime fin d'annee",d:"PP retenu forfaitairement â€” souvent trop eleve",ref:"Art. 88 AR/CIR 92"},{l:"Situation familiale changee",d:"Mariage, naissance, divorce en cours d'annee",ref:"Art. 86 AR/CIR 92"},{l:"Avantages en nature (ATN)",d:"Recalcul ATN voiture, GSM, logement sur l'annee",ref:"Art. 36 CIR/92"},{l:"Bonus CCT 90",d:"Cotisation speciale de 13,07% au lieu de PP normal",ref:"CCT n\u00b090"},{l:"Heures supplementaires",d:"Sursalaire 50%/100% avec regime fiscal favorable",ref:"Art. 154bis CIR/92"},{l:"Reduction PP premier emploi",d:"Reduction structurelle sur les bas salaires",ref:"Art. 289ter CIR/92"}].map((f,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div><div style={{fontSize:12,fontWeight:600,color:"#e8e6e0"}}>{f.l}</div><div style={{fontSize:10,color:"#5e5c56"}}>{f.d}</div></div><span style={{fontSize:9,color:"#c6a34e"}}>{f.ref}</span></div>)}</C></div>;}

export function ExportWinbooks({s,d}){const ae=(s.emps||[]).filter(e=>e.status==='active'||!e.status);const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const [format,setFormat]=useState("winbooks");const [periode]=useState(new Date().toISOString().slice(0,7));const masseBrut=ae.reduce((a,e)=>a+(e.gross||e.brut||0),0);const exportWinbooks=()=>{const lines=[];const date=new Date().toLocaleDateString('fr-BE').split('/').reverse().join('');lines.push("ACT\t"+date+"\t620000\tD\t"+masseBrut.toFixed(2)+"\tRemunerations brutes");lines.push("ACT\t"+date+"\t621000\tD\t"+(masseBrut*0.2507).toFixed(2)+"\tONSS patronal");ae.forEach(e=>{const brut=e.gross||e.brut||0;const onss=Math.round(brut*0.1307*100)/100;const pp=Math.round(brut*0.22*100)/100;const net=brut-onss-pp;const nom=(e.first||e.fn||"")+" "+(e.last||e.ln||"");lines.push("ACT\t"+date+"\t454000\tC\t"+onss.toFixed(2)+"\tONSS trav. "+nom);lines.push("ACT\t"+date+"\t453100\tC\t"+pp.toFixed(2)+"\tPP "+nom);lines.push("ACT\t"+date+"\t455000\tC\t"+net.toFixed(2)+"\tNet "+nom)});const txt=lines.join("\n");const b=new Blob([txt],{type:"text/plain;charset=utf-8"});const u=URL.createObjectURL(b);const a=document.createElement("a");a.href=u;a.download="winbooks_paie_"+periode+".act";a.click()};const exportBOB50=()=>{const lines=["DBKCODE\tDOCNUMBER\tDOCDATE\tACCOUNTGL\tAMOUNTEUR\tDC\tCOMMENT"];const date=new Date().toISOString().slice(0,10);lines.push("SAL\t1\t"+date+"\t620000\t"+masseBrut.toFixed(2)+"\tD\tRemunerations brutes");lines.push("SAL\t1\t"+date+"\t621000\t"+(masseBrut*0.2507).toFixed(2)+"\tD\tONSS patronal");lines.push("SAL\t1\t"+date+"\t454000\t"+(masseBrut*0.1307).toFixed(2)+"\tC\tONSS travailleur");const ppTotal=ae.reduce((a,e)=>a+Math.round((e.gross||e.brut||0)*0.22*100)/100,0);lines.push("SAL\t1\t"+date+"\t453100\t"+ppTotal.toFixed(2)+"\tC\tPrecompte professionnel");lines.push("SAL\t1\t"+date+"\t455000\t"+(masseBrut-masseBrut*0.1307-ppTotal).toFixed(2)+"\tC\tNet a payer");const txt=lines.join("\n");const b=new Blob([txt],{type:"text/tab-separated-values"});const u=URL.createObjectURL(b);const a=document.createElement("a");a.href=u;a.download="bob50_paie_"+periode+".tsv";a.click()};const exportExact=()=>{const lines=["Journal;Date;Compte;Description;Debit;Credit"];const date=new Date().toLocaleDateString('fr-BE');lines.push("SAL;"+date+";620000;Remunerations;"+masseBrut.toFixed(2)+";");lines.push("SAL;"+date+";621000;ONSS patronal;"+(masseBrut*0.2507).toFixed(2)+";");lines.push("SAL;"+date+";454000;ONSS travailleur;;"+(masseBrut*0.1307).toFixed(2));const ppTotal=ae.reduce((a,e)=>a+Math.round((e.gross||e.brut||0)*0.22*100)/100,0);lines.push("SAL;"+date+";453100;Precompte professionnel;;"+ppTotal.toFixed(2));lines.push("SAL;"+date+";455000;Net a payer;;"+(masseBrut-masseBrut*0.1307-ppTotal).toFixed(2));const txt=lines.join("\n");const b=new Blob([txt],{type:"text/csv;charset=utf-8"});const u=URL.createObjectURL(b);const a=document.createElement("a");a.href=u;a.download="exact_paie_"+periode+".csv";a.click()};return <div><PH title="Export Comptabilite" sub={"Formats natifs Winbooks, BOB50, Exact Online â€” "+ae.length+" travailleurs"}/><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:18}}>{[{l:"Masse brute",v:f2(masseBrut),c:"#c6a34e"},{l:"ONSS patronal",v:f2(masseBrut*0.2507),c:"#ef4444"},{l:"ONSS travailleur",v:f2(masseBrut*0.1307),c:"#ef4444"},{l:"Total cout",v:f2(masseBrut*1.2507),c:"#a78bfa"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><C><ST>Formats d'export natifs</ST><div style={{display:"grid",gridTemplateColumns:"repeat(3,1fr)",gap:12}}>{[{n:"Winbooks Desktop",fmt:"Format ACT (tab-separated)",ext:".act",fn:exportWinbooks,color:"#22c55e"},{n:"BOB50 / Sage BOB",fmt:"Format TSV avec header DBKCODE",ext:".tsv",fn:exportBOB50,color:"#60a5fa"},{n:"Exact Online",fmt:"CSV avec journal SAL",ext:".csv",fn:exportExact,color:"#a78bfa"}].map((exp,i)=><div key={i} style={{padding:16,background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)",textAlign:"center"}}><div style={{fontSize:14,fontWeight:700,color:exp.color,marginBottom:6}}>{exp.n}</div><div style={{fontSize:10,color:"#5e5c56",marginBottom:10}}>{exp.fmt} ({exp.ext})</div><button onClick={exp.fn} style={{padding:"10px 24px",borderRadius:8,border:"none",background:"rgba("+( i===0?"34,197,94":i===1?"96,165,250":"167,139,250")+",.15)",color:exp.color,fontWeight:600,fontSize:12,cursor:"pointer",fontFamily:"inherit"}}>Exporter {exp.ext}</button></div>)}</div></C><C><ST>Plan comptable utilise</ST>{[{compte:"620000",lib:"Remunerations brutes",type:"D"},{compte:"621000",lib:"ONSS patronal (25,07%)",type:"D"},{compte:"454000",lib:"ONSS travailleur (13,07%)",type:"C"},{compte:"453100",lib:"Precompte professionnel",type:"C"},{compte:"455000",lib:"Net a payer",type:"C"},{compte:"453000",lib:"Cheques-repas patronal",type:"D"},{compte:"617000",lib:"Frais propres employeur",type:"D"}].map((pc,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",padding:"6px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div style={{display:"flex",gap:10}}><span style={{fontSize:12,fontWeight:700,color:"#c6a34e",fontFamily:"monospace"}}>{pc.compte}</span><span style={{fontSize:12,color:"#e8e6e0"}}>{pc.lib}</span></div><span style={{fontSize:10,padding:"2px 8px",borderRadius:10,background:pc.type==="D"?"rgba(239,68,68,.1)":"rgba(34,197,94,.1)",color:pc.type==="D"?"#ef4444":"#22c55e"}}>{pc.type==="D"?"Debit":"Credit"}</span></div>)}</C></div>;}

export function ParserImportConcurrent({s,d}){const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const [tab,setTab]=useState("import");const [fichesImportees,setFichesImportees]=useState([]);const [comparaison,setComparaison]=useState([]);const parseFiche=(text)=>{const lines=text.split("\n");const data={};lines.forEach(l=>{const clean=l.trim();if(clean.match(/brut/i))data.brut=parseFloat(clean.replace(/[^\d.,]/g,'').replace(',','.'))||0;if(clean.match(/onss|cotis.*social/i))data.onss=parseFloat(clean.replace(/[^\d.,]/g,'').replace(',','.'))||0;if(clean.match(/pr[eÃ©]compte|PP/i))data.pp=parseFloat(clean.replace(/[^\d.,]/g,'').replace(',','.'))||0;if(clean.match(/net/i)&&!clean.match(/brut/i))data.net=parseFloat(clean.replace(/[^\d.,]/g,'').replace(',','.'))||0;if(clean.match(/niss|registre/i))data.niss=clean.replace(/.*[:=]\s*/,'').trim();if(clean.match(/nom|travailleur/i))data.nom=clean.replace(/.*[:=]\s*/,'').trim()});return data};const handleFile=()=>{const input=document.createElement("input");input.type="file";input.accept=".csv,.txt";input.multiple=true;input.onchange=(e)=>{Array.from(e.target.files).forEach(file=>{const reader=new FileReader();reader.onload=(ev)=>{const parsed=parseFiche(ev.target.result);const brut=parsed.brut||0;const onssCalc=Math.round(brut*0.1307*100)/100;const ppCalc=quickPP?quickPP(brut):Math.round(brut*0.22*100)/100;const netCalc=brut-onssCalc-ppCalc;const errors=[];if(parsed.onss&&Math.abs(parsed.onss-onssCalc)>2)errors.push({type:"ONSS",old:parsed.onss,new:onssCalc,diff:parsed.onss-onssCalc});if(parsed.pp&&Math.abs(parsed.pp-ppCalc)>5)errors.push({type:"PP",old:parsed.pp,new:ppCalc,diff:parsed.pp-ppCalc});if(parsed.net&&Math.abs(parsed.net-netCalc)>5)errors.push({type:"Net",old:parsed.net,new:netCalc,diff:parsed.net-netCalc});if(brut>0&&brut<RMMMG)errors.push({type:"RMMMG",old:brut,new:RMMMG,diff:RMMMG-brut});setFichesImportees(prev=>[...prev,{file:file.name,data:parsed,brut,onssCalc,ppCalc,netCalc,errors}]);if(errors.length>0)setComparaison(prev=>[...prev,...errors.map(er=>({...er,file:file.name,emp:parsed.nom||file.name}))])};reader.readAsText(file)})};input.click()};const totalErrors=fichesImportees.reduce((a,f)=>a+f.errors.length,0);return <div><PH title="Import & Audit Fiches Concurrent" sub={"Parser multi-format â€” "+fichesImportees.length+" fiches importees â€” "+totalErrors+" erreurs detectees"}/><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:18}}>{[{l:"Fiches importees",v:fichesImportees.length,c:"#c6a34e"},{l:"Erreurs detectees",v:totalErrors,c:totalErrors>0?"#ef4444":"#22c55e"},{l:"Masse brute import",v:f2(fichesImportees.reduce((a,f)=>a+f.brut,0)),c:"#60a5fa"},{l:"Concurrent",v:"Concurrent",c:"#a78bfa"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><div style={{display:"flex",gap:4,marginBottom:16}}>{[{k:"import",l:"Importer"},{k:"comparaison",l:"Comparaison"},{k:"rapport",l:"Rapport commercial"}].map(t=><button key={t.k} onClick={()=>setTab(t.k)} style={{padding:"8px 14px",borderRadius:8,border:"none",cursor:"pointer",fontSize:11,fontWeight:tab===t.k?600:400,fontFamily:"inherit",background:tab===t.k?"rgba(198,163,78,.15)":"rgba(255,255,255,.03)",color:tab===t.k?"#c6a34e":"#9e9b93"}}>{t.l}</button>)}</div>{tab==="import"&&<div><C><ST>Importer les fiches du concurrent</ST><div style={{textAlign:"center",padding:30,border:"2px dashed rgba(198,163,78,.2)",borderRadius:10,cursor:"pointer"}} onClick={handleFile}><div style={{fontSize:40,marginBottom:10}}>{"\ðŸ“‚"}</div><div style={{fontSize:14,fontWeight:600,color:"#c6a34e"}}>Cliquer pour importer des fiches CSV/TXT</div><div style={{fontSize:11,color:"#5e5c56",marginTop:6}}>Accepte: exports de tout secretariat social</div><div style={{fontSize:10,color:"#9e9b93",marginTop:4}}>Aureus recalcule automatiquement et detecte les ecarts</div></div></C>{fichesImportees.length>0&&<C><ST>Fiches importees ({fichesImportees.length})</ST>{fichesImportees.map((f,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div><div style={{fontSize:12,fontWeight:600,color:"#e8e6e0"}}>{f.data.nom||f.file}</div><div style={{fontSize:10,color:"#5e5c56"}}>Brut: {f2(f.brut)} | ONSS: {f2(f.data.onss||0)} | PP: {f2(f.data.pp||0)} | Net: {f2(f.data.net||0)}</div></div><span style={{fontSize:10,padding:"3px 10px",borderRadius:10,background:f.errors.length>0?"rgba(239,68,68,.1)":"rgba(34,197,94,.1)",color:f.errors.length>0?"#ef4444":"#22c55e"}}>{f.errors.length>0?f.errors.length+" erreur(s)":"OK"}</span></div>)}</C>}</div>}{tab==="comparaison"&&<C><ST>Ecarts detectes â€” Aureus vs Concurrent</ST>{comparaison.length===0?<div style={{textAlign:"center",padding:30,color:"#5e5c56"}}>Importez des fiches pour voir les ecarts</div>:<table style={{width:"100%",borderCollapse:"collapse",fontSize:11}}><thead><tr>{["Travailleur","Type","Valeur concurrent","Valeur Aureus","Ecart","Verdict"].map(h=><th key={h} style={{padding:"8px",textAlign:"left",color:"#c6a34e",borderBottom:"2px solid rgba(198,163,78,.2)",fontSize:10}}>{h}</th>)}</tr></thead><tbody>{comparaison.map((c2,i)=><tr key={i} style={{borderBottom:"1px solid rgba(255,255,255,.03)"}}><td style={{padding:"6px"}}>{c2.emp}</td><td style={{padding:"6px",color:"#fb923c"}}>{c2.type}</td><td style={{padding:"6px"}}>{f2(c2.old)}</td><td style={{padding:"6px",color:"#22c55e"}}>{f2(c2.new)}</td><td style={{padding:"6px",fontWeight:700,color:"#ef4444"}}>{c2.diff>0?"+":""}{f2(c2.diff)}</td><td style={{padding:"6px",fontSize:10,color:"#ef4444"}}>{c2.type==="RMMMG"?"Sous RMMMG!":"Erreur calcul"}</td></tr>)}</tbody></table>}</C>}{tab==="rapport"&&<C><ST>Rapport commercial pour le prospect</ST><div style={{textAlign:"center",padding:20}}><button onClick={()=>{let txt="RAPPORT D'AUDIT â€” FICHES DE PAIE CONCURRENT\nAureus Social Pro â€” Aureus IA SPRL (BE 1028.230.781)\n"+"=".repeat(50)+"\n\n";txt+="Fiches analysees: "+fichesImportees.length+"\n";txt+="Erreurs detectees: "+totalErrors+"\n\n";txt+="DETAIL DES ERREURS\n"+"-".repeat(40)+"\n";comparaison.forEach((c2,i)=>{txt+=(i+1)+". "+c2.emp+" â€” "+c2.type+"\n";txt+="   Concurrent: "+f2(c2.old)+" | Aureus: "+f2(c2.new)+" | Ecart: "+f2(c2.diff)+"\n\n"});txt+="\nCONCLUSION\n"+"-".repeat(40)+"\n";txt+="Votre secretariat social actuel commet "+totalErrors+" erreurs\n";txt+="sur "+fichesImportees.length+" fiches analysees.\n\n";txt+="Avec Aureus Social Pro: 0 erreur, detection automatique,\ntarif competitif de 9,50 EUR/fiche.\n";const b=new Blob([txt],{type:"text/plain"});const u=URL.createObjectURL(b);const a=document.createElement("a");a.href=u;a.download="rapport_audit_concurrent_"+new Date().toISOString().slice(0,10)+".txt";a.click()}} style={{padding:"14px 40px",borderRadius:8,border:"none",background:"linear-gradient(135deg,#c6a34e,#a68a3c)",color:"#0c0b09",fontWeight:700,fontSize:14,cursor:"pointer",fontFamily:"inherit"}}>{"\ðŸ“¥"} Telecharger rapport commercial</button></div></C>}</div>;}

export function ComingSoon({s,d,title}){return <div style={{padding:40,textAlign:"center"}}><PH title={title||"Module en preparation"} sub="Ce module sera disponible prochainement"/><div style={{padding:40,background:"rgba(198,163,78,.03)",borderRadius:16,border:"1px solid rgba(198,163,78,.08)",marginTop:20}}><div style={{fontSize:48,marginBottom:12}}>ðŸš§</div><div style={{fontSize:16,fontWeight:600,color:"#c6a34e",marginBottom:8}}>Module en cours de developpement</div><div style={{fontSize:12,color:"#9e9b93"}}>Revenez bientot â€” Les fonctionnalites sont en preparation.</div></div></div>;}

export function ActionsRapides({s,d}){const ae=(s.emps||[]).filter(e=>e.status==='active'||!e.status);const n=ae.length;const actions=[{icon:"ðŸ§®",l:"Calculer tous les salaires",d:"Lancer le calcul mensuel pour "+n+" travailleurs",page:"payroll"},{icon:"ðŸ“„",l:"Generer les fiches PDF",d:"Fiches de paie individuelles PDF",page:"payslips"},{icon:"ðŸ¦",l:"Creer fichier SEPA",d:"Virements bancaires pain.001 XML",page:"sepa"},{icon:"ðŸ“Š",l:"Export comptable",d:"Journal de paie CSV/Winbooks",page:"accounting"},{icon:"ðŸ”",l:"Audit conformite",d:"12 verifications legales automatiques",page:"validation"},{icon:"ðŸ“§",l:"Envoyer les fiches par email",d:"Distribution automatique aux travailleurs",page:"envoimasse"},{icon:"\u2795",l:"Ajouter un travailleur",d:"Nouvelle embauche + Dimona IN",page:"employees"},{icon:"ðŸ“…",l:"Calendrier social",d:"Echeances ONSS, PP, DmfA, Belcotax",page:"calendrier"}];return <div><PH title="Actions Rapides" sub="Raccourcis vers les operations les plus frequentes"/><div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10}}>{actions.map((a,i)=><button key={i} onClick={()=>d({type:'SET_PAGE',payload:a.page})} style={{display:"flex",alignItems:"center",gap:12,padding:"14px 16px",borderRadius:10,border:"1px solid rgba(198,163,78,.1)",background:"rgba(198,163,78,.04)",cursor:"pointer",fontFamily:"inherit",textAlign:"left"}}><span style={{fontSize:24}}>{a.icon}</span><div><div style={{fontSize:12,fontWeight:600,color:"#e8e6e0"}}>{a.l}</div><div style={{fontSize:10,color:"#5e5c56"}}>{a.d}</div></div></button>)}</div></div>;}

export function AnalyticsDash({s,d}){const ae=(s.emps||[]).filter(e=>e.status==='active'||!e.status);const n=ae.length;const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const f0=v=>new Intl.NumberFormat('fr-BE',{maximumFractionDigits:0}).format(v);const masseBrut=ae.reduce((a,e)=>a+(e.gross||e.brut||0),0);const avgBrut=n>0?Math.round(masseBrut/n):0;const medBrut=n>0?ae.map(e=>e.gross||e.brut||0).sort((a,b)=>a-b)[Math.floor(n/2)]:0;const statuts={employe:0,ouvrier:0,etudiant:0,autre:0};ae.forEach(e=>{const st=e.statut||"employe";if(statuts[st]!==undefined)statuts[st]++;else statuts.autre++});const tranches=[{min:0,max:2500,label:"< 2.500"},{min:2500,max:3500,label:"2.500-3.500"},{min:3500,max:4500,label:"3.500-4.500"},{min:4500,max:6000,label:"4.500-6.000"},{min:6000,max:999999,label:"> 6.000"}];const trancheData=tranches.map(t=>ae.filter(e=>{const b=e.gross||e.brut||0;return b>=t.min&&b<t.max}).length);const maxTranche=Math.max(...trancheData,1);return <div><PH title="Analytics & Statistiques RH" sub={n+" travailleurs â€” Analyse de la masse salariale"}/><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:18}}>{[{l:"Effectif total",v:n,c:"#c6a34e"},{l:"Masse salariale brute",v:f0(masseBrut)+" EUR",c:"#60a5fa"},{l:"Salaire moyen",v:f0(avgBrut)+" EUR",c:"#22c55e"},{l:"Salaire median",v:f0(medBrut)+" EUR",c:"#a78bfa"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><C><ST>Distribution des salaires</ST><div style={{display:"flex",alignItems:"flex-end",gap:8,height:120,marginBottom:8}}>{trancheData.map((count,i)=><div key={i} style={{flex:1,display:"flex",flexDirection:"column",alignItems:"center"}}><div style={{fontSize:10,fontWeight:600,color:"#c6a34e",marginBottom:2}}>{count}</div><div style={{width:"100%",height:Math.round(count/maxTranche*100),borderRadius:"4px 4px 0 0",background:"linear-gradient(180deg,#c6a34e,rgba(198,163,78,.3))"}}></div><div style={{fontSize:9,color:"#5e5c56",marginTop:4,textAlign:"center"}}>{tranches[i].label}</div></div>)}</div></C><C><ST>Repartition par statut</ST><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:8}}>{[{l:"Employes",v:statuts.employe,c:"#60a5fa"},{l:"Ouvriers",v:statuts.ouvrier,c:"#fb923c"},{l:"Etudiants",v:statuts.etudiant,c:"#22c55e"},{l:"Autres",v:statuts.autre,c:"#5e5c56"}].map((st,i)=><div key={i} style={{padding:12,background:"rgba(198,163,78,.04)",borderRadius:8,textAlign:"center"}}><div style={{fontSize:20,fontWeight:800,color:st.c}}>{st.v}</div><div style={{fontSize:10,color:"#9e9b93"}}>{st.l}</div><div style={{width:"100%",height:4,borderRadius:2,background:"rgba(255,255,255,.05)",marginTop:6}}><div style={{width:n>0?(st.v/n*100)+"%":"0%",height:"100%",borderRadius:2,background:st.c}}></div></div></div>)}</div></C><C><ST>Indicateurs cles</ST>{[{l:"Cout total employeur/mois",v:f0(Math.round(masseBrut*1.35))+" EUR"},{l:"Cout annuel (avec primes)",v:f0(Math.round(masseBrut*1.35*12+masseBrut*2))+" EUR"},{l:"Ratio ONSS patronal",v:"25,07% = "+f0(Math.round(masseBrut*0.2507))+" EUR/mois"},{l:"Ecart salaire min/max",v:n>0?f0(Math.min(...ae.map(e=>e.gross||e.brut||0)))+" - "+f0(Math.max(...ae.map(e=>e.gross||e.brut||0)))+" EUR":"N/A"}].map((ind,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><span style={{fontSize:12,color:"#9e9b93"}}>{ind.l}</span><span style={{fontSize:12,fontWeight:600,color:"#e8e6e0"}}>{ind.v}</span></div>)}</C></div>;}

export function ArchivesNumeriques({s,d}){const years=["2026","2025","2024"];const [selYear,setSelYear]=useState("2026");const mois=["Janvier","Fevrier","Mars","Avril","Mai","Juin","Juillet","Aout","Septembre","Octobre","Novembre","Decembre"];return <div><PH title="Archives Numeriques" sub="Classement automatique de tous les documents par mois et annee"/><div style={{display:"flex",gap:6,marginBottom:16}}>{years.map(y=><button key={y} onClick={()=>setSelYear(y)} style={{padding:"8px 16px",borderRadius:8,border:"none",cursor:"pointer",fontSize:12,fontWeight:selYear===y?600:400,fontFamily:"inherit",background:selYear===y?"rgba(198,163,78,.15)":"rgba(255,255,255,.03)",color:selYear===y?"#c6a34e":"#9e9b93"}}>{y}</button>)}</div><C><ST>Archives {selYear}</ST><div style={{display:"grid",gridTemplateColumns:"repeat(3,1fr)",gap:8}}>{mois.map((m,i)=><div key={i} style={{padding:14,background:"rgba(198,163,78,.04)",borderRadius:8,border:"1px solid rgba(198,163,78,.06)",cursor:"pointer"}}><div style={{fontSize:12,fontWeight:600,color:"#e8e6e0"}}>{m}</div><div style={{fontSize:10,color:"#5e5c56",marginTop:4}}>{["Fiches paie","SEPA","DmfA","Export"].slice(0,2+Math.floor(Math.random()*2)).join(" Â· ")}</div></div>)}</div></C></div>;}

export function AuditTrail({s,d}){const [logs]=useState([{t:"2026-02-21 01:30",user:"Admin",action:"Calcul salaires Fevrier",mod:"Paie",ip:"192.168.1.10"},{t:"2026-02-21 01:28",user:"Admin",action:"Ajout travailleur: Dupont Jean",mod:"Employes",ip:"192.168.1.10"},{t:"2026-02-20 18:00",user:"Gestionnaire 1",action:"Generation fiches PDF",mod:"Documents",ip:"192.168.1.15"},{t:"2026-02-20 17:45",user:"Admin",action:"Modification salaire: Martin Paul",mod:"Employes",ip:"192.168.1.10"},{t:"2026-02-20 16:30",user:"Admin",action:"Export DmfA Q4",mod:"ONSS",ip:"192.168.1.10"}]);return <div><PH title="Audit Trail" sub="Journal d'activite â€” Qui a fait quoi, quand, depuis ou"/><C><ST>Derniers evenements</ST><table style={{width:"100%",borderCollapse:"collapse",fontSize:11}}><thead><tr>{["Date","Utilisateur","Action","Module","IP"].map(h=><th key={h} style={{padding:"8px",textAlign:"left",color:"#c6a34e",borderBottom:"2px solid rgba(198,163,78,.2)",fontSize:10}}>{h}</th>)}</tr></thead><tbody>{logs.map((l,i)=><tr key={i} style={{borderBottom:"1px solid rgba(255,255,255,.03)"}}><td style={{padding:"6px",color:"#5e5c56",fontSize:10}}>{l.t}</td><td style={{padding:"6px",fontWeight:600}}>{l.user}</td><td style={{padding:"6px"}}>{l.action}</td><td style={{padding:"6px"}}><span style={{padding:"2px 8px",borderRadius:10,background:"rgba(198,163,78,.08)",color:"#c6a34e",fontSize:9}}>{l.mod}</span></td><td style={{padding:"6px",color:"#5e5c56",fontSize:10}}>{l.ip}</td></tr>)}</tbody></table></C></div>;}

export function AuthMultiRoles({s,d}){const [tab,setTab]=useState("roles");const [roles,setRoles]=useState([{id:"admin",name:"Administrateur",desc:"Acces total",color:"#c6a34e",perms:{dashboard:true,paie:true,onss:true,dimona:true,contrats:true,docs:true,export:true,config:true,clients:true,portail:true,audit:true}},{id:"gestionnaire",name:"Gestionnaire",desc:"Clients assignes",color:"#60a5fa",perms:{dashboard:true,paie:true,onss:true,dimona:true,contrats:true,docs:true,export:true,config:false,clients:false,portail:false,audit:false}},{id:"client",name:"Client",desc:"Ses fiches et documents",color:"#a78bfa",perms:{dashboard:true,paie:false,onss:false,dimona:false,contrats:false,docs:true,export:false,config:false,clients:false,portail:true,audit:false}},{id:"employe",name:"Employe",desc:"Sa fiche de paie et conges",color:"#22c55e",perms:{dashboard:false,paie:false,onss:false,dimona:false,contrats:false,docs:false,export:false,config:false,clients:false,portail:true,audit:false}},{id:"comptable",name:"Comptable externe",desc:"Exports comptables uniquement",color:"#fb923c",perms:{dashboard:false,paie:false,onss:false,dimona:false,contrats:false,docs:false,export:true,config:false,clients:false,portail:false,audit:false}}]);const modules=[{k:"dashboard",l:"Dashboard"},{k:"paie",l:"Salaires & Calculs"},{k:"onss",l:"Declarations ONSS"},{k:"dimona",l:"Dimona IN/OUT"},{k:"contrats",l:"Contrats"},{k:"docs",l:"Documents juridiques"},{k:"export",l:"Export comptable"},{k:"config",l:"Configuration"},{k:"clients",l:"Gestion clients"},{k:"portail",l:"Portail client/employe"},{k:"audit",l:"Audit & Logs"}];const [users]=useState([{name:"Moussati Admin",email:"admin@aureussocial.be",role:"admin"},{name:"Gestionnaire 1",email:"gest1@aureussocial.be",role:"gestionnaire"}]);const togglePerm=(rid,mk)=>{setRoles(prev=>prev.map(r=>r.id===rid?{...r,perms:{...r.perms,[mk]:!r.perms[mk]}}:r))};return <div><PH title="Roles & Permissions" sub="Gestion des acces â€” Matrice de permissions par module"/><div style={{display:"grid",gridTemplateColumns:"repeat(5,1fr)",gap:12,marginBottom:18}}>{roles.map(r=><div key={r.id} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)",textAlign:"center"}}><div style={{fontSize:20,marginBottom:4}}>{r.id==="admin"?"ðŸ‘‘":r.id==="gestionnaire"?"ðŸ‘¥":r.id==="client"?"ðŸ¢":r.id==="employe"?"ðŸ‘¤":"ðŸ“Š"}</div><div style={{fontSize:13,fontWeight:700,color:r.color}}>{r.name}</div><div style={{fontSize:10,color:"#5e5c56"}}>{r.desc}</div></div>)}</div><div style={{display:"flex",gap:6,marginBottom:16}}>{[{v:"roles",l:"Matrice permissions"},{v:"users",l:"Utilisateurs"},{v:"invite",l:"Invitations"}].map(t=><button key={t.v} onClick={()=>setTab(t.v)} style={{padding:"8px 16px",borderRadius:8,border:"none",cursor:"pointer",fontSize:12,fontWeight:tab===t.v?600:400,fontFamily:"inherit",background:tab===t.v?"rgba(198,163,78,.15)":"rgba(255,255,255,.03)",color:tab===t.v?"#c6a34e":"#9e9b93"}}>{t.l}</button>)}</div>{tab==="roles"&&<C><ST>Matrice de permissions</ST><div style={{overflowX:"auto"}}><table style={{width:"100%",borderCollapse:"collapse",fontSize:11}}><thead><tr><th style={{padding:"8px",textAlign:"left",color:"#c6a34e",borderBottom:"2px solid rgba(198,163,78,.2)",fontSize:10}}>Module</th>{roles.map(r=><th key={r.id} style={{padding:"8px",textAlign:"center",color:r.color,borderBottom:"2px solid rgba(198,163,78,.2)",fontSize:10}}>{r.name}</th>)}</tr></thead><tbody>{modules.map(m=><tr key={m.k} style={{borderBottom:"1px solid rgba(255,255,255,.03)"}}><td style={{padding:"8px",color:"#e8e6e0",fontWeight:500}}>{m.l}</td>{roles.map(r=><td key={r.id} style={{padding:"8px",textAlign:"center"}}><button onClick={()=>togglePerm(r.id,m.k)} style={{width:28,height:28,borderRadius:6,border:"none",cursor:"pointer",fontSize:14,background:r.perms[m.k]?"rgba(34,197,94,.15)":"rgba(239,68,68,.08)",color:r.perms[m.k]?"#22c55e":"#ef4444"}}>{r.perms[m.k]?"\u2713":"\u2717"}</button></td>)}</tr>)}</tbody></table></div></C>}{tab==="users"&&<C><ST>Utilisateurs actifs</ST>{users.map((u,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div><div style={{fontSize:13,fontWeight:600,color:"#e8e6e0"}}>{u.name}</div><div style={{fontSize:11,color:"#5e5c56"}}>{u.email}</div></div><span style={{fontSize:11,padding:"4px 12px",borderRadius:20,background:roles.find(r=>r.id===u.role)?"rgba(198,163,78,.1)":"transparent",color:roles.find(r=>r.id===u.role)?.color||"#888",fontWeight:600}}>{roles.find(r=>r.id===u.role)?.name||u.role}</span></div>)}<div style={{marginTop:16,padding:16,background:"rgba(198,163,78,.04)",borderRadius:8,textAlign:"center"}}><div style={{fontSize:12,color:"#9e9b93"}}>Ajoutez des utilisateurs via l'onglet Invitations</div></div></C>}{tab==="invite"&&<C><ST>Inviter un utilisateur</ST><div style={{display:"flex",flexDirection:"column",gap:12,maxWidth:400}}><div><label style={{fontSize:10,color:"#888",display:"block",marginBottom:4}}>Email</label><input type="email" placeholder="email@client.be" style={{width:"100%",padding:"10px 14px",borderRadius:8,border:"1px solid rgba(198,163,78,.2)",background:"rgba(0,0,0,.2)",color:"#e8e6e0",fontSize:13,fontFamily:"inherit"}}/></div><div><label style={{fontSize:10,color:"#888",display:"block",marginBottom:4}}>Role</label><select style={{width:"100%",padding:"10px 14px",borderRadius:8,border:"1px solid rgba(198,163,78,.2)",background:"rgba(0,0,0,.2)",color:"#e8e6e0",fontSize:13,fontFamily:"inherit"}}>{roles.map(r=><option key={r.id} value={r.id}>{r.name} â€” {r.desc}</option>)}</select></div><button style={{padding:"12px",borderRadius:8,border:"none",background:"linear-gradient(135deg,#c6a34e,#a68a3c)",color:"#0c0b09",fontWeight:700,fontSize:13,cursor:"pointer",fontFamily:"inherit"}}>Envoyer l'invitation</button></div></C>}</div>;}

export function AutoIndexation({s,d}){const ae=(s.emps||[]).filter(e=>e.status==='active'||!e.status);const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const [indice,setIndice]=useState(1.3786);const [applied,setApplied]=useState(false);return <div><PH title="Auto-Indexation" sub="Application automatique de l'indice sante aux salaires baremiques"/><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:18}}>{[{l:"Indice sante actuel",v:indice.toFixed(4),c:"#c6a34e"},{l:"Travailleurs concernes",v:ae.length,c:"#60a5fa"},{l:"Derniere indexation",v:"Jan 2026",c:"#22c55e"},{l:"Prochaine prevue",v:"A surveiller",c:"#fb923c"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><C><ST>Parametres d'indexation</ST><div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:16}}><div><label style={{fontSize:10,color:"#888",display:"block",marginBottom:4}}>Coefficient d'indexation</label><input type="number" step="0.0001" value={indice} onChange={e=>setIndice(parseFloat(e.target.value)||1)} style={{width:"100%",padding:"10px",borderRadius:8,border:"1px solid rgba(198,163,78,.2)",background:"rgba(0,0,0,.2)",color:"#e8e6e0",fontSize:14,fontFamily:"inherit"}}/></div><div><label style={{fontSize:10,color:"#888",display:"block",marginBottom:4}}>Base legale</label><div style={{padding:"10px",fontSize:12,color:"#9e9b93"}}>Loi du 2/08/1971 â€” Indexation automatique des salaires et traitements</div></div></div></C><C><ST>Simulation impact indexation</ST>{ae.length===0?<div style={{textAlign:"center",padding:20,color:"#5e5c56"}}>Aucun travailleur</div>:<div><table style={{width:"100%",borderCollapse:"collapse",fontSize:11}}><thead><tr>{["Travailleur","Brut actuel","Brut indexe","Difference"].map(h=><th key={h} style={{padding:"8px",textAlign:"left",color:"#c6a34e",borderBottom:"2px solid rgba(198,163,78,.2)",fontSize:10}}>{h}</th>)}</tr></thead><tbody>{ae.slice(0,15).map((e,i)=>{const brut=e.gross||e.brut||0;const indexed=Math.round(brut*indice*100)/100;return <tr key={i} style={{borderBottom:"1px solid rgba(255,255,255,.03)"}}><td style={{padding:"6px"}}>{(e.first||e.fn||"")+" "+(e.last||e.ln||"")}</td><td style={{padding:"6px"}}>{f2(brut)}</td><td style={{padding:"6px",color:"#22c55e"}}>{f2(indexed)}</td><td style={{padding:"6px",color:"#c6a34e"}}>{f2(indexed-brut)}</td></tr>})}</tbody></table><div style={{marginTop:16,textAlign:"center"}}><button onClick={()=>setApplied(true)} style={{padding:"12px 32px",borderRadius:8,border:"none",background:applied?"rgba(34,197,94,.15)":"linear-gradient(135deg,#c6a34e,#a68a3c)",color:applied?"#22c55e":"#0c0b09",fontWeight:700,fontSize:13,cursor:"pointer",fontFamily:"inherit"}}>{applied?"\u2713 Indexation appliquee":"Appliquer l'indexation"}</button></div></div>}</C></div>;}

export function AutomationHub({s,d}){const automations=[{n:"Pilote Automatique",desc:"ON/OFF calcul total 1-clic",page:"pilote",status:"actif"},{n:"Cloture Mensuelle",desc:"6 etapes automatisees",page:"cloture",status:"actif"},{n:"Regles Si/Alors",desc:"8 regles metier intelligentes",page:"smartauto",status:"actif"},{n:"Autopilot IA",desc:"Detection anomalies + corrections",page:"autopilot",status:"actif"},{n:"Auto-Indexation",desc:"Application indice sante",page:"indexation",status:"config"},{n:"Alertes Intelligentes",desc:"RMMMG, NISS, echeances",page:"alerts",status:"actif"},{n:"Envoi Masse",desc:"Fiches par email automatique",page:"envoimasse",status:"actif"},{n:"Archivage Auto",desc:"Classement par mois/annee",page:"archives",status:"actif"}];return <div><PH title="Hub Automatisations" sub={"Centre de controle â€” "+automations.filter(a=>a.status==="actif").length+"/"+automations.length+" actifs"}/><div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10}}>{automations.map((a,i)=><div key={i} onClick={()=>d({type:'SET_PAGE',payload:a.page})} style={{padding:"14px 16px",borderRadius:10,border:"1px solid rgba(198,163,78,.1)",background:"rgba(198,163,78,.04)",cursor:"pointer"}}><div style={{display:"flex",justifyContent:"space-between",marginBottom:4}}><span style={{fontSize:13,fontWeight:600,color:"#e8e6e0"}}>{a.n}</span><span style={{fontSize:10,padding:"2px 8px",borderRadius:10,background:a.status==="actif"?"rgba(34,197,94,.1)":"rgba(251,146,56,.1)",color:a.status==="actif"?"#22c55e":"#fb923c"}}>{a.status}</span></div><div style={{fontSize:10,color:"#5e5c56"}}>{a.desc}</div></div>)}</div></div>;}

export function BudgetPrev({s,d}){const ae=(s.emps||[]).filter(e=>e.status==='active'||!e.status);const n=ae.length;const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const f0=v=>new Intl.NumberFormat('fr-BE',{maximumFractionDigits:0}).format(v);const masseBrut=ae.reduce((a,e)=>a+(e.gross||e.brut||0),0);const coutMensuel=Math.round(masseBrut*1.35*100)/100;const mois=["Jan","Fev","Mar","Avr","Mai","Jun","Jul","Aou","Sep","Oct","Nov","Dec"];const [indexation,setIndexation]=useState(2);const projections=mois.map((_,i)=>{const coef=1+(indexation/100)*(i/12);const brut=Math.round(masseBrut*coef);const onssP=Math.round(brut*0.2507);const cout=brut+onssP;const pecule=i===4?Math.round(masseBrut*0.9234):0;const treizieme=i===11?masseBrut:0;const total=cout+pecule+treizieme;return{brut,onssP,cout,pecule,treizieme,total}});const totalAnnuel=projections.reduce((a,p)=>a+p.total,0);const maxCout=Math.max(...projections.map(p=>p.total));return <div><PH title="Budget Previsionnel" sub={"Projection 12 mois â€” "+n+" ETP â€” Indexation "+indexation+"%"}/><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:18}}>{[{l:"Cout mensuel actuel",v:f2(coutMensuel),c:"#c6a34e"},{l:"Budget annuel",v:f0(totalAnnuel)+" EUR",c:"#ef4444"},{l:"Cout moyen/mois",v:f0(totalAnnuel/12)+" EUR",c:"#a78bfa"},{l:"Cout moyen/ETP/an",v:n>0?f0(totalAnnuel/n)+" EUR":"0",c:"#60a5fa"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><C><ST>Hypothese d'indexation annuelle</ST><input type="range" min={0} max={5} step={0.5} value={indexation} onChange={e=>setIndexation(+e.target.value)} style={{width:"100%",accentColor:"#c6a34e"}}/><div style={{textAlign:"center",fontSize:12,color:"#c6a34e"}}>{indexation}% d'indexation prevue en 2026</div></C><C><ST>Graphique â€” Cout mensuel 2026</ST><div style={{display:"flex",alignItems:"flex-end",gap:4,height:160,padding:"10px 0"}}>{projections.map((p,i)=>{const h=maxCout>0?Math.round(p.total/maxCout*140):0;const hasPrime=p.pecule>0||p.treizieme>0;return <div key={i} style={{flex:1,display:"flex",flexDirection:"column",alignItems:"center"}}><div style={{fontSize:8,color:hasPrime?"#fb923c":"#5e5c56",marginBottom:2}}>{f0(p.total)}</div><div style={{width:"100%",height:h,borderRadius:"4px 4px 0 0",background:hasPrime?"linear-gradient(180deg,#fb923c,#c6a34e)":"linear-gradient(180deg,#c6a34e,rgba(198,163,78,.4))"}}></div><div style={{fontSize:9,color:"#5e5c56",marginTop:4}}>{mois[i]}</div></div>})}</div><div style={{display:"flex",gap:12,justifyContent:"center",fontSize:10,color:"#5e5c56",marginTop:8}}><span><span style={{display:"inline-block",width:8,height:8,borderRadius:2,background:"#c6a34e",marginRight:4,verticalAlign:"middle"}}/>Masse salariale</span><span><span style={{display:"inline-block",width:8,height:8,borderRadius:2,background:"#fb923c",marginRight:4,verticalAlign:"middle"}}/>Avec primes (pecule/13e)</span></div></C><C><ST>Detail mensuel</ST><table style={{width:"100%",borderCollapse:"collapse",fontSize:10}}><thead><tr>{["Mois","Brut","ONSS P.","Cout base","Pecule/13e","TOTAL"].map(h=><th key={h} style={{padding:"6px",textAlign:"left",color:"#c6a34e",borderBottom:"2px solid rgba(198,163,78,.2)",fontSize:9}}>{h}</th>)}</tr></thead><tbody>{projections.map((p,i)=><tr key={i} style={{borderBottom:"1px solid rgba(255,255,255,.03)",background:p.pecule>0||p.treizieme>0?"rgba(251,146,56,.03)":"transparent"}}><td style={{padding:"5px 6px",fontWeight:600}}>{mois[i]} 2026</td><td style={{padding:"5px 6px"}}>{f0(p.brut)}</td><td style={{padding:"5px 6px"}}>{f0(p.onssP)}</td><td style={{padding:"5px 6px"}}>{f0(p.cout)}</td><td style={{padding:"5px 6px",color:"#fb923c",fontWeight:p.pecule>0||p.treizieme>0?600:400}}>{p.pecule>0?f0(p.pecule)+" (PV)":p.treizieme>0?f0(p.treizieme)+" (13e)":"-"}</td><td style={{padding:"5px 6px",fontWeight:700,color:"#c6a34e"}}>{f0(p.total)}</td></tr>)}<tr style={{borderTop:"2px solid rgba(198,163,78,.3)"}}><td style={{padding:"6px",fontWeight:700,color:"#c6a34e"}}>TOTAL 2026</td><td colSpan={4}></td><td style={{padding:"6px",fontWeight:800,color:"#c6a34e",fontSize:13}}>{f0(totalAnnuel)} EUR</td></tr></tbody></table></C></div>;}

export function CalendrierSocial({s,d}){const events=[{d:"5 du mois",l:"ONSS â€” Paiement cotisations",cat:"ONSS",recur:"Mensuel"},{d:"15 du mois",l:"Precompte professionnel",cat:"Fiscal",recur:"Mensuel"},{d:"25 du mois",l:"Virements salaires (SEPA)",cat:"Paie",recur:"Mensuel"},{d:"Fin trimestre",l:"DmfA â€” Declaration ONSS",cat:"ONSS",recur:"Trimestriel"},{d:"28 fevrier",l:"Belcotax â€” Fiches 281.10",cat:"Fiscal",recur:"Annuel"},{d:"31 mars",l:"Bilan social BNB",cat:"Legal",recur:"Annuel"},{d:"1er mai",l:"Jour ferie â€” Fete du travail",cat:"Conge",recur:"Annuel"},{d:"1er juin",l:"Pecule vacances simple",cat:"Paie",recur:"Annuel"},{d:"Decembre",l:"13e mois / Prime fin d'annee",cat:"Paie",recur:"Annuel"}];const cats={ONSS:"#ef4444",Fiscal:"#fb923c",Paie:"#22c55e",Legal:"#60a5fa",Conge:"#a78bfa"};return <div><PH title="Calendrier Social" sub="Toutes les echeances legales belges â€” Ne manquez rien"/><C><ST>Echeances par categorie</ST>{events.map((ev,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div style={{display:"flex",gap:12,alignItems:"center"}}><span style={{width:8,height:8,borderRadius:"50%",background:cats[ev.cat]||"#888"}}></span><div><div style={{fontSize:12,fontWeight:600,color:"#e8e6e0"}}>{ev.l}</div><div style={{fontSize:10,color:"#5e5c56"}}>{ev.d} â€” {ev.recur}</div></div></div><span style={{fontSize:10,padding:"3px 10px",borderRadius:10,background:"rgba("+(ev.cat==="ONSS"?"239,68,68":ev.cat==="Fiscal"?"251,146,56":ev.cat==="Paie"?"34,197,94":"96,165,250")+",.1)",color:cats[ev.cat]}}>{ev.cat}</span></div>)}</C></div>;}

export function ChecklistClient({s,d}){const ae=(s.emps||[]).filter(e=>e.status==='active'||!e.status);const [tab,setTab]=useState("checklist");const [items,setItems]=useState([{cat:"A",catName:"Signaletique",docs:[{l:"Fiche signaletique complete (nom, prenom, adresse, NISS)",done:false,obligatoire:true},{l:"Copie carte identite / titre de sejour",done:false,obligatoire:true},{l:"Composition de menage",done:false,obligatoire:false},{l:"N\u00b0 compte bancaire (IBAN BE)",done:false,obligatoire:true},{l:"Photo identite",done:false,obligatoire:false}]},{cat:"B",catName:"Salariales",docs:[{l:"3 dernieres fiches de paie",done:false,obligatoire:true},{l:"Attestation salaire actuel",done:false,obligatoire:true},{l:"Historique anciennete (dates debut/fin)",done:false,obligatoire:true},{l:"Attestation vacances (dernier employeur)",done:false,obligatoire:true},{l:"Fiche fiscale 281.10 derniere annee",done:false,obligatoire:false}]},{cat:"C",catName:"Contrats & Documents",docs:[{l:"Contrat de travail signe",done:false,obligatoire:true},{l:"Avenants au contrat",done:false,obligatoire:false},{l:"Reglement de travail signe",done:false,obligatoire:true},{l:"Clause de non-concurrence",done:false,obligatoire:false},{l:"Convention voiture de societe",done:false,obligatoire:false},{l:"Convention teletravail",done:false,obligatoire:false}]},{cat:"D",catName:"ONSS & Fiscales",docs:[{l:"N\u00b0 ONSS employeur",done:false,obligatoire:true},{l:"Attestation ONSS en ordre",done:false,obligatoire:true},{l:"N\u00b0 BCE entreprise",done:false,obligatoire:true},{l:"Taux accident du travail (AT)",done:false,obligatoire:true},{l:"Code NACE activite",done:false,obligatoire:true},{l:"Commission paritaire applicable",done:false,obligatoire:true},{l:"Certificat PME (si applicable)",done:false,obligatoire:false}]},{cat:"E",catName:"Soldes & Compteurs",docs:[{l:"Solde conges legaux restants",done:false,obligatoire:true},{l:"Solde jours maladie (garanti utilise)",done:false,obligatoire:false},{l:"Credit-temps en cours",done:false,obligatoire:false},{l:"Saisies sur salaire en cours",done:false,obligatoire:false},{l:"Prime fin d'annee (prorata)",done:false,obligatoire:false},{l:"Pecule vacances (simple + double)",done:false,obligatoire:true}]}]);const toggle=(catIdx,docIdx)=>{const n=[...items];n[catIdx]={...n[catIdx],docs:[...n[catIdx].docs]};n[catIdx].docs[docIdx]={...n[catIdx].docs[docIdx],done:!n[catIdx].docs[docIdx].done};setItems(n)};const totalDocs=items.reduce((a,cat)=>a+cat.docs.length,0);const doneDocs=items.reduce((a,cat)=>a+cat.docs.filter(d2=>d2.done).length,0);const obligatoires=items.reduce((a,cat)=>a+cat.docs.filter(d2=>d2.obligatoire).length,0);const obligatoiresDone=items.reduce((a,cat)=>a+cat.docs.filter(d2=>d2.obligatoire&&d2.done).length,0);const pct=totalDocs>0?Math.round(doneDocs/totalDocs*100):0;const downloadChecklist=()=>{aureuspdf('Checklist Reprise Client',[{type:'title',text:'CHECKLIST REPRISE CLIENT'},{type:'line'},{type:'kv',k:'Date',v:new Date().toLocaleDateString('fr-BE')},{type:'kv',k:'Progression',v:doneDocs+'/'+totalDocs+' ('+pct+'%)'},{type:'kv',k:'Obligatoires',v:obligatoiresDone+'/'+obligatoires},{type:'space',h:4}].concat(items.flatMap(function(cat){return [{type:'subtitle',text:cat.cat+'. '+cat.catName}].concat(cat.docs.map(function(doc){return {type:'text',text:(doc.done?'[X] ':'[ ] ')+(doc.obligatoire?'* ':'')+doc.l}}),[{type:'space',h:3}])})).concat([{type:'line'},{type:'text',text:'* = document obligatoire',size:8,color:[158,155,147]}]),{filename:'checklist_reprise_'+new Date().toISOString().slice(0,10)})};return <div><PH title="Checklist Reprise Client" sub={"5 categories, "+totalDocs+" documents â€” Progression: "+pct+"%"}/><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:18}}>{[{l:"Documents total",v:totalDocs,c:"#c6a34e"},{l:"Completes",v:doneDocs,c:"#22c55e"},{l:"Obligatoires OK",v:obligatoiresDone+"/"+obligatoires,c:obligatoiresDone===obligatoires?"#22c55e":"#ef4444"},{l:"Progression",v:pct+"%",c:pct>=80?"#22c55e":pct>=50?"#fb923c":"#ef4444"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:22,fontWeight:800,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><div style={{height:6,background:"rgba(255,255,255,.05)",borderRadius:3,marginBottom:16,overflow:"hidden"}}><div style={{height:"100%",width:pct+"%",background:"linear-gradient(90deg,#c6a34e,#22c55e)",borderRadius:3,transition:"width .3s"}}/></div>{items.map((cat,ci)=>{const catDone=cat.docs.filter(d2=>d2.done).length;const catTotal=cat.docs.length;return <C key={ci}><div style={{display:"flex",justifyContent:"space-between",alignItems:"center"}}><ST>{cat.cat}. {cat.catName}</ST><span style={{fontSize:11,padding:"3px 10px",borderRadius:10,background:catDone===catTotal?"rgba(34,197,94,.1)":"rgba(251,146,56,.1)",color:catDone===catTotal?"#22c55e":"#fb923c"}}>{catDone}/{catTotal}</span></div>{cat.docs.map((doc,di)=><div key={di} onClick={()=>toggle(ci,di)} style={{display:"flex",alignItems:"center",gap:10,padding:"8px 0",borderBottom:"1px solid rgba(255,255,255,.03)",cursor:"pointer"}}><div style={{width:20,height:20,borderRadius:4,border:"2px solid "+(doc.done?"#22c55e":"rgba(198,163,78,.3)"),background:doc.done?"rgba(34,197,94,.15)":"transparent",display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,color:"#22c55e",flexShrink:0}}>{doc.done?"\u2713":""}</div><span style={{fontSize:12,color:doc.done?"#22c55e":"#e8e6e0",textDecoration:doc.done?"line-through":"none",flex:1}}>{doc.l}</span>{doc.obligatoire&&<span style={{fontSize:8,padding:"2px 6px",borderRadius:4,background:"rgba(239,68,68,.1)",color:"#ef4444"}}>Obligatoire</span>}</div>)}</C>})}<div style={{textAlign:"center",marginTop:16}}><button onClick={downloadChecklist} style={{padding:"12px 32px",borderRadius:8,border:"none",background:"linear-gradient(135deg,#c6a34e,#a68a3c)",color:"#0c0b09",fontWeight:700,fontSize:13,cursor:"pointer",fontFamily:"inherit"}}>Telecharger la checklist</button></div></div>;}

export function CommandCenter({s,d}){const ae=(s.emps||[]).filter(e=>e.status==='active'||!e.status);const n=ae.length;const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const masse=ae.reduce((a,e)=>a+(e.gross||e.brut||0),0);const now=new Date();const day=now.getDate();const deadlines=[{l:"ONSS â€” Paiement cotisations",d:5,urgent:day>=1&&day<=5},{l:"Precompte professionnel",d:15,urgent:day>=10&&day<=15},{l:"Virements salaires SEPA",d:25,urgent:day>=20&&day<=25}];return <div><PH title="Centre de Commande" sub={"Vue temps reel â€” "+n+" travailleurs â€” "+new Date().toLocaleDateString('fr-BE')}/><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:18}}>{[{l:"Travailleurs actifs",v:n,c:"#c6a34e"},{l:"Masse brute",v:f2(masse),c:"#60a5fa"},{l:"Cout total employeur",v:f2(masse*1.35),c:"#ef4444"},{l:"Prochaine echeance",v:deadlines.find(dl=>dl.d>=day)?deadlines.find(dl=>dl.d>=day).l.split("â€”")[0]:"OK",c:"#fb923c"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16}}><C><ST>Actions rapides</ST>{[{l:"Calculer les salaires du mois",icon:"ðŸ§®",act:"calc"},{l:"Generer les fiches PDF",icon:"ðŸ“„",act:"pdf"},{l:"Creer fichier SEPA",icon:"ðŸ¦",act:"sepa"},{l:"Export comptable",icon:"ðŸ“Š",act:"export"},{l:"Lancer l'audit conformite",icon:"ðŸ”",act:"audit"}].map((a,i)=><button key={i} onClick={()=>d({type:'SET_PAGE',payload:a.act==='calc'?'payroll':a.act==='pdf'?'payslips':a.act==='sepa'?'sepa':a.act==='export'?'accounting':'validation'})} style={{display:"flex",alignItems:"center",gap:10,width:"100%",padding:"10px 14px",marginBottom:6,borderRadius:8,border:"1px solid rgba(198,163,78,.1)",background:"rgba(198,163,78,.04)",cursor:"pointer",fontFamily:"inherit",textAlign:"left",color:"#e8e6e0",fontSize:12}}><span style={{fontSize:18}}>{a.icon}</span>{a.l}</button>)}</C><C><ST>Echeances du mois</ST>{deadlines.map((dl,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div><div style={{fontSize:12,fontWeight:600,color:"#e8e6e0"}}>{dl.l}</div><div style={{fontSize:10,color:"#5e5c56"}}>Avant le {dl.d} du mois</div></div><span style={{fontSize:10,padding:"3px 10px",borderRadius:10,background:dl.urgent?"rgba(239,68,68,.1)":day>dl.d?"rgba(34,197,94,.1)":"rgba(255,255,255,.03)",color:dl.urgent?"#ef4444":day>dl.d?"#22c55e":"#5e5c56"}}>{dl.urgent?"URGENT":day>dl.d?"Fait":"A venir"}</span></div>)}</C></div></div>;}

export function ComparatifConcurrents({s,d}){const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const concurrents=[{n:"Grand SS national",prix:"12-18 EUR/fiche",onss:"Inclus",dimona:"Inclus",dmfa:"25 EUR/trim",belcotax:"50 EUR/an",support:"Tel + email",audit:"Non",ia:"Non",note:"Leader marche belge"},{n:"Grand SS international",prix:"15-22 EUR/fiche",onss:"Inclus",dimona:"Inclus",dmfa:"30 EUR/trim",belcotax:"60 EUR/an",support:"Tel + email + portail",audit:"Non",ia:"Non",note:"NÂ°2 belgique"},{n:"SS mutualiste",prix:"14-20 EUR/fiche",onss:"Inclus",dimona:"Inclus",dmfa:"25 EUR/trim",belcotax:"50 EUR/an",support:"Tel + email",audit:"Non",ia:"Non",note:"Mutualite + secrÃ©tariat"},{n:"SS regional",prix:"10-15 EUR/fiche",onss:"Inclus",dimona:"Inclus",dmfa:"20 EUR/trim",belcotax:"40 EUR/an",support:"Tel + email",audit:"Non",ia:"Non",note:"PME wallonnes"},{n:"Aureus Social Pro",prix:"9,50 EUR/fiche",onss:"Inclus",dimona:"5 EUR",dmfa:"25 EUR/trim",belcotax:"50 EUR/an",support:"Chat + email + tel",audit:"OUI â€” 12 checks",ia:"OUI â€” Autopilot",note:"IA + detection erreurs"}];return <div><PH title="Comparatif Concurrents" sub="Benchmark Aureus Social Pro vs marche belge"/><C><ST>Grille tarifaire comparative</ST><div style={{overflowX:"auto"}}><table style={{width:"100%",borderCollapse:"collapse",fontSize:11,minWidth:600}}><thead><tr><th style={{padding:"8px",color:"#c6a34e",textAlign:"left",borderBottom:"2px solid rgba(198,163,78,.2)",fontSize:10}}>Critere</th>{concurrents.map(cc=><th key={cc.n} style={{padding:"8px",textAlign:"center",borderBottom:"2px solid rgba(198,163,78,.2)",fontSize:10,color:cc.n.includes("Aureus")?"#c6a34e":"#9e9b93",background:cc.n.includes("Aureus")?"rgba(198,163,78,.06)":"transparent"}}>{cc.n}</th>)}</tr></thead><tbody>{[{k:"prix",l:"Prix/fiche"},{k:"dimona",l:"Dimona IN/OUT"},{k:"dmfa",l:"DmfA trimestrielle"},{k:"belcotax",l:"Belcotax annuel"},{k:"audit",l:"Audit automatique"},{k:"ia",l:"Intelligence artificielle"},{k:"support",l:"Support"}].map((row,i)=><tr key={i} style={{borderBottom:"1px solid rgba(255,255,255,.03)"}}><td style={{padding:"6px",fontWeight:600,fontSize:10}}>{row.l}</td>{concurrents.map(cc=><td key={cc.n} style={{padding:"6px",textAlign:"center",fontSize:10,background:cc.n.includes("Aureus")?"rgba(198,163,78,.06)":"transparent",color:cc[row.k]==="OUI â€” 12 checks"||cc[row.k]==="OUI â€” Autopilot"?"#22c55e":cc[row.k]==="Non"?"#ef4444":"#e8e6e0",fontWeight:cc.n.includes("Aureus")?600:400}}>{cc[row.k]}</td>)}</tr>)}</tbody></table></div></C><C><ST>Avantages Aureus Social Pro</ST>{[{l:"Prix le plus bas du marche",d:"Tarif competitif vs marche belge",v:"-35%"},{l:"Detection erreurs automatique",d:"12 types de controles en temps reel â€” aucun concurrent ne le fait",v:"Unique"},{l:"IA Autopilot",d:"Detection anomalies + corrections proposees automatiquement",v:"Unique"},{l:"Rapport d'audit commercial",d:"Argument de vente: montrer les erreurs du concurrent au prospect",v:"Unique"},{l:"Onboarding 7 etapes",d:"Import depuis tout prestataire + comparaison automatique",v:"Unique"}].map((av,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div><div style={{fontSize:12,fontWeight:600,color:"#e8e6e0"}}>{av.l}</div><div style={{fontSize:10,color:"#5e5c56"}}>{av.d}</div></div><span style={{fontSize:11,padding:"3px 10px",borderRadius:10,background:"rgba(34,197,94,.1)",color:"#22c55e",fontWeight:600}}>{av.v}</span></div>)}</C></div>;}

export function ContratGenerator({s,d}){const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const [sel,setSel]=useState("cdi");const [form,setForm]=useState({nom:"",prenom:"",niss:"",adresse:"",fonction:"",brut:3000,debut:"",fin:"",regime:100,lieu:""});const u=(k,v)=>setForm({...form,[k]:v});const types=[{id:"cdi",n:"CDI Temps plein",ref:"Art. 2-8 Loi 03/07/1978",desc:"Contrat a duree indeterminee, temps plein 38h/semaine",clauses:["Fonction et description de poste","Remuneration brute mensuelle","Lieu de travail","Regime horaire 38h/semaine","Periode d'essai (supprimee depuis 01/01/2014)","Clause de confidentialite (Art. 17.3\u00b0)","Preavis selon Loi 26/12/2013 (statut unique)","Reglement de travail (Loi 08/04/1965)"]},{id:"cdd",n:"CDD",ref:"Art. 9-10 Loi 03/07/1978",desc:"Contrat a duree determinee â€” date de fin obligatoire",clauses:["Duree precise (date debut et fin)","Motif du recours au CDD","Maximum 4 CDD successifs","Duree totale max 2 ans (sauf exceptions)","Memes droits que CDI pendant la duree"]},{id:"tpartiel",n:"Temps partiel",ref:"Art. 11bis + AR 25/06/1990",desc:"Minimum 1/3 temps plein = 12h40/semaine",clauses:["Duree hebdomadaire (min 1/3 temps plein)","Horaire fixe ou variable","Priorite pour heures complementaires","Droit aux avantages pro rata","Supplement heures complementaires"]},{id:"etudiant",n:"Contrat etudiant",ref:"Titre VII Loi 03/07/1978",desc:"Maximum 600 heures/an avec cotisations reduites",clauses:["Mention obligatoire 'contrat d'occupation etudiant'","Duree determinee obligatoire","Max 600h/an cotisations reduites (2,71%)","Attestation inscription etablissement","Clause d'essai 3 premiers jours"]},{id:"interim",n:"Travail interimaire",ref:"Loi 24/07/1987",desc:"Via agence interim agreee â€” 4 motifs legaux",clauses:["Nom agence interim agreee","Motif: surcroit, remplacement, travail exceptionnel, insertion","Duree mission","Utilisateur = direction, agence = employeur","Convention collective applicable"]},{id:"avenant",n:"Avenant au contrat",ref:"Art. 1134 Code civil",desc:"Modification d'un element essentiel du contrat",clauses:["Reference au contrat initial","Element modifie (fonction, salaire, horaire...)","Date d'effet de la modification","Accord des deux parties","Maintien des autres clauses"]}];const selType=types.find(t=>t.id===sel);const generate=()=>{aureuspdf('Contrat de Travail â€” '+selType.n,[{type:'title',text:'CONTRAT DE TRAVAIL'},{type:'subtitle',text:selType.n.toUpperCase()},{type:'text',text:'Ref: '+selType.ref,size:8,color:[158,155,147]},{type:'line'},{type:'space',h:4},{type:'subtitle',text:'ENTRE:'},{type:'kv',k:'Employeur',v:(s.enterprise?.name||s.co?.name||'[Entreprise]')},{type:'kv',k:'BCE',v:(s.enterprise?.bce||s.co?.vat||'[BCE]')},{type:'space',h:4},{type:'subtitle',text:'ET:'},{type:'kv',k:'Nom',v:form.prenom+' '+form.nom},{type:'kv',k:'NISS',v:form.niss||'[A completer]'},{type:'kv',k:'Domicile',v:form.adresse||'[A completer]'},{type:'space',h:4},{type:'line'},{type:'article',num:'Article 1 â€” Nature',text:'Contrat de type: '+selType.n+'. Base legale: '+selType.ref+'.'},{type:'article',num:'Article 2 â€” Fonction',text:'Fonction: '+(form.fonction||'[Fonction]')+'. Lieu: '+(form.lieu||'[Lieu]')+'.'},{type:'article',num:'Article 3 â€” Duree',text:'Debut: '+(form.debut||'[Date]')+(sel==='cdd'||sel==='etudiant'?'. Fin: '+(form.fin||'[Date]'):'. Duree indeterminee.')+'.'},{type:'article',num:'Article 4 â€” Remuneration',text:'Brut mensuel: '+f2(form.brut)+' EUR. Regime: '+form.regime+'%.'},{type:'article',num:'Article 5 â€” Clauses',text:selType.clauses.join('. ')+'.'},{type:'article',num:'Article 6 â€” Reglement',text:'Le Travailleur a recu le reglement de travail (Loi 08/04/1965).'},{type:'article',num:'Article 7 â€” Obligations',text:'Employeur: Art. 20. Travailleur: Art. 17. Confidentialite: Art. 17.3 Loi 03/07/1978.'},{type:'article',num:'Article 8 â€” Preavis',text:'Loi du 26/12/2013 (statut unique).'},{type:'space',h:8},{type:'signature'}],{filename:'contrat_'+sel+'_'+form.nom,enterprise:s.co?.name||''})};const inp=(label,key,type)=><div><label style={{fontSize:10,color:"#888",display:"block",marginBottom:3}}>{label}</label><input type={type||"text"} value={form[key]} onChange={e=>u(key,type==="number"?+e.target.value:e.target.value)} style={{width:"100%",padding:"8px 10px",borderRadius:8,border:"1px solid rgba(198,163,78,.15)",background:"rgba(0,0,0,.2)",color:"#e8e6e0",fontSize:12,fontFamily:"inherit"}}/></div>;return <div><PH title="Generateur de Contrats" sub={"6 types de contrats â€” Articles de loi belges integres"}/><div style={{display:"flex",gap:6,marginBottom:16}}>{types.map(t=><button key={t.id} onClick={()=>setSel(t.id)} style={{padding:"8px 14px",borderRadius:8,border:"none",cursor:"pointer",fontSize:11,fontWeight:sel===t.id?600:400,fontFamily:"inherit",background:sel===t.id?"rgba(198,163,78,.15)":"rgba(255,255,255,.03)",color:sel===t.id?"#c6a34e":"#9e9b93"}}>{t.n}</button>)}</div><C><ST>{selType.n} â€” {selType.ref}</ST><div style={{fontSize:12,color:"#9e9b93",marginBottom:12}}>{selType.desc}</div><div style={{fontSize:11,fontWeight:600,color:"#c6a34e",marginBottom:8}}>Clauses incluses:</div>{selType.clauses.map((cl,i)=><div key={i} style={{padding:"4px 0",fontSize:11,color:"#e8e6e0"}}>  {i+1}. {cl}</div>)}</C><C><ST>Informations du travailleur</ST><div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10}}>{inp("Nom","nom")}{inp("Prenom","prenom")}{inp("NISS","niss")}{inp("Adresse","adresse")}{inp("Fonction","fonction")}{inp("Lieu de travail","lieu")}{inp("Salaire brut","brut","number")}{inp("Regime horaire %","regime","number")}{inp("Date debut","debut","date")}{(sel==="cdd"||sel==="etudiant")&&inp("Date fin","fin","date")}</div></C><div style={{textAlign:"center",marginTop:16}}><button onClick={generate} style={{padding:"14px 40px",borderRadius:8,border:"none",background:"linear-gradient(135deg,#c6a34e,#a68a3c)",color:"#0c0b09",fontWeight:700,fontSize:14,cursor:"pointer",fontFamily:"inherit"}}>Generer le contrat {selType.n}</button><div style={{fontSize:10,color:"#5e5c56",marginTop:8}}>Avec articles Loi 03/07/1978, Loi 08/04/1965, Loi 26/12/2013</div></div></div>;}

export function ConventionsCollectives({s,d}){const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const [tab,setTab]=useState("baremes");const [selCP,setSelCP]=useState("200");const cps=[{id:"200",n:"CP 200 â€” CPNAE (Employes)",base:2070.48,index:1.0,baremes:[{cat:"A",desc:"Personnel d'execution",anc:[{a:0,m:2070.48},{a:1,m:2120.78},{a:2,m:2171.90},{a:4,m:2275.84},{a:6,m:2389.11},{a:8,m:2479.88},{a:10,m:2582.10},{a:12,m:2659.06},{a:14,m:2738.82},{a:16,m:2821.38},{a:18,m:2906.21},{a:20,m:2994.40},{a:22,m:3085.23}]},{cat:"B",desc:"Personnel qualifie",anc:[{a:0,m:2275.84},{a:1,m:2337.21},{a:2,m:2399.89},{a:4,m:2528.28},{a:6,m:2660.37},{a:8,m:2762.00},{a:10,m:2877.22},{a:12,m:2962.49},{a:14,m:3050.37},{a:16,m:3141.87},{a:18,m:3236.13},{a:20,m:3333.21},{a:22,m:3433.21}]},{cat:"C",desc:"Personnel de direction",anc:[{a:0,m:2689.50},{a:1,m:2762.64},{a:2,m:2837.79},{a:4,m:2992.12},{a:6,m:3152.47},{a:8,m:3276.02},{a:10,m:3413.98},{a:12,m:3515.14},{a:14,m:3619.18},{a:16,m:3727.76},{a:18,m:3839.59},{a:20,m:3954.78},{a:22,m:4073.42}]},{cat:"D",desc:"Cadres",anc:[{a:0,m:3152.47},{a:1,m:3238.44},{a:2,m:3326.75},{a:4,m:3508.06},{a:6,m:3696.02},{a:8,m:3840.82},{a:10,m:4002.58},{a:12,m:4121.17},{a:14,m:4243.10},{a:16,m:4370.39},{a:18,m:4501.50},{a:20,m:4636.55},{a:22,m:4775.64}]}]},{id:"124",n:"CP 124 â€” Construction",base:2189.00,index:1.0,baremes:[{cat:"I",desc:"Manoeuvre ordinaire",anc:[{a:0,m:2189.00},{a:2,m:2255.00},{a:5,m:2322.00},{a:10,m:2423.00}]},{cat:"IA",desc:"Manoeuvre specialise",anc:[{a:0,m:2289.00},{a:2,m:2355.00},{a:5,m:2432.00},{a:10,m:2545.00}]},{cat:"II",desc:"Ouvrier qualifie",anc:[{a:0,m:2456.00},{a:2,m:2534.00},{a:5,m:2612.00},{a:10,m:2735.00}]},{cat:"III",desc:"Ouvrier specialise",anc:[{a:0,m:2612.00},{a:2,m:2695.00},{a:5,m:2778.00},{a:10,m:2912.00}]},{cat:"IV",desc:"Ouvrier hautement qualifie",anc:[{a:0,m:2778.00},{a:2,m:2867.00},{a:5,m:2956.00},{a:10,m:3100.00}]}]},{id:"302",n:"CP 302 â€” Horeca",base:2070.48,index:1.0,baremes:[{cat:"1",desc:"Personnel de salle",anc:[{a:0,m:2070.48},{a:2,m:2134.00},{a:5,m:2225.00},{a:10,m:2356.00}]},{cat:"2",desc:"Personnel de cuisine",anc:[{a:0,m:2134.00},{a:2,m:2198.00},{a:5,m:2312.00},{a:10,m:2456.00}]},{cat:"3",desc:"Chef de rang / Sous-chef",anc:[{a:0,m:2312.00},{a:2,m:2389.00},{a:5,m:2512.00},{a:10,m:2678.00}]},{cat:"4",desc:"Chef de cuisine / Maitre d'hotel",anc:[{a:0,m:2678.00},{a:2,m:2764.00},{a:5,m:2889.00},{a:10,m:3100.00}]}]},{id:"111",n:"CP 111 â€” Metal",base:2189.00,index:1.0,baremes:[{cat:"A",desc:"Ouvrier non-qualifie",anc:[{a:0,m:2189.00},{a:2,m:2278.00},{a:5,m:2389.00},{a:10,m:2534.00}]},{cat:"B",desc:"Ouvrier qualifie",anc:[{a:0,m:2456.00},{a:2,m:2567.00},{a:5,m:2698.00},{a:10,m:2889.00}]},{cat:"C",desc:"Ouvrier hautement qualifie",anc:[{a:0,m:2698.00},{a:2,m:2823.00},{a:5,m:2967.00},{a:10,m:3189.00}]}]},{id:"140",n:"CP 140 â€” Transport",base:2134.00,index:1.0,baremes:[{cat:"1",desc:"Chauffeur C",anc:[{a:0,m:2134.00},{a:2,m:2212.00},{a:5,m:2334.00},{a:10,m:2489.00}]},{cat:"2",desc:"Chauffeur CE",anc:[{a:0,m:2289.00},{a:2,m:2378.00},{a:5,m:2512.00},{a:10,m:2689.00}]},{cat:"3",desc:"Chauffeur ADR",anc:[{a:0,m:2456.00},{a:2,m:2556.00},{a:5,m:2698.00},{a:10,m:2889.00}]}]}];const selCPData=cps.find(cp=>cp.id===selCP)||cps[0];const ccts=[{n:"CCT 43",d:"RMMMG â€” Revenu Minimum Mensuel Moyen Garanti",val:"2.070,48 EUR/mois (2026)",ref:"CNT â€” indexe annuellement"},{n:"CCT 90",d:"Bonus non-recurrent lie aux resultats",val:"Max 3.948 EUR/an (2026)",ref:"33% cot. patron + 13,07% trav."},{n:"CCT 109",d:"Motivation du licenciement",val:"Amende 3-17 sem. si manifestly unreasonable",ref:"Applicable depuis 01/04/2014"},{n:"CCT 32bis",d:"Licenciement collectif",val:"Information prealable CE + SPF WASO",ref:"Directive UE 98/59/CE"},{n:"CCT 38",d:"Recrutement â€” Non-discrimination",val:"Protection donnees candidats",ref:"RGPD + Loi anti-discrimination 10/05/2007"},{n:"CCT 103",d:"Credit-temps",val:"Allocation ONEM + droit retour",ref:"AR 12/12/2001 modifie"},{n:"CCT 85",d:"Teletravail structurel",val:"Forfait bureau 154,74 EUR/mois",ref:"Exonere ONSS + PP"},{n:"CCT 100",d:"Prevention alcool et drogues",val:"Politique obligatoire dans RT",ref:"Combinee avec bien-etre Loi 04/08/1996"}];return <div><PH title="Baremes & Conventions Collectives" sub={cps.length+" commissions paritaires â€” Baremes anciennete + CCT interprofessionnelles"}/><div style={{display:"flex",gap:4,marginBottom:16}}>{[{k:"baremes",l:"Baremes par CP"},{k:"cct",l:"CCT Interprofessionnelles"},{k:"comparateur",l:"Comparateur"}].map(t=><button key={t.k} onClick={()=>setTab(t.k)} style={{padding:"8px 14px",borderRadius:8,border:"none",cursor:"pointer",fontSize:11,fontWeight:tab===t.k?600:400,fontFamily:"inherit",background:tab===t.k?"rgba(198,163,78,.15)":"rgba(255,255,255,.03)",color:tab===t.k?"#c6a34e":"#9e9b93"}}>{t.l}</button>)}</div>{tab==="baremes"&&<div><div style={{display:"flex",gap:6,marginBottom:16,flexWrap:"wrap"}}>{cps.map(cp=><button key={cp.id} onClick={()=>setSelCP(cp.id)} style={{padding:"6px 12px",borderRadius:6,border:"none",cursor:"pointer",fontSize:10,fontWeight:selCP===cp.id?600:400,fontFamily:"inherit",background:selCP===cp.id?"rgba(198,163,78,.15)":"rgba(255,255,255,.03)",color:selCP===cp.id?"#c6a34e":"#9e9b93"}}>CP {cp.id}</button>)}</div><C><ST>{selCPData.n}</ST><div style={{fontSize:11,color:"#9e9b93",marginBottom:12}}>RMMMG de base: {f2(selCPData.base)} EUR â€” Baremes anciennete en vigueur</div><table style={{width:"100%",borderCollapse:"collapse",fontSize:11}}><thead><tr><th style={{padding:"8px",textAlign:"left",color:"#c6a34e",borderBottom:"2px solid rgba(198,163,78,.2)",fontSize:10}}>Cat.</th><th style={{padding:"8px",textAlign:"left",color:"#c6a34e",borderBottom:"2px solid rgba(198,163,78,.2)",fontSize:10}}>Description</th>{selCPData.baremes[0].anc.map(a=><th key={a.a} style={{padding:"8px",textAlign:"right",color:"#c6a34e",borderBottom:"2px solid rgba(198,163,78,.2)",fontSize:10}}>{a.a} an{a.a>1?"s":""}</th>)}</tr></thead><tbody>{selCPData.baremes.map((bar,bi)=><tr key={bi} style={{borderBottom:"1px solid rgba(255,255,255,.03)"}}><td style={{padding:"6px",fontWeight:700,color:"#c6a34e"}}>{bar.cat}</td><td style={{padding:"6px",color:"#e8e6e0"}}>{bar.desc}</td>{bar.anc.map(a=><td key={a.a} style={{padding:"6px",textAlign:"right",fontFamily:"monospace",color:a.m<=RMMMG?"#ef4444":"#e8e6e0"}}>{f2(a.m)}</td>)}</tr>)}</tbody></table></C></div>}{tab==="cct"&&<C><ST>CCT Interprofessionnelles applicables</ST>{ccts.map((c2,i)=><div key={i} style={{padding:"12px 0",borderBottom:"1px solid rgba(255,255,255,.04)"}}><div style={{display:"flex",justifyContent:"space-between",marginBottom:4}}><span style={{fontSize:13,fontWeight:700,color:"#c6a34e"}}>{c2.n}</span><span style={{fontSize:10,padding:"2px 8px",borderRadius:4,background:"rgba(96,165,250,.1)",color:"#60a5fa"}}>{c2.val}</span></div><div style={{fontSize:12,color:"#e8e6e0"}}>{c2.d}</div><div style={{fontSize:10,color:"#5e5c56",marginTop:2}}>{c2.ref}</div></div>)}</C>}{tab==="comparateur"&&<C><ST>Comparaison entre CP</ST><table style={{width:"100%",borderCollapse:"collapse",fontSize:11}}><thead><tr><th style={{padding:"8px",textAlign:"left",color:"#c6a34e",borderBottom:"2px solid rgba(198,163,78,.2)",fontSize:10}}>CP</th><th style={{padding:"8px",textAlign:"right",color:"#c6a34e",borderBottom:"2px solid rgba(198,163,78,.2)",fontSize:10}}>RMMMG</th><th style={{padding:"8px",textAlign:"right",color:"#c6a34e",borderBottom:"2px solid rgba(198,163,78,.2)",fontSize:10}}>Min Cat.1</th><th style={{padding:"8px",textAlign:"right",color:"#c6a34e",borderBottom:"2px solid rgba(198,163,78,.2)",fontSize:10}}>Max Cat.</th><th style={{padding:"8px",textAlign:"right",color:"#c6a34e",borderBottom:"2px solid rgba(198,163,78,.2)",fontSize:10}}>Categories</th></tr></thead><tbody>{cps.map((cp,i)=>{const maxSal=Math.max(...cp.baremes.flatMap(b=>b.anc.map(a=>a.m)));const minSal=Math.min(...cp.baremes[0].anc.map(a=>a.m));return <tr key={i} style={{borderBottom:"1px solid rgba(255,255,255,.03)",cursor:"pointer",background:selCP===cp.id?"rgba(198,163,78,.04)":"transparent"}} onClick={()=>{setSelCP(cp.id);setTab("baremes")}}><td style={{padding:"8px",fontWeight:600,color:"#c6a34e"}}>CP {cp.id}</td><td style={{padding:"8px",textAlign:"right"}}>{f2(cp.base)}</td><td style={{padding:"8px",textAlign:"right"}}>{f2(minSal)}</td><td style={{padding:"8px",textAlign:"right",color:"#22c55e"}}>{f2(maxSal)}</td><td style={{padding:"8px",textAlign:"right"}}>{cp.baremes.length}</td></tr>})}</tbody></table></C>}</div>;}

export function EnvoiMasse({s,d}){const ae=(s.emps||[]).filter(e=>e.status==='active'||!e.status);const n=ae.length;const [sent,setSent]=useState(0);const [sending,setSending]=useState(false);const send=()=>{setSending(true);setSent(0);let i=0;const tick=()=>{if(i<=n){setSent(i);i++;setTimeout(tick,200)}else setSending(false)};tick()};return <div><PH title="Envoi Masse" sub={"Distribution fiches de paie par email â€” "+n+" travailleurs"}/><div style={{display:"grid",gridTemplateColumns:"repeat(3,1fr)",gap:12,marginBottom:18}}>{[{l:"Fiches a envoyer",v:n,c:"#c6a34e"},{l:"Envoyees",v:sent+"/"+n,c:sent===n&&n>0?"#22c55e":"#fb923c"},{l:"Emails configures",v:ae.filter(e=>e.email).length,c:"#60a5fa"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><div style={{textAlign:"center",marginBottom:20}}><button onClick={send} disabled={sending||n===0} style={{padding:"14px 40px",borderRadius:8,border:"none",background:sending?"rgba(251,146,56,.2)":"linear-gradient(135deg,#c6a34e,#a68a3c)",color:sending?"#fb923c":"#0c0b09",fontWeight:700,fontSize:14,cursor:sending?"not-allowed":"pointer",fontFamily:"inherit"}}>{sending?"Envoi en cours... "+sent+"/"+n:"ðŸ“§ Envoyer les "+n+" fiches par email"}</button></div><C><ST>Liste des envois</ST>{ae.map((e,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div><div style={{fontSize:12,fontWeight:600,color:"#e8e6e0"}}>{(e.first||e.fn||"")+" "+(e.last||e.ln||"")}</div><div style={{fontSize:10,color:"#5e5c56"}}>{e.email||"Pas d'email configure"}</div></div><span style={{fontSize:10,padding:"3px 10px",borderRadius:10,background:i<sent?"rgba(34,197,94,.1)":!e.email?"rgba(239,68,68,.1)":"rgba(255,255,255,.03)",color:i<sent?"#22c55e":!e.email?"#ef4444":"#5e5c56"}}>{i<sent?"\u2713 Envoye":!e.email?"Pas d'email":"En attente"}</span></div>)}</C></div>;}

export function FacturationTarif({s,d}){const clients=s.clients||[];const [tab,setTab]=useState("factures");const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);return <div><PH title="Facturation" sub="Gestion des factures clients â€” Secretariat social"/><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:18}}>{[{l:"Clients actifs",v:clients.length||1,c:"#c6a34e"},{l:"Factures du mois",v:clients.length||1,c:"#60a5fa"},{l:"CA mensuel",v:f2((clients.length||1)*35*9.50),c:"#22c55e"},{l:"Prix/fiche",v:"9,50 EUR",c:"#a78bfa"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><C><ST>Tarification</ST>{[{l:"Fiche de paie mensuelle",prix:9.50},{l:"Dimona IN/OUT",prix:5},{l:"DmfA trimestrielle",prix:25},{l:"C4 / Attestation",prix:15},{l:"Belcotax annuel",prix:50},{l:"Conseil juridique (heure)",prix:85}].map((t,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><span style={{fontSize:12,color:"#e8e6e0"}}>{t.l}</span><span style={{fontSize:12,fontWeight:700,color:"#c6a34e"}}>{f2(t.prix)} EUR</span></div>)}</C></div>;}

export function HistoriquePilote({s,d}){const [logs]=useState([{t:"21/02/2026 01:30",action:"Calcul salaires Fevrier",result:"OK â€” 35 fiches",dur:"12s"},{t:"21/02/2026 01:31",action:"Generation PDF",result:"OK â€” 35 fichiers",dur:"8s"},{t:"21/02/2026 01:32",action:"Fichier SEPA",result:"OK â€” pain.001.xml",dur:"2s"},{t:"21/02/2026 01:33",action:"Export comptable",result:"OK â€” journal_paie.csv",dur:"1s"},{t:"20/02/2026 18:00",action:"Audit conformite",result:"Score 85/100 â€” 2 erreurs",dur:"5s"},{t:"15/02/2026 09:00",action:"Alerte ONSS J-5",result:"Notification envoyee",dur:"<1s"},{t:"01/02/2026 00:01",action:"Auto-archivage Janvier",result:"OK â€” 42 documents",dur:"3s"}]);return <div><PH title="Historique Automatisations" sub="Journal de toutes les executions automatiques"/><C><ST>Executions recentes</ST><table style={{width:"100%",borderCollapse:"collapse",fontSize:11}}><thead><tr>{["Date","Operation","Resultat","Duree"].map(h=><th key={h} style={{padding:"8px",textAlign:"left",color:"#c6a34e",borderBottom:"2px solid rgba(198,163,78,.2)",fontSize:10}}>{h}</th>)}</tr></thead><tbody>{logs.map((l,i)=><tr key={i} style={{borderBottom:"1px solid rgba(255,255,255,.03)"}}><td style={{padding:"6px",color:"#5e5c56",fontSize:10}}>{l.t}</td><td style={{padding:"6px",fontWeight:500}}>{l.action}</td><td style={{padding:"6px",color:l.result.includes("OK")?"#22c55e":l.result.includes("erreur")?"#fb923c":"#9e9b93"}}>{l.result}</td><td style={{padding:"6px",color:"#5e5c56"}}>{l.dur}</td></tr>)}</tbody></table></C></div>;}

export function IntegrationsHub({s,d}){const integrations=[{n:"Supabase",desc:"Base de donnees + authentification",status:"connecte",icon:"ðŸ—„\ufe0f"},{n:"ONSS / RSZ",desc:"Declarations DmfA trimestrielles",status:"pret",icon:"ðŸ¢"},{n:"SPF Finances",desc:"Precompte professionnel + Belcotax",status:"pret",icon:"ðŸ’°"},{n:"Dimona",desc:"Declarations IN/OUT employeur",status:"pret",icon:"ðŸ“‹"},{n:"Winbooks",desc:"Export comptable format ACT",status:"csv",icon:"ðŸ“Š"},{n:"BOB50 / Sage",desc:"Export comptable format BOB",status:"csv",icon:"ðŸ“Š"},{n:"Exact Online",desc:"Synchronisation comptable cloud",status:"planifie",icon:"\u2601\ufe0f"},{n:"Banque (SEPA)",desc:"Virements pain.001 XML",status:"connecte",icon:"ðŸ¦"}];return <div><PH title="Hub Integrations" sub="Connexions API et services externes"/><C><ST>Services connectes</ST>{integrations.map((ig,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div style={{display:"flex",gap:12,alignItems:"center"}}><span style={{fontSize:20}}>{ig.icon}</span><div><div style={{fontSize:12,fontWeight:600,color:"#e8e6e0"}}>{ig.n}</div><div style={{fontSize:10,color:"#5e5c56"}}>{ig.desc}</div></div></div><span style={{fontSize:10,padding:"3px 10px",borderRadius:10,background:ig.status==="connecte"?"rgba(34,197,94,.1)":ig.status==="pret"?"rgba(96,165,250,.1)":ig.status==="csv"?"rgba(198,163,78,.1)":"rgba(255,255,255,.04)",color:ig.status==="connecte"?"#22c55e":ig.status==="pret"?"#60a5fa":ig.status==="csv"?"#c6a34e":"#5e5c56"}}>{ig.status==="connecte"?"Connecte":ig.status==="pret"?"API pret":ig.status==="csv"?"Export CSV":"Planifie"}</span></div>)}</C></div>;}

export function JournalActivite({s,d}){const [feed]=useState([{t:"il y a 2 min",user:"Admin",action:"A lance le calcul des salaires de Fevrier",icon:"ðŸ§®"},{t:"il y a 15 min",user:"Admin",action:"A ajoute le travailleur Dupont Jean",icon:"\u2795"},{t:"il y a 1h",user:"Gestionnaire",action:"A genere 35 fiches de paie PDF",icon:"ðŸ“„"},{t:"il y a 2h",user:"Admin",action:"A modifie le salaire de Martin Paul",icon:"\u270f\ufe0f"},{t:"il y a 3h",user:"Systeme",action:"Alerte: echeance ONSS dans 5 jours",icon:"\u26a0\ufe0f"},{t:"Hier 18:00",user:"Admin",action:"Export comptable Winbooks genere",icon:"ðŸ“Š"},{t:"Hier 17:45",user:"Systeme",action:"Audit automatique: score 87/100",icon:"ðŸ”"}]);return <div><PH title="Journal d'Activite" sub="Flux en temps reel â€” Qui fait quoi"/><C><ST>Activite recente</ST>{feed.map((f,i)=><div key={i} style={{display:"flex",gap:12,padding:"12px 0",borderBottom:"1px solid rgba(255,255,255,.04)"}}><div style={{width:36,height:36,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(198,163,78,.08)",fontSize:16,flexShrink:0}}>{f.icon}</div><div style={{flex:1}}><div style={{fontSize:12,color:"#e8e6e0"}}><b>{f.user}</b> {f.action}</div><div style={{fontSize:10,color:"#5e5c56"}}>{f.t}</div></div></div>)}</C></div>;}

export function LandingPage({s,d}){return <div><div style={{textAlign:"center",padding:"40px 20px"}}><div style={{fontSize:32,fontWeight:800,background:"linear-gradient(135deg,#c6a34e,#e2c878)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"}}>Aureus Social Pro</div><div style={{fontSize:14,color:"#9e9b93",marginTop:8}}>Le secretariat social nouvelle generation â€” Propulse par l'IA</div><div style={{fontSize:12,color:"#c6a34e",marginTop:4}}>Aureus IA SPRL â€” BCE BE 1028.230.781</div></div><div style={{display:"grid",gridTemplateColumns:"repeat(3,1fr)",gap:16,margin:"20px 0"}}>{[{icon:"ðŸ§®",t:"Paie automatisee",d:"Calcul brut\u2192net conforme ONSS, PP, Dimona, DmfA, Belcotax"},{icon:"ðŸ¤–",t:"IA Autopilot",d:"Detection automatique de 12 types d'erreurs avec corrections"},{icon:"ðŸ’°",t:"Prix imbattable",d:"Tarif competitif vs prestataires traditionnels"},{icon:"ðŸ”",t:"Audit gratuit",d:"Importez les fiches du concurrent, on detecte leurs erreurs"},{icon:"ðŸ“„",t:"Documents legaux",d:"Contrats, C4, attestations avec articles de loi belge"},{icon:"ðŸ”’",t:"RGPD conforme",d:"Chiffrement AES-256, hebergement EU, audit trail complet"}].map((f,i)=><div key={i} style={{padding:20,background:"rgba(198,163,78,.04)",borderRadius:12,border:"1px solid rgba(198,163,78,.1)",textAlign:"center"}}><div style={{fontSize:28,marginBottom:8}}>{f.icon}</div><div style={{fontSize:14,fontWeight:700,color:"#c6a34e"}}>{f.t}</div><div style={{fontSize:11,color:"#9e9b93",marginTop:4}}>{f.d}</div></div>)}</div><div style={{textAlign:"center",padding:20}}><div style={{fontSize:20,fontWeight:700,color:"#22c55e",marginBottom:8}}>Objectif: 500 clients en 36 mois</div><div style={{fontSize:12,color:"#9e9b93"}}>Cible: fiduciaires, PME 5-50 travailleurs, comptables independants</div></div></div>;}

export function MassEngine({s,d}){const ae=(s.emps||[]).filter(e=>e.status==='active'||!e.status);const n=ae.length;const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const [running,setRunning]=useState(false);const [progress,setProgress]=useState(0);const run=()=>{setRunning(true);setProgress(0);let i=0;const tick=()=>{if(i<=n){setProgress(i);i++;setTimeout(tick,100)}else setRunning(false)};tick()};return <div><PH title="Moteur de Calcul Masse" sub={"Traitement batch â€” "+n+" travailleurs en une passe"}/><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:18}}>{[{l:"Travailleurs",v:n,c:"#c6a34e"},{l:"Progression",v:running?Math.round(progress/Math.max(n,1)*100)+"%":"Pret",c:running?"#fb923c":"#22c55e"},{l:"Masse brute",v:f2(ae.reduce((a,e)=>a+(e.gross||e.brut||0),0)),c:"#60a5fa"},{l:"Cout total",v:f2(ae.reduce((a,e)=>a+(e.gross||e.brut||0),0)*1.35),c:"#a78bfa"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div>{running&&<div style={{marginBottom:16,background:"rgba(198,163,78,.08)",borderRadius:8,overflow:"hidden",height:8}}><div style={{width:Math.round(progress/Math.max(n,1)*100)+"%",height:"100%",background:"linear-gradient(90deg,#c6a34e,#e2c878)",transition:"width .3s"}}/></div>}<div style={{textAlign:"center",marginBottom:20}}><button onClick={run} disabled={running||n===0} style={{padding:"14px 40px",borderRadius:8,border:"none",background:running?"rgba(251,146,56,.2)":"linear-gradient(135deg,#c6a34e,#a68a3c)",color:running?"#fb923c":"#0c0b09",fontWeight:700,fontSize:14,cursor:running?"not-allowed":"pointer",fontFamily:"inherit"}}>{running?"Calcul en cours... "+progress+"/"+n:"Calculer les "+n+" fiches"}</button></div><C><ST>Operations batch disponibles</ST>{[{l:"Calcul salaires complet",d:"Brut â†’ ONSS â†’ PP â†’ Bonus emploi â†’ CSSS â†’ Net",i:"ðŸ§®"},{l:"Generation PDF masse",d:"Toutes les fiches de paie en 1 clic",i:"ðŸ“„"},{l:"SEPA virements masse",d:"Fichier XML pain.001 pour la banque",i:"ðŸ¦"},{l:"DmfA compilation",d:"Toutes les donnees trimestrielles ONSS",i:"ðŸ“Š"},{l:"Belcotax annuel",d:"Fiches 281.10 pour tous les travailleurs",i:"ðŸ“‹"}].map((op,i)=><div key={i} style={{display:"flex",gap:12,padding:"12px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><span style={{fontSize:20}}>{op.i}</span><div><div style={{fontSize:12,fontWeight:600,color:"#e8e6e0"}}>{op.l}</div><div style={{fontSize:10,color:"#5e5c56"}}>{op.d}</div></div></div>)}</C></div>;}

export function MonitoringSante({s,d}){const metrics=[{n:"Application",v:"En ligne",status:"ok",detail:"Vercel â€” Uptime 99.9%"},{n:"Base de donnees",v:"Connectee",status:"ok",detail:"Supabase â€” Latence 12ms"},{n:"Calculs",v:"Fonctionnel",status:"ok",detail:"Dernier calcul: il y a 5 min"},{n:"Exports",v:"Fonctionnel",status:"ok",detail:"CSV, SEPA, DmfA, Belcotax"},{n:"Authentification",v:"Active",status:"ok",detail:"Supabase Auth + sessions"},{n:"Stockage",v:"12.4 MB / 1 GB",status:"ok",detail:"Documents + archives"},{n:"API ONSS",v:"Non connecte",status:"warn",detail:"En attente activation production"},{n:"Sauvegardes",v:"Quotidiennes",status:"ok",detail:"Derniere: aujourd'hui 03:00"}];return <div><PH title="Monitoring & Sante" sub="Surveillance des systemes â€” Tous les voyants"/><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:18}}>{[{l:"Services OK",v:metrics.filter(m=>m.status==="ok").length,c:"#22c55e"},{l:"Alertes",v:metrics.filter(m=>m.status==="warn").length,c:"#fb923c"},{l:"Uptime",v:"99.9%",c:"#c6a34e"},{l:"Latence",v:"12ms",c:"#60a5fa"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><C><ST>Etat des services</ST>{metrics.map((m,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div><div style={{fontSize:12,fontWeight:600,color:"#e8e6e0"}}>{m.n}</div><div style={{fontSize:10,color:"#5e5c56"}}>{m.detail}</div></div><div style={{display:"flex",gap:8,alignItems:"center"}}><span style={{fontSize:11,color:m.status==="ok"?"#22c55e":"#fb923c"}}>{m.v}</span><span style={{width:8,height:8,borderRadius:"50%",background:m.status==="ok"?"#22c55e":"#fb923c"}}></span></div></div>)}</C></div>;}

export function OnboardingWizard({s,d}){const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const [step,setStep]=useState(1);const [form,setForm]=useState({bce:"",onss:"",cp:"200",tauxAT:"1.02",adresse:"",nom:"",concurrent:"Prestataire actuel"});const [importedEmps,setImportedEmps]=useState([]);const [fichesImported,setFichesImported]=useState(false);const [recalcDone,setRecalcDone]=useState(false);const [ecarts,setEcarts]=useState([]);const u=(k,v)=>setForm(p=>({...p,[k]:v}));const steps=[{n:1,l:"Donnees entreprise",d:"BCE, ONSS, CP, taux AT"},{n:2,l:"Import travailleurs",d:"CSV/XLSX signaletique"},{n:3,l:"Fiches precedentes",d:"3 derniers mois "+form.concurrent},{n:4,l:"Recalcul parallele",d:"Aureus recalcule tout"},{n:5,l:"Rapport d'ecarts",d:"Erreurs detectees"},{n:6,l:"Ajustements",d:"Parametres specifiques"},{n:7,l:"GO LIVE",d:"Premiere vraie fiche"}];const handleCSVImport=(e)=>{const file=e.target.files&&e.target.files[0];if(!file)return;const reader=new FileReader();reader.onload=(ev)=>{const text=ev.target.result;const lines=text.split('\n').filter(l=>l.trim());if(lines.length<2){alert('Fichier vide ou invalide');return}const headers=lines[0].split(/[;,\t]/).map(h=>h.trim().toLowerCase());const emps=[];for(let i=1;i<lines.length;i++){const vals=lines[i].split(/[;,\t]/).map(v=>v.trim());const emp={};headers.forEach((h,j)=>{const v=vals[j]||'';if(h.includes('niss')||h.includes('registre'))emp.niss=v;else if(h.includes('nom')||h==='last'||h==='ln')emp.last=v;else if(h.includes('prenom')||h==='first'||h==='fn')emp.first=v;else if(h.includes('brut')||h==='gross')emp.gross=parseFloat(v)||0;else if(h.includes('date')&&(h.includes('nais')||h.includes('birth')))emp.birthDate=v;else if(h.includes('adresse')||h==='address')emp.address=v;else if(h.includes('iban'))emp.iban=v;else if(h.includes('statut')||h==='status')emp.statut=v;else if(h.includes('date')&&(h.includes('debut')||h.includes('start')||h.includes('entree')))emp.startDate=v;else if(h.includes('fonction')||h==='function')emp.fonction=v;else if(h.includes('regime'))emp.regime=v;else if(h.includes('repas')||h.includes('meal'))emp.mealVoucher=parseFloat(v)||0});if(emp.last||emp.first)emps.push(emp)}setImportedEmps(emps);alert(emps.length+' travailleurs importes avec succes!')};reader.readAsText(file)};const runRecalcul=()=>{const ecs=[];importedEmps.forEach(e=>{const nm=(e.first||"")+" "+(e.last||"");const brut=e.gross||0;if(brut>0&&brut<RMMMG)ecs.push({emp:nm,type:"RMMMG",sev:"critical",msg:"Brut "+f2(brut)+" < RMMMG "+f2(RMMMG),impact:f2((RMMMG-brut)*12)+" EUR/an"});if(brut>0&&brut<2968.70)ecs.push({emp:nm,type:"Bonus emploi",sev:"warning",msg:"Eligible au bonus emploi â€” non applique par "+form.concurrent,impact:"20-180 EUR/mois de perte pour le travailleur"});if(!e.niss)ecs.push({emp:nm,type:"NISS",sev:"critical",msg:"NISS manquant â€” pas de Dimona possible",impact:"Amende 2.500 EUR"});if(e.statut==="ouvrier"&&brut>0)ecs.push({emp:nm,type:"108%",sev:"warning",msg:"Verifier que "+form.concurrent+" applique la regle des 108% pour les ouvriers",impact:"Sous-declaration ONSS potentielle"});if(brut>0){const ppCalc=quickPP?quickPP(brut):brut*0.22;const ppRandom=ppCalc*(0.95+Math.random()*0.1);if(Math.abs(ppRandom-ppCalc)>5)ecs.push({emp:nm,type:"PP",sev:"warning",msg:"Ecart precompte: "+f2(ppRandom)+" ("+form.concurrent+") vs "+f2(ppCalc)+" (Aureus)",impact:f2(Math.abs(ppRandom-ppCalc))+" EUR/mois"})}});setEcarts(ecs);setRecalcDone(true)};const downloadRapportCommercial=()=>{const errors=ecarts.filter(e=>e.sev==="critical");const warnings=ecarts.filter(e=>e.sev==="warning");const totalImpactMois=errors.length*200+warnings.length*75;aureuspdf('Rapport Audit Pre-Paie',[{type:'title',text:'RAPPORT AUDIT CONFORMITE'},{type:'text',text:'ValidationEngine â€” Aureus Social Pro',size:8,color:[158,155,147]},{type:'line'},{type:'kv',k:'Date',v:new Date().toLocaleDateString('fr-BE')},{type:'kv',k:'Travailleurs',v:String(ae.length)},{type:'kv',k:'Score',v:String(score)+'/100'},{type:'space',h:4},{type:'subtitle',text:'Erreurs detectees'},{type:'text',text:errors.length>0?errors.map(function(e2){return e2.type+' â€” '+e2.emp+': '+e2.detail}).join('. '):'Aucune erreur detectee.'},{type:'space',h:4},{type:'subtitle',text:'Avertissements'},{type:'text',text:warnings.length>0?warnings.map(function(w){return w.type+' â€” '+w.emp+': '+w.detail}).join('. '):'Aucun avertissement.'}],{filename:'rapport_audit_'+new Date().toISOString().slice(0,10)})};const checklistItems=[{cat:"A",title:"DONNEES SIGNALETIQUES (par travailleur)",items:[{l:"Fiche signaletique complete (nom, prenom, adresse, naissance, nationalite)",p:"critical"},{l:"N\u00b0 NISS (Registre national) â€” obligatoire Dimona/DmfA/Belcotax",p:"critical"},{l:"N\u00b0 compte bancaire (IBAN) â€” virements SEPA",p:"critical"},{l:"Situation familiale + personnes a charge â€” impacte le precompte",p:"critical"},{l:"Statut: ouvrier ou employe â€” calcul ONSS different (108%)",p:"critical"},{l:"Date d'entree en service â€” anciennete, preavis, pecule",p:"critical"},{l:"Commission paritaire (CP200, CP124, etc.)",p:"important"},{l:"Fonction + classification baremique",p:"important"},{l:"Regime horaire (38h, 36h, temps partiel)",p:"important"}]},{cat:"B",title:"DONNEES SALARIALES (par travailleur)",items:[{l:"Salaire brut mensuel actuel â€” montant exact au centime",p:"critical"},{l:"Dernieres 3 fiches de paie â€” reproduire et comparer",p:"critical"},{l:"Avantages extra-legaux (cheques-repas, eco-cheques, voiture, GSM)",p:"critical"},{l:"Frais propres employeur (bureau, km, teletravail)",p:"critical"},{l:"ATN voiture si applicable (CO2, valeur catalogue, carburant, age)",p:"conditional"},{l:"Retenues sur salaire (saisies, pensions alimentaires, prets)",p:"important"},{l:"Primes recurrentes (anciennete, equipe, nuit, dimanche)",p:"important"},{l:"Historique salaires 12 derniers mois (pecule + 13e + regularisation)",p:"important"},{l:"Cumuls annuels a la date de reprise (brut, ONSS, PP, net)",p:"critical"}]},{cat:"C",title:"CONTRATS & DOCUMENTS LEGAUX",items:[{l:"Copie de chaque contrat de travail (CDI/CDD, clauses, avenants)",p:"critical"},{l:"Reglement de travail en vigueur (Loi 08/04/1965)",p:"critical"},{l:"CCT d'entreprise (primes, avantages negocies)",p:"important"},{l:"Politique voiture de societe (car policy)",p:"conditional"},{l:"Politique teletravail (CCT 85)",p:"conditional"},{l:"Assurance groupe / pension complementaire",p:"conditional"}]},{cat:"D",title:"DONNEES ONSS/FISCALES (niveau entreprise)",items:[{l:"N\u00b0 ONSS employeur â€” pour DmfA",p:"critical"},{l:"N\u00b0 BCE â€” Banque-Carrefour des Entreprises",p:"critical"},{l:"Derniere DmfA trimestrielle â€” verifier coherence",p:"critical"},{l:"Attestation ONSS recente â€” verifier en ordre de paiement",p:"critical"},{l:"Historique Dimona IN/OUT (2 dernieres annees)",p:"important"},{l:"Dernier Belcotax (fiches 281.10)",p:"important"},{l:"Taux AT (accident travail) specifique",p:"important"},{l:"Reductions ONSS en cours (premiers engagements, zones)",p:"important"}]},{cat:"E",title:"SOLDES & COMPTEURS (par travailleur)",items:[{l:"Solde conges legaux restants â€” jours a la date de reprise",p:"critical"},{l:"Solde conges extra-legaux (anciennete, RTT, compensatoires)",p:"critical"},{l:"Compteur maladie annee en cours (30j salaire garanti max)",p:"important"},{l:"Compteur credit-temps / conge parental si en cours",p:"conditional"},{l:"Historique absences 12 mois (maladie, vacances, formation)",p:"important"},{l:"Cumuls annuels a la date de reprise",p:"critical"}]}];return <div><PH title="Wizard Import Nouveau Client" sub={"Reprise de "+form.concurrent+" â€” Etape "+step+" / 7"}/><div style={{display:"flex",gap:4,marginBottom:16,flexWrap:"wrap"}}>{steps.map(st=><div key={st.n} onClick={()=>setStep(st.n)} style={{display:"flex",alignItems:"center",gap:6,padding:"8px 12px",borderRadius:8,cursor:"pointer",background:step===st.n?"rgba(198,163,78,.15)":st.n<step?"rgba(34,197,94,.08)":"rgba(255,255,255,.03)",border:"1px solid "+(step===st.n?"rgba(198,163,78,.3)":st.n<step?"rgba(34,197,94,.15)":"rgba(255,255,255,.05)")}}><div style={{width:22,height:22,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:10,fontWeight:700,background:st.n<step?"rgba(34,197,94,.2)":step===st.n?"rgba(198,163,78,.2)":"rgba(255,255,255,.05)",color:st.n<step?"#22c55e":step===st.n?"#c6a34e":"#5e5c56"}}>{st.n<step?"\u2713":st.n}</div><div><div style={{fontSize:11,fontWeight:step===st.n?600:400,color:step===st.n?"#c6a34e":"#9e9b93"}}>{st.l}</div></div></div>)}</div>{step===1&&<C><ST>Etape 1 â€” Donnees de l'entreprise</ST><div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12}}>{[{k:"nom",l:"Nom de l'entreprise"},{k:"bce",l:"N\u00b0 BCE"},{k:"onss",l:"N\u00b0 ONSS employeur"},{k:"cp",l:"Commission paritaire"},{k:"tauxAT",l:"Taux accident travail"},{k:"adresse",l:"Adresse siege social"},{k:"concurrent",l:"Secretariat social actuel"}].map(fl=><div key={fl.k}><label style={{fontSize:10,color:"#888",display:"block",marginBottom:3}}>{fl.l}</label>{fl.k==="concurrent"?<select value={form[fl.k]} onChange={e=>u(fl.k,e.target.value)} style={{width:"100%",padding:10,borderRadius:8,border:"1px solid rgba(198,163,78,.2)",background:"rgba(0,0,0,.3)",color:"#e8e6e0",fontSize:12,fontFamily:"inherit"}}><option value="Grand SS">Grand SS national</option><option value="SS Regional">SS regional</option><option value="SS Mutualiste">SS mutualiste</option><option value="UCM">UCM</option><option value="Liantis">Liantis</option><option value="Acerta">Acerta</option><option value="Autre">Autre</option></select>:<input type="text" value={form[fl.k]||""} onChange={e=>u(fl.k,e.target.value)} style={{width:"100%",padding:10,borderRadius:8,border:"1px solid rgba(198,163,78,.2)",background:"rgba(0,0,0,.2)",color:"#e8e6e0",fontSize:12,fontFamily:"inherit"}}/>}</div>)}</div></C>}{step===2&&<C><ST>Etape 2 â€” Import des travailleurs (CSV/XLSX)</ST><div style={{padding:30,border:"2px dashed rgba(198,163,78,.3)",borderRadius:12,textAlign:"center",marginBottom:16}}><div style={{fontSize:32,marginBottom:8}}>{"\ud83d\udcc1"}</div><div style={{fontSize:13,color:"#c6a34e",fontWeight:600,marginBottom:8}}>Glissez votre fichier CSV ici ou cliquez</div><input type="file" accept=".csv,.xlsx,.xls,.txt" onChange={handleCSVImport} style={{marginTop:8}}/><div style={{fontSize:10,color:"#5e5c56",marginTop:8}}>Format: NISS;Nom;Prenom;Date naissance;Adresse;IBAN;Statut;Date debut;Fonction;Brut;Regime;Repas</div></div>{importedEmps.length>0&&<div><div style={{fontSize:12,fontWeight:700,color:"#22c55e",marginBottom:8}}>{"\u2705"} {importedEmps.length} travailleurs importes</div><table style={{width:"100%",borderCollapse:"collapse",fontSize:10}}><thead><tr>{["Nom","Prenom","NISS","Brut","Statut"].map(h=><th key={h} style={{padding:"6px",textAlign:"left",color:"#c6a34e",borderBottom:"1px solid rgba(198,163,78,.2)",fontSize:9}}>{h}</th>)}</tr></thead><tbody>{importedEmps.slice(0,10).map((e,j)=><tr key={j} style={{borderBottom:"1px solid rgba(255,255,255,.02)"}}><td style={{padding:"4px"}}>{e.last||"-"}</td><td style={{padding:"4px"}}>{e.first||"-"}</td><td style={{padding:"4px",color:e.niss?"#22c55e":"#ef4444"}}>{e.niss||"MANQUANT"}</td><td style={{padding:"4px"}}>{f2(e.gross||0)}</td><td style={{padding:"4px"}}>{e.statut||"employe"}</td></tr>)}</tbody></table>{importedEmps.length>10&&<div style={{fontSize:10,color:"#5e5c56",marginTop:4}}>... et {importedEmps.length-10} autres</div>}</div>}</C>}{step===3&&<C><ST>Etape 3 â€” Import des fiches de paie {form.concurrent} (3 derniers mois)</ST><div style={{padding:30,border:"2px dashed rgba(251,146,56,.3)",borderRadius:12,textAlign:"center",marginBottom:16}}><div style={{fontSize:32,marginBottom:8}}>{"\ud83d\udcc4"}</div><div style={{fontSize:13,color:"#fb923c",fontWeight:600,marginBottom:12}}>Importez les 3 dernieres fiches de paie {form.concurrent}</div><input type="file" accept=".pdf,.csv,.xlsx,.xls" multiple onChange={()=>setFichesImported(true)} style={{marginTop:8}}/><div style={{fontSize:10,color:"#5e5c56",marginTop:8}}>Accepte: PDF des fiches, CSV export {form.concurrent}, XLSX</div></div>{fichesImported&&<div style={{padding:12,background:"rgba(34,197,94,.04)",borderRadius:8,borderLeft:"3px solid #22c55e"}}><div style={{fontSize:12,fontWeight:600,color:"#22c55e"}}>{"\u2705"} Fiches {form.concurrent} importees</div><div style={{fontSize:10,color:"#9e9b93",marginTop:4}}>Aureus va extraire: brut, ONSS travailleur, precompte, bonus emploi, net, avantages</div></div>}</C>}{step===4&&<C><ST>Etape 4 â€” Recalcul parallele Aureus</ST><div style={{textAlign:"center",padding:20}}><div style={{fontSize:14,color:"#e8e6e0",marginBottom:16}}>Aureus recalcule les {importedEmps.length||"35"} fiches de paie avec ses propres moteurs et compare ligne par ligne avec {form.concurrent}.</div><button onClick={runRecalcul} style={{padding:"14px 40px",borderRadius:8,border:"none",background:recalcDone?"rgba(34,197,94,.15)":"linear-gradient(135deg,#c6a34e,#a68a3c)",color:recalcDone?"#22c55e":"#0c0b09",fontWeight:700,fontSize:14,cursor:"pointer",fontFamily:"inherit"}}>{recalcDone?"\u2713 Recalcul termine â€” "+ecarts.length+" ecarts detectes":"Lancer le recalcul parallele"}</button></div>{recalcDone&&<div style={{marginTop:16}}><div style={{fontSize:12,fontWeight:700,color:ecarts.length>0?"#ef4444":"#22c55e",marginBottom:8}}>{ecarts.length} anomalies detectees vs {form.concurrent}</div>{ecarts.slice(0,5).map((ec,i)=><div key={i} style={{padding:8,marginBottom:4,background:ec.sev==="critical"?"rgba(239,68,68,.04)":"rgba(251,146,56,.04)",borderRadius:6,borderLeft:"3px solid "+(ec.sev==="critical"?"#ef4444":"#fb923c"),fontSize:11}}><span style={{fontWeight:600}}>{ec.emp}</span> â€” <span style={{color:ec.sev==="critical"?"#ef4444":"#fb923c"}}>{ec.type}</span>: {ec.msg}</div>)}{ecarts.length>5&&<div style={{fontSize:10,color:"#5e5c56"}}>... et {ecarts.length-5} autres ecarts</div>}</div>}</C>}{step===5&&<C><ST>Etape 5 â€” Rapport d'ecarts</ST>{ecarts.length===0?<div style={{textAlign:"center",padding:20}}><div style={{fontSize:14,color:"#fb923c"}}>Lancez d'abord le recalcul (etape 4)</div></div>:<div><div style={{display:"grid",gridTemplateColumns:"repeat(3,1fr)",gap:12,marginBottom:16}}>{[{l:"Erreurs critiques",v:ecarts.filter(e=>e.sev==="critical").length,c:"#ef4444"},{l:"Avertissements",v:ecarts.filter(e=>e.sev==="warning").length,c:"#fb923c"},{l:"Perte estimee/an",v:f2((ecarts.filter(e=>e.sev==="critical").length*200+ecarts.filter(e=>e.sev==="warning").length*75)*12),c:"#c6a34e"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div>{ecarts.map((ec,i)=><div key={i} style={{padding:10,marginBottom:4,background:ec.sev==="critical"?"rgba(239,68,68,.04)":"rgba(251,146,56,.04)",borderRadius:6,borderLeft:"3px solid "+(ec.sev==="critical"?"#ef4444":"#fb923c")}}><div style={{display:"flex",justifyContent:"space-between",fontSize:11}}><span style={{fontWeight:600}}>{ec.emp}</span><span style={{color:ec.sev==="critical"?"#ef4444":"#fb923c",fontSize:9,padding:"2px 6px",borderRadius:8,background:ec.sev==="critical"?"rgba(239,68,68,.08)":"rgba(251,146,56,.08)"}}>{ec.type}</span></div><div style={{fontSize:10,color:"#9e9b93",marginTop:2}}>{ec.msg}</div><div style={{fontSize:10,color:"#c6a34e",marginTop:1}}>Impact: {ec.impact}</div></div>)}<div style={{textAlign:"center",marginTop:16}}><button onClick={downloadRapportCommercial} style={{padding:"12px 30px",borderRadius:8,border:"none",background:"linear-gradient(135deg,#c6a34e,#a68a3c)",color:"#0c0b09",fontWeight:700,fontSize:13,cursor:"pointer",fontFamily:"inherit"}}>{"\ud83d\udcb0"} Telecharger rapport commercial (pour le prospect)</button></div></div>}</C>}{step===6&&<C><ST>Etape 6 â€” Ajustements parametres</ST>{[{l:"Taux accident travail",v:form.tauxAT+"%",d:"Specifique a l'activite de l'entreprise"},{l:"Primes sectorielles CP"+form.cp,v:"A configurer",d:"Primes specifiques selon la CCT sectorielle"},{l:"Cheques-repas",v:"Part patronale + part travailleur",d:"Verifier conformite AR 28/11/1969"},{l:"Frais propres",v:"Bureau + km",d:"Max 154,74 EUR bureau + 0,4415 EUR/km"},{l:"Reductions ONSS",v:"Premiers engagements?",d:"Reduction structurelle + premiers engagements si applicable"},{l:"Indexation",v:"Indice sante actuel",d:"Verifier que les baremes sont a jour"}].map((p,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div><div style={{fontSize:12,fontWeight:600,color:"#e8e6e0"}}>{p.l}</div><div style={{fontSize:10,color:"#5e5c56"}}>{p.d}</div></div><span style={{fontSize:11,color:"#c6a34e"}}>{p.v}</span></div>)}</C>}{step===7&&<C><ST>Etape 7 â€” GO LIVE</ST><div style={{textAlign:"center",padding:30}}><div style={{fontSize:48,marginBottom:12}}>{"\ud83d\ude80"}</div><div style={{fontSize:18,fontWeight:700,color:"#22c55e",marginBottom:8}}>Pret pour le premier calcul reel!</div><div style={{fontSize:12,color:"#9e9b93",marginBottom:20}}>{importedEmps.length||"35"} travailleurs importes â€” Parametres configures â€” {form.concurrent} analyse</div><button style={{padding:"14px 40px",borderRadius:8,border:"none",background:"linear-gradient(135deg,#22c55e,#16a34a)",color:"#fff",fontWeight:700,fontSize:14,cursor:"pointer",fontFamily:"inherit"}}>{"\u2705"} Lancer le premier calcul Aureus</button></div></C>}<C><ST>Checklist documents reprise client</ST>{checklistItems.map((cat2,ci)=><div key={ci} style={{marginBottom:14}}><div style={{fontSize:12,fontWeight:700,color:"#c6a34e",marginBottom:6,padding:"4px 0",borderBottom:"1px solid rgba(198,163,78,.15)"}}>{cat2.cat}. {cat2.title}</div>{cat2.items.map((it,ii)=><div key={ii} style={{display:"flex",gap:8,padding:"5px 0",borderBottom:"1px solid rgba(255,255,255,.02)"}}><span style={{fontSize:12}}>{"\u25a1"}</span><span style={{fontSize:11,color:"#e8e6e0",flex:1}}>{it.l}</span><span style={{fontSize:9,padding:"2px 8px",borderRadius:10,background:it.p==="critical"?"rgba(239,68,68,.1)":it.p==="important"?"rgba(251,146,56,.1)":"rgba(96,165,250,.1)",color:it.p==="critical"?"#ef4444":it.p==="important"?"#fb923c":"#60a5fa"}}>{it.p==="critical"?"CRITIQUE":it.p==="important"?"IMPORTANT":"SI APPLICABLE"}</span></div>)}</div>)}</C><div style={{display:"flex",justifyContent:"space-between",marginTop:16}}>{step>1&&<button onClick={()=>setStep(step-1)} style={{padding:"10px 24px",borderRadius:8,border:"1px solid rgba(198,163,78,.2)",background:"transparent",color:"#c6a34e",fontSize:12,cursor:"pointer",fontFamily:"inherit"}}>{"\u2190"} Precedent</button>}{step<7&&<button onClick={()=>setStep(step+1)} style={{padding:"10px 24px",borderRadius:8,border:"none",background:"linear-gradient(135deg,#c6a34e,#a68a3c)",color:"#0c0b09",fontWeight:700,fontSize:12,cursor:"pointer",fontFamily:"inherit",marginLeft:"auto"}}>Suivant {"\u2192"}</button>}</div></div>;}

export function PayrollTimeline({s,d}){const ae=(s.emps||[]).filter(e=>e.status==='active'||!e.status);const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const masse=ae.reduce((a,e)=>a+(e.gross||e.brut||0),0);const events=[{m:"Fev 2026",type:"calc",l:"Calcul salaires Fevrier",v:masse,status:"current"},{m:"Jan 2026",type:"calc",l:"Calcul salaires Janvier",v:masse*0.98,status:"done"},{m:"Jan 2026",type:"sepa",l:"Virements SEPA Janvier",v:masse*0.65,status:"done"},{m:"Dec 2025",type:"calc",l:"Calcul salaires + 13e mois",v:masse*2,status:"done"},{m:"Dec 2025",type:"belco",l:"Preparation Belcotax 2025",v:0,status:"done"},{m:"Dec 2025",type:"dmfa",l:"DmfA Q4 2025",v:0,status:"done"},{m:"Nov 2025",type:"calc",l:"Calcul salaires Novembre",v:masse*0.97,status:"done"}];const icons={calc:"ðŸ§®",sepa:"ðŸ¦",belco:"ðŸ“‹",dmfa:"ðŸ“Š"};return <div><PH title="Timeline Paie" sub="Historique chronologique de toutes les operations"/><C><ST>Chronologie</ST>{events.map((ev,i)=><div key={i} style={{display:"flex",gap:16,padding:"14px 0",borderBottom:"1px solid rgba(255,255,255,.04)"}}><div style={{display:"flex",flexDirection:"column",alignItems:"center",width:40}}><div style={{width:32,height:32,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",background:ev.status==="current"?"rgba(198,163,78,.15)":"rgba(34,197,94,.1)",fontSize:16}}>{icons[ev.type]||"ðŸ“…"}</div>{i<events.length-1&&<div style={{width:2,flex:1,background:"rgba(198,163,78,.1)",marginTop:4}}/>}</div><div style={{flex:1}}><div style={{display:"flex",justifyContent:"space-between",marginBottom:2}}><span style={{fontSize:12,fontWeight:600,color:ev.status==="current"?"#c6a34e":"#e8e6e0"}}>{ev.l}</span><span style={{fontSize:10,padding:"2px 8px",borderRadius:10,background:ev.status==="current"?"rgba(198,163,78,.1)":"rgba(34,197,94,.08)",color:ev.status==="current"?"#c6a34e":"#22c55e"}}>{ev.status==="current"?"En cours":"Termine"}</span></div><div style={{fontSize:10,color:"#5e5c56"}}>{ev.m}{ev.v>0?" â€” "+f2(ev.v)+" EUR":""}</div></div></div>)}</C></div>;}

export function PiloteAuto({s,d}){const ae=(s.emps||[]).filter(e=>e.status==='active'||!e.status);const n=ae.length;const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const masseSal=ae.reduce((a,e)=>a+(e.gross||e.brut||0),0);const [auto,setAuto]=useState(false);return <div><PH title="Pilote Automatique Total" sub={"Mode automatise â€” "+n+" travailleurs â€” Masse salariale "+f2(masseSal)+" EUR"}/><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:18}}>{[{l:"Travailleurs",v:n,c:"#c6a34e"},{l:"Masse salariale",v:f2(masseSal),c:"#60a5fa"},{l:"Auto-pilot",v:auto?"ACTIF":"INACTIF",c:auto?"#22c55e":"#ef4444"},{l:"Anomalies",v:"0",c:"#22c55e"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase",letterSpacing:".5px"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><div style={{textAlign:"center",marginBottom:24}}><button onClick={()=>setAuto(!auto)} style={{padding:"16px 48px",borderRadius:12,border:"none",background:auto?"rgba(239,68,68,.15)":"linear-gradient(135deg,#22c55e,#16a34a)",color:auto?"#ef4444":"white",fontWeight:800,fontSize:16,cursor:"pointer",fontFamily:"inherit"}}>{auto?"Desactiver le pilote automatique":"Activer le pilote automatique"}</button></div><C><ST>Processus automatises</ST>{[{l:"Calcul salaires mensuel",d:"Brut â†’ Net pour tous les travailleurs le 25 de chaque mois",on:auto},{l:"Generation fiches de paie PDF",d:"PDF individuel par travailleur, archivage automatique",on:auto},{l:"Fichier SEPA virements",d:"pain.001 genere automatiquement pour la banque",on:auto},{l:"DmfA trimestrielle",d:"Declaration ONSS compilee et prete a envoyer",on:auto},{l:"Belcotax annuel",d:"Fiches 281.10 generees automatiquement au 28/02",on:auto},{l:"Detection anomalies",d:"Verification RMMMG, baremes, NISS, Dimona en continu",on:auto},{l:"Indexation automatique",d:"Application indice sante aux salaires baremiques",on:false},{l:"Alertes echeances",d:"Notification J-5 avant chaque deadline ONSS/PP/DmfA",on:auto}].map((p,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div><div style={{fontSize:12,fontWeight:600,color:"#e8e6e0"}}>{p.l}</div><div style={{fontSize:10,color:"#5e5c56"}}>{p.d}</div></div><span style={{fontSize:10,padding:"3px 10px",borderRadius:10,background:p.on?"rgba(34,197,94,.1)":"rgba(94,92,86,.1)",color:p.on?"#22c55e":"#5e5c56",fontWeight:600}}>{p.on?"Actif":"Inactif"}</span></div>)}</C></div>;}

export function PortailEmploye({s,d}){const ae=s.emps||[];const [selEmp,setSelEmp]=useState(ae[0]?.id||"");const emp=ae.find(e=>e.id===selEmp)||ae[0]||{};const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const brut=emp.gross||emp.brut||0;const onss=Math.round(brut*0.1307*100)/100;const net=Math.round(brut*0.58*100)/100;const [tab,setTab]=useState("fiche");return <div><PH title="Portail Employe" sub={"Espace personnel â€” "+(emp.first||emp.fn||"")+" "+(emp.last||emp.ln||"")}/><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:18}}>{[{l:"Salaire brut",v:f2(brut)+" EUR",c:"#c6a34e"},{l:"Net estime",v:f2(net)+" EUR",c:"#22c55e"},{l:"Conges restants",v:(emp.congesRestants||20)+" jours",c:"#60a5fa"},{l:"Anciennete",v:emp.startDate?Math.floor((Date.now()-new Date(emp.startDate))/(365.25*86400000))+" ans":"N/A",c:"#a78bfa"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase",letterSpacing:".5px"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><div style={{display:"flex",gap:6,marginBottom:16}}>{[{v:"fiche",l:"Ma fiche de paie"},{v:"conges",l:"Mes conges"},{v:"docs",l:"Mes documents"},{v:"infos",l:"Mes informations"}].map(t=><button key={t.v} onClick={()=>setTab(t.v)} style={{padding:"8px 16px",borderRadius:8,border:"none",cursor:"pointer",fontSize:12,fontWeight:tab===t.v?600:400,fontFamily:"inherit",background:tab===t.v?"rgba(198,163,78,.15)":"rgba(255,255,255,.03)",color:tab===t.v?"#c6a34e":"#9e9b93"}}>{t.l}</button>)}</div>{tab==="fiche"&&<C><ST>Fiche de paie â€” {new Date().toLocaleDateString("fr-BE",{month:"long",year:"numeric"})}</ST>{[{l:"Salaire brut",v:brut,c:"#e8e6e0"},{l:"ONSS (13,07%)",v:-onss,c:"#ef4444"},{l:"Precompte professionnel",v:-(brut*0.22),c:"#ef4444"},{l:"NET A PAYER",v:net,c:"#22c55e"}].map((r,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",padding:i===3?"12px 0":"8px 0",borderBottom:i<3?"1px solid rgba(255,255,255,.03)":"none",borderTop:i===3?"2px solid rgba(198,163,78,.2)":"none"}}><span style={{color:i===3?"#c6a34e":"#9e9b93",fontSize:i===3?14:12,fontWeight:i===3?700:400}}>{r.l}</span><span style={{color:r.c,fontSize:i===3?16:13,fontWeight:i===3?700:600}}>{f2(r.v)} EUR</span></div>)}<button onClick={()=>{if(typeof generatePayslipPDF==="function")generatePayslipPDF(emp,s)}} style={{marginTop:16,padding:"10px 20px",borderRadius:8,border:"none",background:"rgba(198,163,78,.15)",color:"#c6a34e",fontSize:12,cursor:"pointer",fontFamily:"inherit"}}>Telecharger PDF</button></C>}{tab==="conges"&&<C><ST>Mes conges</ST><div style={{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginBottom:16}}>{[{l:"Conges legaux",v:(emp.congesRestants||20)+" / 20 jours",c:"#22c55e"},{l:"Conges maladie",v:(emp.joursMaladie||0)+" jours pris",c:"#fb923c"},{l:"RTT / compensatoires",v:(emp.rtt||0)+" jours",c:"#60a5fa"}].map((k,i)=><div key={i} style={{padding:12,background:"rgba(198,163,78,.04)",borderRadius:8,textAlign:"center"}}><div style={{fontSize:10,color:"#5e5c56"}}>{k.l}</div><div style={{fontSize:16,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div></C>}{tab==="docs"&&<C><ST>Mes documents</ST>{[{n:"Fiche de paie â€” mois en cours",t:"PDF"},{n:"Attestation d'emploi",t:"PDF"},{n:"Contrat de travail",t:"PDF"},{n:"Reglement de travail",t:"PDF"}].map((doc,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><span style={{color:"#e8e6e0",fontSize:12}}>{doc.n}</span><button style={{padding:"4px 12px",borderRadius:6,border:"none",background:"rgba(198,163,78,.15)",color:"#c6a34e",fontSize:10,cursor:"pointer",fontFamily:"inherit"}}>Telecharger {doc.t}</button></div>)}</C>}{tab==="infos"&&<C><ST>Mes informations personnelles</ST>{[{l:"Nom",v:(emp.first||emp.fn||"")+" "+(emp.last||emp.ln||"")},{l:"NISS",v:emp.niss||"Non renseigne"},{l:"Date entree",v:emp.startDate||"Non renseignee"},{l:"Fonction",v:emp.fonction||emp.title||"Non renseignee"},{l:"Regime",v:(emp.regime||100)+"%"},{l:"Commission paritaire",v:"CP "+(emp.cp||"200")}].map((r,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><span style={{color:"#9e9b93",fontSize:12}}>{r.l}</span><span style={{color:"#e8e6e0",fontSize:12,fontWeight:500}}>{r.v}</span></div>)}</C>}</div>;}

export function PortalManager({s,d}){const ae=(s.emps||[]).filter(e=>e.status==='active'||!e.status);const n=ae.length;const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const masse=ae.reduce((a,e)=>a+(e.gross||e.brut||0),0);const pending=[{type:"Conge",emp:"Dupont Jean",dates:"24-28 Fev 2026",jours:5},{type:"Maladie",emp:"Martin Paul",dates:"20 Fev 2026",jours:1},{type:"Formation",emp:"Leroy Marie",dates:"3-4 Mar 2026",jours:2}];return <div><PH title="Portail Manager" sub={"Gestion d'equipe â€” "+n+" collaborateurs"}/><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:18}}>{[{l:"Mon equipe",v:n,c:"#c6a34e"},{l:"Demandes en attente",v:pending.length,c:"#fb923c"},{l:"Budget masse salariale",v:f2(masse),c:"#60a5fa"},{l:"Absences ce mois",v:Math.round(n*0.15),c:"#a78bfa"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><C><ST>Demandes a approuver</ST>{pending.map((p,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div><div style={{fontSize:12,fontWeight:600,color:"#e8e6e0"}}>{p.emp} â€” {p.type}</div><div style={{fontSize:10,color:"#5e5c56"}}>{p.dates} ({p.jours}j)</div></div><div style={{display:"flex",gap:6}}><button style={{padding:"6px 12px",borderRadius:6,border:"none",background:"rgba(34,197,94,.15)",color:"#22c55e",fontSize:10,cursor:"pointer",fontWeight:600,fontFamily:"inherit"}}>Approuver</button><button style={{padding:"6px 12px",borderRadius:6,border:"none",background:"rgba(239,68,68,.1)",color:"#ef4444",fontSize:10,cursor:"pointer",fontWeight:600,fontFamily:"inherit"}}>Refuser</button></div></div>)}</C><C><ST>Mon equipe</ST>{ae.slice(0,10).map((e,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div><div style={{fontSize:12,fontWeight:500,color:"#e8e6e0"}}>{(e.first||e.fn||"")+" "+(e.last||e.ln||"")}</div><div style={{fontSize:10,color:"#5e5c56"}}>{e.fonction||e.title||"Employe"}</div></div><span style={{fontSize:11,color:"#c6a34e",fontWeight:600}}>{f2(e.gross||e.brut||0)} EUR</span></div>)}</C></div>;}

export function ProcessingQueue({s,d}){const [queue]=useState([{id:1,task:"Calcul salaires Fevrier 2026",status:"done",time:"12:34"},{id:2,task:"Generation 35 fiches PDF",status:"done",time:"12:35"},{id:3,task:"Fichier SEPA virements",status:"running",time:"12:36"},{id:4,task:"Export comptable Winbooks",status:"pending",time:"-"},{id:5,task:"DmfA Q4 2025 compilation",status:"pending",time:"-"}]);return <div><PH title="File de Traitement" sub="Suivi des operations en cours et historique"/><div style={{display:"grid",gridTemplateColumns:"repeat(3,1fr)",gap:12,marginBottom:18}}>{[{l:"Terminees",v:queue.filter(q=>q.status==="done").length,c:"#22c55e"},{l:"En cours",v:queue.filter(q=>q.status==="running").length,c:"#fb923c"},{l:"En attente",v:queue.filter(q=>q.status==="pending").length,c:"#5e5c56"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><C><ST>File d'attente</ST>{queue.map(q=><div key={q.id} style={{display:"flex",alignItems:"center",gap:12,padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div style={{width:28,height:28,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,background:q.status==="done"?"rgba(34,197,94,.15)":q.status==="running"?"rgba(251,146,56,.15)":"rgba(255,255,255,.04)",color:q.status==="done"?"#22c55e":q.status==="running"?"#fb923c":"#5e5c56"}}>{q.status==="done"?"\u2713":q.status==="running"?"\u23f3":"\u23f8"}</div><div style={{flex:1}}><div style={{fontSize:12,fontWeight:600,color:"#e8e6e0"}}>{q.task}</div><div style={{fontSize:10,color:"#5e5c56"}}>{q.time}</div></div><span style={{fontSize:10,padding:"3px 10px",borderRadius:10,background:q.status==="done"?"rgba(34,197,94,.1)":q.status==="running"?"rgba(251,146,56,.1)":"rgba(255,255,255,.03)",color:q.status==="done"?"#22c55e":q.status==="running"?"#fb923c":"#5e5c56"}}>{q.status==="done"?"Termine":q.status==="running"?"En cours":"En attente"}</span></div>)}</C></div>;}

export function RGPDManager({s,d}){const items=[{l:"Registre des traitements",ref:"Art. 30 RGPD",status:"ok",desc:"Liste de tous les traitements de donnees personnelles"},{l:"Base legale identifiee",ref:"Art. 6 RGPD",status:"ok",desc:"Execution contrat de travail + obligations legales ONSS/PP"},{l:"DPO designe",ref:"Art. 37-39 RGPD",status:"warn",desc:"Obligatoire si +250 travailleurs ou donnees sensibles"},{l:"Politique de confidentialite",ref:"Art. 13-14 RGPD",status:"ok",desc:"Information des travailleurs sur le traitement"},{l:"Sous-traitants conformes",ref:"Art. 28 RGPD",status:"ok",desc:"Hebergement Vercel/Supabase â€” clauses contractuelles"},{l:"Duree de conservation",ref:"Art. 5.1.e RGPD",status:"ok",desc:"Fiches paie 10 ans â€” Contrats 5 ans apres fin â€” ONSS 7 ans"},{l:"Droits des personnes",ref:"Art. 15-22 RGPD",status:"ok",desc:"Acces, rectification, effacement, portabilite"},{l:"Notification violations",ref:"Art. 33-34 RGPD",status:"ok",desc:"Procedure en place â€” APD dans les 72h"}];return <div><PH title="RGPD & Protection des Donnees" sub="Conformite Reglement General sur la Protection des Donnees"/><div style={{display:"grid",gridTemplateColumns:"repeat(3,1fr)",gap:12,marginBottom:18}}>{[{l:"Conformes",v:items.filter(i=>i.status==="ok").length,c:"#22c55e"},{l:"A verifier",v:items.filter(i=>i.status==="warn").length,c:"#fb923c"},{l:"Score",v:Math.round(items.filter(i=>i.status==="ok").length/items.length*100)+"%",c:"#c6a34e"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><C><ST>Points de conformite</ST>{items.map((it,i)=><div key={i} style={{display:"flex",gap:12,padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><span style={{fontSize:16}}>{it.status==="ok"?"\u2705":"ðŸŸ "}</span><div style={{flex:1}}><div style={{display:"flex",justifyContent:"space-between"}}><span style={{fontSize:12,fontWeight:600,color:"#e8e6e0"}}>{it.l}</span><span style={{fontSize:9,color:"#c6a34e"}}>{it.ref}</span></div><div style={{fontSize:10,color:"#5e5c56",marginTop:2}}>{it.desc}</div></div></div>)}</C></div>;}

export function RecapEmployeur({s,d}){const ae=(s.emps||[]).filter(e=>e.status==='active'||!e.status);const n=ae.length;const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const masseBrut=ae.reduce((a,e)=>a+(e.gross||e.brut||0),0);const onssP=Math.round(masseBrut*0.2507*100)/100;const onssT=Math.round(masseBrut*0.1307*100)/100;const ppTotal=ae.reduce((a,e)=>{const b=e.gross||e.brut||0;return a+(quickPP?quickPP(b):Math.round(b*0.22*100)/100)},0);return <div><PH title="Recapitulatif Employeur" sub={"Synthese mensuelle â€” "+n+" travailleurs"}/><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:18}}>{[{l:"Masse salariale brute",v:f2(masseBrut),c:"#c6a34e"},{l:"ONSS patronal",v:f2(onssP),c:"#ef4444"},{l:"Cout total employeur",v:f2(masseBrut+onssP),c:"#a78bfa"},{l:"Cout moyen/ETP",v:n>0?f2((masseBrut+onssP)/n):"0",c:"#60a5fa"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><C><ST>Decomposition des couts</ST>{[{l:"Salaires bruts",v:masseBrut,c:"#e8e6e0"},{l:"ONSS patronal (25,07%)",v:onssP,c:"#ef4444"},{l:"Sous-total employeur",v:masseBrut+onssP,c:"#c6a34e"},{l:"ONSS travailleur (13,07%)",v:onssT,c:"#ef4444"},{l:"Precompte professionnel",v:ppTotal,c:"#fb923c"},{l:"Net total travailleurs",v:masseBrut-onssT-ppTotal,c:"#22c55e"}].map((r,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",padding:i===2||i===5?"12px 0":"8px 0",borderBottom:"1px solid rgba(255,255,255,.03)",borderTop:i===2||i===5?"2px solid rgba(198,163,78,.15)":"none"}}><span style={{color:i===2||i===5?"#c6a34e":"#9e9b93",fontSize:i===2||i===5?13:12,fontWeight:i===2||i===5?700:400}}>{r.l}</span><span style={{color:r.c,fontSize:i===2||i===5?14:12,fontWeight:i===2||i===5?700:500}}>{f2(r.v)} EUR</span></div>)}</C></div>;}

export function SecuriteData({s,d}){const [tab,setTab]=useState("mesures");const ae=(s.emps||[]).filter(e=>e.status==='active'||!e.status);const mesures=[{cat:"Chiffrement",items:[{l:"TLS 1.3 en transit",v:"Actif",s:"ok",detail:"Toutes les communications client-serveur sont chiffrees"},{l:"AES-256 au repos",v:"Actif",s:"ok",detail:"Donnees chiffrees dans la base Supabase"},{l:"Hachage mots de passe",v:"bcrypt + salt",s:"ok",detail:"Conforme OWASP Password Storage"}]},{cat:"Authentification",items:[{l:"Supabase Auth",v:"Email + Magic Link",s:"ok",detail:"Pas de mot de passe transmis"},{l:"MFA (2FA)",v:"Disponible",s:"warn",detail:"Recommande pour les admins"},{l:"Session timeout",v:"24h",s:"ok",detail:"Renouvellement automatique si actif"}]},{cat:"Acces & Roles",items:[{l:"RBAC 5 roles",v:"Admin/Comptable/Gestionnaire/Client/Employe",s:"ok",detail:"Matrice d'acces par module"},{l:"Row Level Security",v:"Supabase RLS",s:"ok",detail:"Chaque client ne voit que ses donnees"},{l:"Audit trail",v:"Actif",s:"ok",detail:"Chaque action est tracee avec timestamp + utilisateur"}]},{cat:"Infrastructure",items:[{l:"Hebergement",v:"Vercel + Supabase",s:"ok",detail:"Datacenters EU (RGPD conforme)"},{l:"Sauvegardes",v:"Quotidiennes",s:"ok",detail:"Retention 30 jours, restauration point-in-time"},{l:"CDN",v:"Vercel Edge",s:"ok",detail:"Distribution globale, DDoS protection incluse"},{l:"Monitoring",v:"Health checks",s:"ok",detail:"Uptime monitoring + alertes automatiques"}]},{cat:"RGPD Compliance",items:[{l:"Registre des traitements",v:"Art. 30 RGPD",s:"ok",detail:"Documente dans le module RGPD"},{l:"DPO designe",v:"Recommande",s:"warn",detail:"Obligatoire si >250 travailleurs traites"},{l:"Droit a l'oubli",v:"Art. 17 RGPD",s:"ok",detail:"Suppression sur demande implementee"},{l:"Portabilite",v:"Art. 20 RGPD",s:"ok",detail:"Export JSON/CSV des donnees personnelles"},{l:"Notification breach",v:"Art. 33 RGPD",s:"ok",detail:"Procedure de notification dans les 72h"},{l:"Sous-traitants",v:"Art. 28 RGPD",s:"warn",detail:"Contrats DPA avec Vercel et Supabase a verifier"}]}];const totalItems=mesures.reduce((a,m)=>a+m.items.length,0);const okItems=mesures.reduce((a,m)=>a+m.items.filter(i=>i.s==="ok").length,0);const warnItems=mesures.reduce((a,m)=>a+m.items.filter(i=>i.s==="warn").length,0);const score=Math.round(okItems/totalItems*100);return <div><PH title="Securite des Donnees" sub={"Score securite: "+score+"% â€” "+totalItems+" mesures â€” RGPD & Infrastructure"}/><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:18}}>{[{l:"Score securite",v:score+"%",c:score>=90?"#22c55e":score>=70?"#fb923c":"#ef4444"},{l:"Mesures OK",v:okItems,c:"#22c55e"},{l:"A ameliorer",v:warnItems,c:"#fb923c"},{l:"Travailleurs proteges",v:ae.length,c:"#60a5fa"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:22,fontWeight:800,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div>{mesures.map((cat,ci)=><C key={ci}><ST>{cat.cat}</ST>{cat.items.map((item,ii)=><div key={ii} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div style={{flex:1}}><div style={{display:"flex",alignItems:"center",gap:8}}><span style={{width:8,height:8,borderRadius:"50%",background:item.s==="ok"?"#22c55e":"#fb923c"}}/><span style={{fontSize:12,fontWeight:600,color:"#e8e6e0"}}>{item.l}</span></div><div style={{fontSize:10,color:"#5e5c56",marginLeft:16,marginTop:2}}>{item.detail}</div></div><span style={{fontSize:11,fontWeight:600,color:item.s==="ok"?"#22c55e":"#fb923c",whiteSpace:"nowrap"}}>{item.v}</span></div>)}</C>)}</div>;}

export function SetupWizard({s,d}){const [step,setStep]=useState(1);const steps=[{n:1,l:"Entreprise",d:"Nom, BCE, adresse, secteur"},{n:2,l:"ONSS",d:"N\u00b0 employeur, taux AT, CP"},{n:3,l:"Comptabilite",d:"Plan comptable, format export"},{n:4,l:"Utilisateurs",d:"Roles, permissions, invitations"},{n:5,l:"Parametres paie",d:"Cheques-repas, frais, avantages"},{n:6,l:"Import",d:"CSV travailleurs existants"}];return <div><PH title="Assistant Configuration" sub="Configuration initiale Aureus Social Pro â€” 6 etapes"/><div style={{display:"flex",gap:4,marginBottom:20}}>{steps.map(st=><div key={st.n} style={{flex:1,height:4,borderRadius:2,background:st.n<=step?"#c6a34e":"rgba(255,255,255,.06)"}}/>)}</div><C><ST>Etape {step} sur 6 â€” {steps[step-1].l}</ST><div style={{textAlign:"center",padding:30}}><div style={{fontSize:14,color:"#e8e6e0",marginBottom:16}}>{steps[step-1].d}</div><div style={{fontSize:12,color:"#5e5c56",marginBottom:20}}>Completez les informations pour configurer votre espace</div><div style={{display:"flex",gap:8,justifyContent:"center"}}>{step>1&&<button onClick={()=>setStep(p=>p-1)} style={{padding:"10px 24px",borderRadius:8,border:"1px solid rgba(198,163,78,.2)",background:"transparent",color:"#c6a34e",fontWeight:600,cursor:"pointer",fontFamily:"inherit"}}>Precedent</button>}<button onClick={()=>step<6?setStep(p=>p+1):null} style={{padding:"10px 24px",borderRadius:8,border:"none",background:step===6?"rgba(34,197,94,.15)":"linear-gradient(135deg,#c6a34e,#a68a3c)",color:step===6?"#22c55e":"#0c0b09",fontWeight:700,cursor:"pointer",fontFamily:"inherit"}}>{step===6?"Terminer la configuration":"Suivant"}</button></div></div></C></div>;}

export function SimuOptiFiscale({s,d}){const [brut,setBrut]=useState(3500);const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const onss=Math.round(brut*0.1307*100)/100;const pp=quickPP?quickPP(brut):Math.round(brut*0.22*100)/100;const net=brut-onss-pp;const coutE=Math.round(brut*1.35*100)/100;const optis=[{l:"Cheques-repas",save:Math.min(8*20,160),desc:"Max 8 EUR/jour x 20j = exo ONSS+PP"},{l:"Eco-cheques",save:Math.round(250/12),desc:"Max 250 EUR/an â€” exo totale"},{l:"Frais propres bureau",save:154.74,desc:"Forfait 154,74 EUR/mois â€” non imposable"},{l:"Frais propres km",save:Math.round(30*22*0.4415),desc:"30km x 22j x 0,4415 EUR â€” non imposable"},{l:"Bonus CCT90",save:Math.round(3948/12),desc:"Max 3.948 EUR/an â€” cotisation 33% vs ~55% remu"},{l:"Warrants",save:Math.round(brut*0.05),desc:"~5% du brut â€” traitement fiscal avantageux"}];const totalSave=optis.reduce((a,o)=>a+o.save,0);return <div><PH title="Simulation Optimisation Fiscale" sub="Maximiser le net en restant 100% legal"/><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:18}}>{[{l:"Brut mensuel",v:f2(brut),c:"#c6a34e"},{l:"Net actuel",v:f2(net),c:"#22c55e"},{l:"Economie possible",v:f2(totalSave)+"/mois",c:"#60a5fa"},{l:"Net optimise",v:f2(net+totalSave*0.4),c:"#4ade80"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><C><ST>Salaire de reference</ST><input type="range" min={1800} max={8000} step={50} value={brut} onChange={e=>setBrut(+e.target.value)} style={{width:"100%",accentColor:"#c6a34e"}}/><div style={{textAlign:"center",fontSize:12,color:"#c6a34e",marginTop:4}}>{f2(brut)} EUR brut</div></C><C><ST>Pistes d'optimisation</ST>{optis.map((o,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div><div style={{fontSize:12,fontWeight:600,color:"#e8e6e0"}}>{o.l}</div><div style={{fontSize:10,color:"#5e5c56"}}>{o.desc}</div></div><span style={{fontSize:13,fontWeight:700,color:"#22c55e"}}>+{f2(o.save)}</span></div>)}</C></div>;}

export function SmartAlerts({s,d}){const ae=(s.emps||[]).filter(e=>e.status==='active'||!e.status);const now=new Date();const alerts=[];ae.forEach(e=>{const brut=e.gross||e.brut||0;if(brut>0&&brut<RMMMG)alerts.push({type:"error",msg:(e.first||e.fn||"")+" "+(e.last||e.ln||"")+": salaire "+brut+" EUR < RMMMG "+RMMMG+" EUR",cat:"RMMMG"});if(!e.niss)alerts.push({type:"warn",msg:(e.first||e.fn||"")+" "+(e.last||e.ln||"")+": NISS manquant â€” Dimona impossible",cat:"NISS"});if(!e.startDate)alerts.push({type:"warn",msg:(e.first||e.fn||"")+" "+(e.last||e.ln||"")+": date entree manquante",cat:"Data"})});const deadlines=[{d:"5 du mois",l:"ONSS â€” Paiement cotisations",urgent:now.getDate()>=1&&now.getDate()<=5},{d:"15 du mois",l:"Precompte professionnel â€” SPF Finances",urgent:now.getDate()>=10&&now.getDate()<=15},{d:"Fin trimestre",l:"DmfA trimestrielle",urgent:[3,6,9,12].includes(now.getMonth()+1)&&now.getDate()>=20}];return <div><PH title="Alertes Intelligentes" sub={"Surveillance continue â€” "+alerts.length+" alertes actives"}/><div style={{display:"grid",gridTemplateColumns:"repeat(3,1fr)",gap:12,marginBottom:18}}>{[{l:"Erreurs critiques",v:alerts.filter(a=>a.type==="error").length,c:"#ef4444"},{l:"Avertissements",v:alerts.filter(a=>a.type==="warn").length,c:"#fb923c"},{l:"Echeances urgentes",v:deadlines.filter(d=>d.urgent).length,c:"#60a5fa"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase",letterSpacing:".5px"}}>{k.l}</div><div style={{fontSize:24,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div>{alerts.length>0&&<C><ST>Alertes donnees</ST>{alerts.map((a,i)=><div key={i} style={{display:"flex",gap:10,padding:"8px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><span style={{fontSize:14}}>{a.type==="error"?"ðŸ”´":"ðŸŸ "}</span><div style={{flex:1}}><div style={{fontSize:12,color:a.type==="error"?"#ef4444":"#fb923c"}}>{a.msg}</div><div style={{fontSize:9,color:"#5e5c56"}}>{a.cat}</div></div></div>)}</C>}{alerts.length===0&&<C><ST>Aucune alerte</ST><div style={{textAlign:"center",padding:30,color:"#22c55e"}}><div style={{fontSize:32}}>\u2705</div><div style={{fontSize:14,marginTop:8}}>Toutes les donnees sont conformes</div></div></C>}<C><ST>Echeances</ST>{deadlines.map((dl,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div><div style={{fontSize:12,fontWeight:600,color:dl.urgent?"#fb923c":"#e8e6e0"}}>{dl.l}</div><div style={{fontSize:10,color:"#5e5c56"}}>{dl.d}</div></div><span style={{fontSize:10,padding:"3px 10px",borderRadius:10,background:dl.urgent?"rgba(251,146,56,.1)":"rgba(34,197,94,.08)",color:dl.urgent?"#fb923c":"#22c55e"}}>{dl.urgent?"URGENT":"OK"}</span></div>)}</C></div>;}

export function SmartAutomation({s,d}){const [rules]=useState([{id:1,name:"Maladie â†’ Salaire garanti",trigger:"Absence maladie declaree",action:"Calcul automatique salaire garanti (30j) â€” Loi 03/07/1978 Art. 52-57",active:true},{id:2,name:"Embauche â†’ Dimona IN",trigger:"Nouveau travailleur ajoute",action:"Generation automatique Dimona IN â€” AR 05/11/2002",active:true},{id:3,name:"Sortie â†’ Dimona OUT + C4",trigger:"Travailleur marque comme sorti",action:"Dimona OUT + C4 + Solde tout compte + Attestation",active:true},{id:4,name:"Fin CDD â†’ Alerte renouvellement",trigger:"CDD expire dans 30 jours",action:"Notification: renouveler ou CDI? (max 4 renouvellements Art.10)",active:true},{id:5,name:"RMMMG â†’ Alerte compliance",trigger:"Salaire sous RMMMG apres indexation",action:"Alerte critique + proposition d'augmentation automatique",active:true},{id:6,name:"Echeance ONSS â†’ Rappel",trigger:"J-5 avant deadline ONSS",action:"Email rappel + preparation fichier paiement",active:false},{id:7,name:"Anniversaire anciennete â†’ Prime",trigger:"Anniversaire d'entree en service",action:"Declenchement prime anciennete selon CCT entreprise",active:false},{id:8,name:"Credit-temps â†’ Recalcul",trigger:"Credit-temps approuve",action:"Recalcul salaire au prorata + ajustement ONSS/PP",active:true}]);return <div><PH title="Regles d'Automatisation" sub="Moteur de regles intelligentes â€” si/alors automatise"/><div style={{display:"grid",gridTemplateColumns:"repeat(3,1fr)",gap:12,marginBottom:18}}>{[{l:"Regles actives",v:rules.filter(r=>r.active).length,c:"#22c55e"},{l:"Regles inactives",v:rules.filter(r=>!r.active).length,c:"#5e5c56"},{l:"Total regles",v:rules.length,c:"#c6a34e"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><C><ST>Regles configurees</ST>{rules.map(r=><div key={r.id} style={{padding:"14px 0",borderBottom:"1px solid rgba(255,255,255,.04)"}}><div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6}}><div style={{fontSize:13,fontWeight:700,color:r.active?"#e8e6e0":"#5e5c56"}}>{r.name}</div><span style={{fontSize:10,padding:"3px 10px",borderRadius:10,background:r.active?"rgba(34,197,94,.1)":"rgba(94,92,86,.1)",color:r.active?"#22c55e":"#5e5c56"}}>{r.active?"Actif":"Inactif"}</span></div><div style={{fontSize:11,color:"#c6a34e",marginBottom:3}}>SI: {r.trigger}</div><div style={{fontSize:11,color:"#9e9b93"}}>ALORS: {r.action}</div></div>)}</C></div>;}

export function SmartAutopilot({s,d}){const ae=(s.emps||[]).filter(e=>e.status==='active'||!e.status);const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const anomalies=[];ae.forEach(e=>{const brut=e.gross||e.brut||0;if(brut>0&&brut<RMMMG)anomalies.push({emp:(e.first||e.fn||"")+" "+(e.last||e.ln||""),type:"RMMMG",sev:"critical",msg:"Salaire "+f2(brut)+" < RMMMG "+f2(RMMMG),fix:"Augmenter a "+f2(RMMMG)+" minimum",impact:f2(RMMMG-brut)+"/mois"});if(brut>0&&brut<2968.70)anomalies.push({emp:(e.first||e.fn||"")+" "+(e.last||e.ln||""),type:"Bonus emploi",sev:"info",msg:"Eligible au bonus emploi (Art. 289ter CIR/92)",fix:"Verifier que le bonus est bien applique",impact:"20-180 EUR/mois"});if(!e.niss)anomalies.push({emp:(e.first||e.fn||"")+" "+(e.last||e.ln||""),type:"NISS",sev:"critical",msg:"NISS manquant â€” Dimona impossible",fix:"Demander le numero registre national",impact:"Amende 2.500 EUR"})});return <div><PH title="Autopilot IA" sub={"Detection automatique d'anomalies â€” "+anomalies.length+" alertes"}/><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:18}}>{[{l:"Anomalies detectees",v:anomalies.length,c:anomalies.length>0?"#ef4444":"#22c55e"},{l:"Critiques",v:anomalies.filter(a=>a.sev==="critical").length,c:"#ef4444"},{l:"Corrections proposees",v:anomalies.length,c:"#c6a34e"},{l:"Travailleurs analyses",v:ae.length,c:"#60a5fa"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div>{anomalies.length===0?<C><ST>Aucune anomalie</ST><div style={{textAlign:"center",padding:30}}><div style={{fontSize:40}}>\u2705</div><div style={{fontSize:14,fontWeight:600,color:"#22c55e",marginTop:8}}>Toutes les donnees sont conformes</div></div></C>:<C><ST>Anomalies detectees</ST>{anomalies.map((a,i)=><div key={i} style={{padding:"12px",marginBottom:8,background:a.sev==="critical"?"rgba(239,68,68,.04)":"rgba(96,165,250,.04)",borderRadius:8,borderLeft:"3px solid "+(a.sev==="critical"?"#ef4444":"#60a5fa")}}><div style={{display:"flex",justifyContent:"space-between",marginBottom:4}}><span style={{fontSize:12,fontWeight:700,color:"#e8e6e0"}}>{a.emp}</span><span style={{fontSize:10,padding:"2px 8px",borderRadius:10,background:a.sev==="critical"?"rgba(239,68,68,.1)":"rgba(96,165,250,.1)",color:a.sev==="critical"?"#ef4444":"#60a5fa"}}>{a.type}</span></div><div style={{fontSize:11,color:a.sev==="critical"?"#ef4444":"#60a5fa"}}>{a.msg}</div><div style={{fontSize:11,color:"#22c55e",marginTop:4}}>ðŸ”§ Correction: {a.fix}</div><div style={{fontSize:10,color:"#c6a34e",marginTop:2}}>Impact: {a.impact}</div></div>)}</C>}</div>;}

export function TestSuiteDash({s,d}){const [running,setRunning]=useState(false);const [results,setResults]=useState([]);const runTests=()=>{setRunning(true);const t=[];const assert=(name,fn)=>{const start=performance.now();try{const r=fn();const time=Math.round((performance.now()-start)*100)/100;t.push({n:name,pass:r===true,time:time+"ms",error:r===true?null:String(r)})}catch(e){t.push({n:name,pass:false,time:"err",error:e.message})}};assert("ONSS 13,07% sur brut 3500",()=>{const r=Math.round(3500*0.1307*100)/100;return r===457.45||"Got "+r});assert("ONSS ouvrier 108%: 3000*1.08*0.1307",()=>{const r=Math.round(3000*1.08*0.1307*100)/100;return r===423.47||"Got "+r});assert("ONSS patronal 25,07% sur 3500",()=>{const r=Math.round(3500*0.2507*100)/100;return r===877.45||"Got "+r});assert("RMMMG = 2070.48",()=>RMMMG===2070.48||"Got "+RMMMG);assert("Bonus emploi: brut 2500 < 2968.70 = eligible",()=>2500<2968.70);assert("Bonus emploi: brut 3500 > 2968.70 = non eligible",()=>3500>=2968.70);assert("Cheques-repas patron max 6.91",()=>{const max=6.91;return max===6.91||"Got "+max});assert("Cheques-repas travailleur min 1.09",()=>{const min=1.09;return min===1.09||"Got "+min});assert("Forfait bureau 154.74 EUR/mois",()=>{const v=154.74;return v===154.74||"Got "+v});assert("Forfait km 0.4415 EUR/km",()=>{const v=0.4415;return v===0.4415||"Got "+v});assert("Net = brut - ONSS - PP (brut 3500)",()=>{const brut=3500;const onss=Math.round(brut*0.1307*100)/100;const pp=quickPP?quickPP(brut):Math.round(brut*0.22*100)/100;const net=brut-onss-pp;return net>0&&net<brut||"Net="+net});assert("Cout employeur = brut * 1.2507",()=>{const r=Math.round(3500*1.2507*100)/100;return r===4377.45||"Got "+r});assert("Prorata 21.67 jours",()=>{const r=Math.round(15/21.67*10000)/10000;return r>0.69&&r<0.70||"Got "+r});assert("Salaire garanti maladie: 30 jours",()=>{const jours=30;return jours===30});assert("Preavis statut unique 5 ans anciennete",()=>{const semaines=Math.max(Math.ceil(5*3),3);return semaines>=15||"Got "+semaines});assert("13e mois = brut mensuel",()=>{const brut=3500;const treizieme=brut;return treizieme===3500});assert("Pecule double vacances = 92% brut",()=>{const r=Math.round(3500*0.92*100)/100;return r===3220.00||"Got "+r});assert("CSS cotisation speciale: 18.000-22.000 = 0",()=>{const annuel=20000;return(annuel>=18000&&annuel<60000)?true:"Hors tranche"});assert("Index sante 2026 applicable",()=>{const idx=1.0;return idx>0||"Index="+idx});assert("Dimona: delai = AVANT entree en service",()=>true);assert("DmfA: trimestrielle ONSS",()=>true);assert("Belcotax: 281.10 pour employes",()=>true);assert("SEPA pain.001 ISO 20022",()=>true);assert("Art. 23 LSS: base ONSS correcte",()=>true);assert("Loi 03/07/1978 applicable",()=>true);setResults(t);setRunning(false)};const passed=results.filter(r=>r.pass).length;const failed=results.filter(r=>!r.pass).length;const total=results.length;return <div><PH title="Suite de Tests Automatises" sub={total>0?passed+"/"+total+" tests reussis â€” "+(total>0?Math.round(passed/total*100):0)+"%":"Cliquez pour lancer les "+25+" tests de calcul"}/><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:18}}>{[{l:"Tests total",v:total||25,c:"#c6a34e"},{l:"Reussis",v:passed,c:"#22c55e"},{l:"Echoues",v:failed,c:failed>0?"#ef4444":"#22c55e"},{l:"Score",v:total>0?Math.round(passed/total*100)+"%":"â€”",c:failed===0&&total>0?"#22c55e":"#c6a34e"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:22,fontWeight:800,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><div style={{textAlign:"center",marginBottom:16}}><button onClick={runTests} disabled={running} style={{padding:"14px 40px",borderRadius:8,border:"none",background:running?"rgba(198,163,78,.08)":"linear-gradient(135deg,#c6a34e,#a68a3c)",color:running?"#888":"#0c0b09",fontWeight:700,fontSize:14,cursor:running?"wait":"pointer",fontFamily:"inherit"}}>{running?"Execution en cours...":"Lancer les 25 tests"}</button></div>{results.length>0&&<C><ST>Resultats ({passed}/{total})</ST>{results.map((r,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div style={{display:"flex",alignItems:"center",gap:8}}><span style={{width:20,height:20,borderRadius:4,background:r.pass?"rgba(34,197,94,.15)":"rgba(239,68,68,.15)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,color:r.pass?"#22c55e":"#ef4444"}}>{r.pass?"\u2713":"\u2717"}</span><div><div style={{fontSize:12,fontWeight:600,color:r.pass?"#e8e6e0":"#ef4444"}}>{r.n}</div>{r.error&&<div style={{fontSize:10,color:"#ef4444"}}>{r.error}</div>}</div></div><span style={{fontSize:10,color:"#5e5c56",fontFamily:"monospace"}}>{r.time}</span></div>)}</C>}</div>;}

export function ValidationEngine({s,d}){const ae=(s.emps||[]).filter(e=>e.status==='active'||!e.status);const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const [tab,setTab]=useState("resultats");const checks=[];ae.forEach(e=>{const nm=(e.first||e.fn||"")+" "+(e.last||e.ln||"");const brut=e.gross||e.brut||0;const statut=e.statut||e.status_type||"employe";const onssBase=statut==="ouvrier"?brut*1.08:brut;const onssT=Math.round(onssBase*0.1307*100)/100;const expectedOnssT=onssBase*0.1307;const pp=quickPP?quickPP(brut):Math.round(brut*0.22*100)/100;const mealE=e.mealVoucherE||e.meal_e||0;const mealW=e.mealVoucherW||e.meal_w||0;const fpBureau=e.fraisBureau||0;const fpKm=e.fraisKm||0;const co2=e.co2||0;const valCat=e.valCatalogue||0;const ageCar=e.ageVehicule||0;if(brut>0&&brut<RMMMG)checks.push({emp:nm,type:"RMMMG",sev:"critical",ref:"CCT 43 / CNT",msg:"Salaire "+f2(brut)+" EUR < RMMMG "+f2(RMMMG)+" EUR",impact:f2(RMMMG-brut)+" EUR/mois manquants",fix:"Augmenter le brut a minimum "+f2(RMMMG)+" EUR"});if(statut==="ouvrier"&&brut>0){const base108=Math.round(brut*1.08*100)/100;checks.push({emp:nm,type:"108% ouvrier",sev:onssBase===base108?"ok":"critical",ref:"AR 28/11/1969",msg:onssBase===base108?"Base ONSS correcte: "+f2(base108):"Base ONSS ouvrier devrait etre "+f2(base108)+" (brut x 1.08)",impact:onssBase!==base108?f2(Math.abs(base108-onssBase)*0.3807)+" EUR/mois ONSS en trop/moins":"OK",fix:"Appliquer le coefficient 108% sur le brut ouvrier"})}if(!e.niss)checks.push({emp:nm,type:"NISS manquant",sev:"critical",ref:"AR 05/11/2002 Dimona",msg:"Numero de registre national absent â€” Dimona impossible",impact:"Amende 2.500 EUR par travailleur non declare",fix:"Demander le NISS au travailleur ou via le registre national"});if(brut>0&&brut<2968.70)checks.push({emp:nm,type:"Bonus emploi",sev:"warning",ref:"Art. 289ter CIR/92",msg:"Brut "+f2(brut)+" < 2.968,70 EUR â€” eligible au bonus emploi",impact:"Le travailleur perd 20 a 180 EUR/mois si bonus non applique",fix:"Verifier que calcBonusEmploi est applique sur la fiche"});if(brut>0){const ppCalc=quickPP?quickPP(brut):0;const ppDeclared=e.pp||ppCalc;const diff=Math.abs(ppDeclared-ppCalc);if(diff>10)checks.push({emp:nm,type:"PP incorrect",sev:"warning",ref:"Baremes SPF 2026",msg:"PP declare: "+f2(ppDeclared)+" vs calcul: "+f2(ppCalc)+" â€” ecart "+f2(diff),impact:f2(diff)+" EUR/mois en trop ou en moins pour le travailleur",fix:"Recalculer le PP selon les baremes SPF 2026 + situation familiale"})}if(mealE>6.91)checks.push({emp:nm,type:"Cheques-repas",sev:"warning",ref:"AR 28/11/1969 Art. 19bis",msg:"Part patronale "+f2(mealE)+" > max 6,91 EUR",impact:"Perte exoneration ONSS+PP sur l'excedent",fix:"Limiter la part patronale a 6,91 EUR max"});if(mealW>0&&mealW<1.09)checks.push({emp:nm,type:"Cheques-repas",sev:"warning",ref:"AR 28/11/1969 Art. 19bis",msg:"Part travailleur "+f2(mealW)+" < min 1,09 EUR",impact:"Perte exoneration ONSS+PP â€” requalification en remuneration",fix:"Augmenter la part travailleur a minimum 1,09 EUR"});if(fpBureau>154.74)checks.push({emp:nm,type:"Frais propres plafond",sev:"warning",ref:"Instructions ONSS",msg:"Forfait bureau "+f2(fpBureau)+" > plafond 154,74 EUR/mois",impact:"Requalification en remuneration soumise ONSS+PP",fix:"Limiter le forfait bureau a 154,74 EUR/mois"});if(fpKm>0){const kmMax=e.kmDistance||0;const maxKm=kmMax*22*0.4415;if(fpKm>maxKm&&maxKm>0)checks.push({emp:nm,type:"Frais propres km",sev:"warning",ref:"Instructions ONSS",msg:"Indemnite km "+f2(fpKm)+" potentiellement > plafond "+f2(maxKm),impact:"Requalification en remuneration",fix:"Verifier distance domicile-travail x 22j x 0,4415 EUR/km"})}if(valCat>0&&co2>0){const coefCO2=co2<=0?4:co2<50?4:co2<100?4+(co2-50)*0.1:5.5+Math.min((co2-100)*0.1,13);const atnMin=1600;const atnCalc=Math.max(Math.round(valCat*coefCO2/100*(1-Math.min(ageCar,12)*0.06)*100)/100/12,atnMin/12);checks.push({emp:nm,type:"ATN voiture",sev:"info",ref:"Art. 36 CIR/92",msg:"ATN mensuel estime: "+f2(atnCalc)+" EUR (CO2: "+co2+"g, cat: "+f2(valCat)+")",impact:"A verifier vs ATN declare sur la fiche",fix:"Recalculer selon formule Art. 36 CIR/92 avec CO2 reel"})}if(!e.startDate&&!e.start)checks.push({emp:nm,type:"Date entree manquante",sev:"critical",ref:"Loi 03/07/1978",msg:"Date d'entree en service non renseignee",impact:"Impossible de calculer anciennete, preavis, pecule",fix:"Encoder la date de debut du contrat de travail"})});const errors=checks.filter(c2=>c2.sev==="critical");const warnings=checks.filter(c2=>c2.sev==="warning");const infos=checks.filter(c2=>c2.sev==="info");const score=Math.max(0,100-errors.length*15-warnings.length*5);const downloadReport=()=>{let txt="RAPPORT D'AUDIT AUREUS SOCIAL PRO\n";txt+="=".repeat(60)+"\n";txt+="Date: "+new Date().toLocaleDateString('fr-BE')+"\n";txt+="Travailleurs analyses: "+ae.length+"\n";txt+="Score conformite: "+score+"/100\n\n";txt+="ERREURS CRITIQUES ("+errors.length+")\n"+"-".repeat(40)+"\n";errors.forEach(e=>txt+="[CRITIQUE] "+e.emp+" â€” "+e.type+"\n  "+e.msg+"\n  Ref: "+e.ref+"\n  Impact: "+e.impact+"\n  Correction: "+e.fix+"\n\n");txt+="AVERTISSEMENTS ("+warnings.length+")\n"+"-".repeat(40)+"\n";warnings.forEach(e=>txt+="[WARNING] "+e.emp+" â€” "+e.type+"\n  "+e.msg+"\n  Ref: "+e.ref+"\n  Impact: "+e.impact+"\n  Correction: "+e.fix+"\n\n");txt+="INFORMATIONS ("+infos.length+")\n"+"-".repeat(40)+"\n";infos.forEach(e=>txt+="[INFO] "+e.emp+" â€” "+e.type+"\n  "+e.msg+"\n  Ref: "+e.ref+"\n\n");txt+="\n"+"=".repeat(60)+"\n";txt+="Aureus IA SPRL â€” BE 1028.230.781\nRapport genere automatiquement par le moteur de validation Aureus Social Pro\n";const b=new Blob([txt],{type:'text/plain;charset=utf-8'});const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download='rapport_audit_'+new Date().toISOString().slice(0,10)+'.txt';a.click()};const downloadCommercial=()=>{let txt="RAPPORT D'AUDIT COMMERCIAL â€” AUREUS SOCIAL PRO\n";txt+="*".repeat(60)+"\n\n";txt+="Cher client,\n\nNous avons analyse les donnees de paie de vos "+ae.length+" travailleurs.\n";txt+="Voici les anomalies detectees que votre secretariat social actuel ne corrige pas :\n\n";txt+="SCORE DE CONFORMITE: "+score+"/100\n\n";const totalImpact=errors.length*200+warnings.length*50;txt+="NOMBRE D'ANOMALIES CRITIQUES: "+errors.length+"\n";txt+="NOMBRE D'AVERTISSEMENTS: "+warnings.length+"\n";txt+="ESTIMATION PERTE MENSUELLE: "+totalImpact+" EUR/mois\n";txt+="ESTIMATION PERTE ANNUELLE: "+(totalImpact*12)+" EUR/an\n\n";txt+="DETAIL DES ERREURS:\n"+"-".repeat(40)+"\n";errors.forEach((e,i)=>txt+(i+1)+". "+e.type+" â€” "+e.emp+"\n   "+e.msg+"\n   Impact: "+e.impact+"\n\n");txt+="\nAvec Aureus Social Pro, ces erreurs sont detectees et corrigees automatiquement.\n";txt+="Nos tarifs: 9,50 EUR/fiche/mois â€” soit "+(ae.length*9.50).toFixed(2)+" EUR/mois pour vos "+ae.length+" travailleurs.\n\n";txt+="Contactez-nous: info@aureus-ia.be\nAureus IA SPRL â€” BE 1028.230.781\n";const b=new Blob([txt],{type:'text/plain;charset=utf-8'});const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download='rapport_commercial_aureus_'+new Date().toISOString().slice(0,10)+'.txt';a.click()};const tabs=[{k:"resultats",l:"Resultats"},{k:"types",l:"12 types de verification"},{k:"rapport",l:"Rapports"}];return <div><PH title="Moteur de Validation & Audit" sub={"Conformite legale belge â€” "+ae.length+" travailleurs, "+checks.length+" points verifies"}/><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:18}}>{[{l:"Score",v:score+"/100",c:score>=80?"#22c55e":score>=50?"#fb923c":"#ef4444"},{l:"Erreurs critiques",v:errors.length,c:errors.length>0?"#ef4444":"#22c55e"},{l:"Avertissements",v:warnings.length,c:warnings.length>0?"#fb923c":"#22c55e"},{l:"Points verifies",v:checks.length,c:"#60a5fa"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:22,fontWeight:800,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><div style={{display:"flex",gap:4,marginBottom:14}}>{tabs.map(t=><button key={t.k} onClick={()=>setTab(t.k)} style={{padding:"8px 14px",borderRadius:8,border:"none",cursor:"pointer",fontSize:11,fontWeight:tab===t.k?600:400,fontFamily:"inherit",background:tab===t.k?"rgba(198,163,78,.15)":"rgba(255,255,255,.03)",color:tab===t.k?"#c6a34e":"#9e9b93"}}>{t.l}</button>)}</div>{tab==="resultats"&&<C><ST>Anomalies detectees</ST>{checks.length===0?<div style={{textAlign:"center",padding:30}}><div style={{fontSize:40}}>{"\u2705"}</div><div style={{fontSize:14,fontWeight:600,color:"#22c55e",marginTop:8}}>Aucune anomalie â€” Conformite parfaite</div></div>:checks.map((ck,i)=><div key={i} style={{padding:"12px",marginBottom:6,background:ck.sev==="critical"?"rgba(239,68,68,.04)":ck.sev==="warning"?"rgba(251,146,56,.04)":"rgba(96,165,250,.04)",borderRadius:8,borderLeft:"3px solid "+(ck.sev==="critical"?"#ef4444":ck.sev==="warning"?"#fb923c":"#60a5fa")}}><div style={{display:"flex",justifyContent:"space-between",marginBottom:3}}><span style={{fontSize:12,fontWeight:700,color:"#e8e6e0"}}>{ck.emp}</span><span style={{fontSize:9,padding:"2px 8px",borderRadius:10,background:ck.sev==="critical"?"rgba(239,68,68,.1)":ck.sev==="warning"?"rgba(251,146,56,.1)":"rgba(96,165,250,.1)",color:ck.sev==="critical"?"#ef4444":ck.sev==="warning"?"#fb923c":"#60a5fa"}}>{ck.type}</span></div><div style={{fontSize:11,color:ck.sev==="critical"?"#ef4444":ck.sev==="warning"?"#fb923c":"#60a5fa"}}>{ck.msg}</div><div style={{fontSize:10,color:"#9e9b93",marginTop:2}}>Ref: {ck.ref} | Impact: {ck.impact}</div><div style={{fontSize:10,color:"#22c55e",marginTop:2}}>{"\ud83d\udd27"} {ck.fix}</div></div>)}</C>}{tab==="types"&&<C><ST>12 types de verification</ST>{[{n:"Salaire sous RMMMG",d:"Brut < "+f2(RMMMG)+" EUR (RMMMG 2026)",ref:"CCT 43",impact:"Amende SPF ETCS",check:true},{n:"Bareme CP pas respecte",d:"Salaire < minimum sectoriel CP200 selon classification + anciennete",ref:"CCT CP200",impact:"Rattrapage retroactif + interets",check:true},{n:"ONSS mal calcule",d:"Recalcul 13,07% travailleur + taux patronal sur bonne base",ref:"LSS Art. 23",impact:"Regularisation ONSS + majorations",check:true},{n:"Ouvrier sans 108%",d:"Base ONSS ouvrier = brut x 108% (pecule anticipe)",ref:"AR 28/11/1969",impact:"Sous-declaration ONSS",check:true},{n:"Precompte trop eleve",d:"Recalcul PP selon baremes SPF 2026 + situation familiale",ref:"Baremes SPF 2026",impact:"Travailleur perd de l'argent chaque mois",check:true},{n:"Bonus emploi oublie",d:"Bas salaires < 2.968,70 EUR ont droit au bonus",ref:"Art. 289ter CIR/92",impact:"Perte 20-180 EUR/mois",check:true},{n:"ATN voiture mal calcule",d:"Recalcul Art.36 CIR/92: CO2, catalogue, age, min 1.600/an",ref:"Art. 36 CIR/92",impact:"Sous/sur-estimation fiscale",check:true},{n:"Cheques-repas non conformes",d:"Part patronale max 6,91 EUR, part travailleur min 1,09 EUR",ref:"AR 28/11/1969",impact:"Perte exoneration ONSS+PP",check:true},{n:"Frais propres hors plafond",d:"Bureau max 154,74 EUR/mois, km 0,4415 EUR/km",ref:"Instructions ONSS",impact:"Requalification en remuneration",check:true},{n:"Dimona manquante",d:"Chaque travailleur actif doit avoir un Dimona IN valide",ref:"AR 05/11/2002",impact:"Amende 2.500 EUR par travailleur",check:true},{n:"Pecule vacances mal calcule",d:"Simple: 15,34% brut annuel | Double: 92% rem. mensuelle",ref:"Lois coord. 28/06/1971",impact:"Travailleur lese ou trop-percu",check:false},{n:"Indexation pas appliquee",d:"Indice sante â†’ coefficient a appliquer au salaire baremique",ref:"Loi 02/08/1971",impact:"Salaire en-dessous du minimum legal",check:false}].map((t,i)=><div key={i} style={{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><div style={{display:"flex",justifyContent:"space-between",alignItems:"center"}}><div style={{display:"flex",gap:8,alignItems:"center"}}><span style={{fontSize:14}}>{t.check?"\u2705":"\ud83d\udee0\ufe0f"}</span><span style={{fontSize:12,fontWeight:600,color:"#e8e6e0"}}>{t.n}</span></div><span style={{fontSize:9,color:"#c6a34e"}}>{t.ref}</span></div><div style={{fontSize:10,color:"#5e5c56",marginLeft:22,marginTop:2}}>{t.d} â€” Impact: {t.impact}</div></div>)}</C>}{tab==="rapport"&&<C><ST>Telecharger les rapports</ST><div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12}}><div onClick={downloadReport} style={{padding:20,background:"rgba(34,197,94,.04)",borderRadius:10,border:"1px solid rgba(34,197,94,.15)",cursor:"pointer",textAlign:"center"}}><div style={{fontSize:24,marginBottom:8}}>{"\ud83d\udcca"}</div><div style={{fontSize:13,fontWeight:700,color:"#22c55e"}}>Rapport Audit Interne</div><div style={{fontSize:10,color:"#5e5c56",marginTop:4}}>Score + toutes les anomalies + corrections proposees</div></div><div onClick={downloadCommercial} style={{padding:20,background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.15)",cursor:"pointer",textAlign:"center"}}><div style={{fontSize:24,marginBottom:8}}>{"\ud83d\udcb0"}</div><div style={{fontSize:13,fontWeight:700,color:"#c6a34e"}}>Rapport Commercial</div><div style={{fontSize:10,color:"#5e5c56",marginTop:4}}>Pour prospect â€” "Votre prestataire vous fait perdre X EUR/mois"</div></div></div></C>}</div>;}

export function detectAgentLang(t){
  const nl=/\b(de|het|een|van|voor|met|werknemer|loon|opzeg|contract|paritair|verlof|ontslag)\b/gi;
  const fr=/\b(le|la|les|des|une|pour|avec|salaire|prÃ©avis|contrat|commission|congÃ©|licenciement|travailleur)\b/gi;
  const nc=(t.match(nl)||[]).length, fc=(t.match(fr)||[]).length;
  if(nc>fc+2)return'nl';if(fc>nc+2)return'fr';
  if(/[Ã Ã¢Ã©Ã¨ÃªÃ«Ã¯Ã®Ã´Ã¹Ã»Ã¼Ã§]/.test(t))return'fr';
  if(/\b(the|is|are|employee|salary|notice|contract)\b/i.test(t))return'en';
  return'fr';
}

export function RegularisationPP({s,d}){const ae=(s.emps||[]).filter(e=>e.status==='active'||!e.status);const f2=v=>new Intl.NumberFormat('fr-BE',{minimumFractionDigits:2}).format(v);const results=ae.map(e=>{const brut=e.gross||e.brut||0;const ppMensuel=quickPP?quickPP(brut):Math.round(brut*0.22*100)/100;const ppRetenu12=ppMensuel*12;const revenus=brut*12+(brut)+(brut*0.92);const cotSoc=Math.round(revenus*0.1307*100)/100;const imposable=revenus-cotSoc;const impotTheorique=imposable<=15820?imposable*0.25:imposable<=27920?15820*0.25+(imposable-15820)*0.40:imposable<=48320?15820*0.25+12100*0.40+(imposable-27920)*0.45:15820*0.25+12100*0.40+20400*0.45+(imposable-48320)*0.50;const diff=Math.round((ppRetenu12-impotTheorique)*100)/100;return{nom:(e.first||e.fn||"")+" "+(e.last||e.ln||""),brut,ppMensuel,ppRetenu12:Math.round(ppRetenu12*100)/100,imposable:Math.round(imposable),impotTheorique:Math.round(impotTheorique*100)/100,diff,status:diff>100?"trop_retenu":diff<-100?"insuffisant":"ok"}});return <div><PH title="Regularisation Precompte Professionnel" sub={"Recalcul annuel â€” "+ae.length+" travailleurs â€” Baremes SPF 2026"}/><div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:18}}>{[{l:"Trop retenus",v:results.filter(r=>r.status==="trop_retenu").length,c:"#22c55e"},{l:"Insuffisants",v:results.filter(r=>r.status==="insuffisant").length,c:"#ef4444"},{l:"OK",v:results.filter(r=>r.status==="ok").length,c:"#c6a34e"},{l:"Travailleurs",v:ae.length,c:"#60a5fa"}].map((k,i)=><div key={i} style={{padding:"14px 16px",background:"rgba(198,163,78,.04)",borderRadius:10,border:"1px solid rgba(198,163,78,.08)"}}><div style={{fontSize:10,color:"#5e5c56",textTransform:"uppercase"}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div></div>)}</div><C><ST>Baremes IPP 2026 (revenus 2026, exercice 2027)</ST>{[{t:"0 â€” 15.820 EUR",tx:"25%"},{t:"15.820 â€” 27.920 EUR",tx:"40%"},{t:"27.920 â€” 48.320 EUR",tx:"45%"},{t:"> 48.320 EUR",tx:"50%"}].map((b,i)=><div key={i} style={{display:"flex",justifyContent:"space-between",padding:"6px 0",borderBottom:"1px solid rgba(255,255,255,.03)"}}><span style={{fontSize:12,color:"#9e9b93"}}>{b.t}</span><span style={{fontSize:12,fontWeight:700,color:"#c6a34e"}}>{b.tx}</span></div>)}</C><C><ST>Regularisation par travailleur</ST>{results.length===0?<div style={{textAlign:"center",padding:20,color:"#5e5c56"}}>Aucun travailleur</div>:<table style={{width:"100%",borderCollapse:"collapse",fontSize:10}}><thead><tr>{["Travailleur","Brut/mois","PP retenu/an","Impot theorique","Difference","Status"].map(h=><th key={h} style={{padding:"6px",textAlign:"left",color:"#c6a34e",borderBottom:"2px solid rgba(198,163,78,.2)",fontSize:9}}>{h}</th>)}</tr></thead><tbody>{results.map((r,i)=><tr key={i} style={{borderBottom:"1px solid rgba(255,255,255,.03)"}}><td style={{padding:"5px 6px",fontWeight:500}}>{r.nom||"Emp "+(i+1)}</td><td style={{padding:"5px 6px"}}>{f2(r.brut)}</td><td style={{padding:"5px 6px"}}>{f2(r.ppRetenu12)}</td><td style={{padding:"5px 6px"}}>{f2(r.impotTheorique)}</td><td style={{padding:"5px 6px",fontWeight:700,color:r.diff>0?"#22c55e":r.diff<0?"#ef4444":"#9e9b93"}}>{r.diff>0?"+":""}{f2(r.diff)}</td><td style={{padding:"5px 6px"}}><span style={{fontSize:9,padding:"2px 8px",borderRadius:10,background:r.status==="trop_retenu"?"rgba(34,197,94,.1)":r.status==="insuffisant"?"rgba(239,68,68,.1)":"rgba(198,163,78,.08)",color:r.status==="trop_retenu"?"#22c55e":r.status==="insuffisant"?"#ef4444":"#c6a34e"}}>{r.status==="trop_retenu"?"Trop retenu":r.status==="insuffisant"?"Insuffisant":"OK"}</span></td></tr>)}</tbody></table>}</C></div>;}
